<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lava-DL Bootstrap &mdash; Lava  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Lava-DL NetX" href="../netx/netx.html" />
    <link rel="prev" title="Lava-DL SLAYER" href="../slayer/slayer.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Lava
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../lava_architecture_overview.html">Lava Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lava_architecture_overview.html#key-attributes">Key attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lava_architecture_overview.html#why-do-we-need-lava">Why do we need Lava?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lava_architecture_overview.html#lava-s-foundational-concepts">Lava’s foundational concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lava_architecture_overview.html#processes">1. Processes:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lava_architecture_overview.html#behavioral-implementations-via-processmodels">2. Behavioral implementations via ProcessModels:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lava_architecture_overview.html#composability-and-connectivity">3. Composability and connectivity:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lava_architecture_overview.html#cross-platform-execution">4. Cross-platform execution:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lava_architecture_overview.html#lava-software-stack">Lava software stack</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started_with_lava.html">Getting Started With Lava</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started_with_lava.html#application-examples">Application examples:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started_with_lava.html#fundamental-concepts">Fundamental concepts:</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../algorithms.html">Algorithms and Application Libraries</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../dl.html">Deep Learning</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../dl.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dl.html#lava-dl-workflow">Lava-DL Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dl.html#getting-started">Getting Started</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dl.html#slayer-2-0">SLAYER 2.0</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../dl.html#example-code">Example Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../dl.html#bootstrap">Bootstrap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../dl.html#example-code-1">Example Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../dl.html#network-exchange-netx-library">Network Exchange (NetX) Library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../dl.html#example-code-2">Example Code</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="reference internal" href="../../dl.html#detailed-description">Detailed Description</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../slayer/slayer.html">Lava-DL SLAYER</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Lava-DL Bootstrap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../netx/netx.html">Lava-DL NetX</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../dnf.html">Dynamic Neural Fields</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../dnf.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dnf.html#what-is-lava-dnf">What is lava-dnf?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dnf.html#key-features">Key features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dnf.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../optimization.html">Neuromorphic Constraint Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../optimization.html#tutorials">Tutorials</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../optimization.html#qp-solver">QP Solver</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../optimization.html#example">Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../optimization.html#id1">QP Solver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../optimization.html#coming-up-next-cspsolver">Coming up next: CSPSolver</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../optimization.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../optimization.html#setup">Setup</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer_guide.html">Developer Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../developer_guide.html#lava-s-origins">Lava’s Origins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developer_guide.html#contact-information">Contact Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developer_guide.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developer_guide.html#development-roadmap">Development Roadmap</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../developer_guide.html#initial-release">Initial Release</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../developer_guide.html#how-to-contribute-to-lava">How to contribute to Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../developer_guide.html#open-an-issue">Open an Issue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developer_guide.html#pull-request-checklist">Pull Request Checklist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developer_guide.html#open-a-pull-request">Open a Pull Request</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../developer_guide.html#coding-conventions">Coding Conventions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../developer_guide.html#code-requirements">Code Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developer_guide.html#guidelines">Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developer_guide.html#docstring-format">Docstring Format</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../developer_guide.html#contributors">Contributors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../developer_guide.html#contributor">Contributor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developer_guide.html#committer">Committer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../developer_guide.html#list-of-lava-nc-lava-project-committers">List of lava-nc/lava Project Committers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../developer_guide.html#list-of-lava-nc-lava-dnf-project-committers">List of lava-nc/lava-dnf Project Committers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../developer_guide.html#list-of-lava-nc-lava-optimization-project-committers">List of lava-nc/lava-optimization Project Committers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../developer_guide.html#list-of-lava-nc-lava-dl-project-committers">List of lava-nc/lava-dl Project Committers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../developer_guide.html#committer-promotion">Committer Promotion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../developer_guide.html#repository-structure">Repository Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../developer_guide.html#id20">lava-nc/lava</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developer_guide.html#lava-nc-lava-dnf">lava-nc/lava-dnf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developer_guide.html#lava-nc-lava-dl">lava-nc/lava-dl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developer_guide.html#lava-nc-lava-optimization">lava-nc/lava-optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../developer_guide.html#lava-nc-lava-docs">lava-nc/lava-docs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../developer_guide.html#code-of-conduct">Code of Conduct</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../developer_guide.html#licenses">Licenses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lava_api_documentation.html">Lava API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lava/modules.html">Lava</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html">Lava - Deep Learning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../slayer/index.html">SLAYER</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../slayer/neuron/modules.html">Neuron</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slayer/synapse/modules.html">Synapse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slayer/spike/modules.html">Spike</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slayer/axon/modules.html">Axon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slayer/dendrite/modules.html">Dendrite</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slayer/block/modules.html">Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slayer/loss.html">Loss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slayer/classifier.html">Classifier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slayer/io.html">Input/Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slayer/auto.html">Auto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../slayer/utils/modules.html">Utilities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../slayer/index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html">Bootstrap (ANN-SNN training)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="block/modules.html">Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="ann_sampler.html">ANN Statistics Sampler</a></li>
<li class="toctree-l4"><a class="reference internal" href="routine.html">Routine</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../netx/index.html">Lava-DL NetX</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../netx/blocks/modules.html">Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../netx/hdf5.html">HDF5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../netx/utils.html">Utils</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../netx/index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lava-lib-dnf/index.html">Lava - Dynamic Neural Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lava-lib-optimization/index.html">Lava - Optimization</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Lava</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../algorithms.html">Algorithms and Application Libraries</a> &raquo;</li>
          <li><a href="../../dl.html">Deep Learning</a> &raquo;</li>
      <li>Lava-DL Bootstrap</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/lava-lib-dl/bootstrap/bootstrap.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="lava-dl-bootstrap">
<h1>Lava-DL Bootstrap<a class="headerlink" href="#lava-dl-bootstrap" title="Permalink to this headline"></a></h1>
<p>Rate based SNNs generated by ANN-SNN conversion methods require long runtimes to achieve high accuracy because the rate-based approximation of the ReLU activation unit breaks down for short runtimes.</p>
<p><code class="docutils literal notranslate"><span class="pre">lava.lib.dl.bootstrap</span></code> accelerates rate coded Spiking Neural Network (SNN) training by dynamically estimating the equivalent ANN transfer function of a spiking layer with a picewise linear model at regular epochs interval and using the ANN equivlent network to train the original SNN.</p>
<p><strong>Highlight features</strong></p>
<ul class="simple">
<li><p>Accelerated rate coded SNN training.</p></li>
<li><p>Low latency inference of trained SNN made possible by close modeling
of equivalent ANN dynamics.</p></li>
<li><p>Hybrid training with a mix of SNN layers and ANN layers for minimal
drop in SNN accuracy.</p></li>
<li><p>Scheduler for seamless switching between different bootstrap modes.</p></li>
</ul>
<div class="section" id="bootstrap-training">
<h2>Bootstrap Training<a class="headerlink" href="#bootstrap-training" title="Permalink to this headline"></a></h2>
<p>The underlying principle for ANN-SNN conversion is that the ReLU
activation function (or similar form) approximates the firing rate of an
LIF spiking neuron. Consequently, an ANN trained with ReLU activation
can be mapped to an equivalent SNN with proper scaling of weights and
thresholds. However, as the number of time-steps reduces, the alignment
between ReLU activation and LIF spiking rate falls apart mainly due to
the following two reasons (especially, for discrete-in-time models like
Loihi’s CUBA LIF):</p>
<div class="figure align-default" id="id1">
<img alt="fit" src="https://user-images.githubusercontent.com/29907126/140595166-336e625d-c269-40d6-af85-caf5d2328139.png" />
<p class="caption"><span class="caption-text">fit</span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</div>
<ul class="simple">
<li><p>With less time steps, the SNN can assume only a few discrete firing
rates.</p></li>
<li><p>Limited time steps mean that the spiking neuron activity rate often
saturates to maximum allowable firing rate.</p></li>
</ul>
<p>In Bootstrap training. An SNN is used to jumpstart an equivalent ANN
model which is then used to accelerate SNN training. There is no
restriction on the type of spiking neuron or it’s reset behavior. It
consists of following steps:</p>
<p align="center">
<img src="https://user-images.githubusercontent.com/29907126/140595174-2feb6946-bf64-4188-a6ea-eeb693a3052d.png" alt="Drawing" style="height: 400px;"/>
</p><ul class="simple">
<li><p>Input output data points are first collected from the network running
as an SNN: <strong>``bootstrap.mode.SNN``</strong>.</p></li>
<li><p>The data is used to estimate the corresponding ANN activation as a
piecewise linear layer, unique to each layer:
<strong>``bootstrap.mode.FIT``</strong> mode.</p></li>
<li><p>The training is accelerated using the piecewise linear ANN
activation: <strong>``bootstrap.mode.ANN``</strong> mode.</p></li>
<li><p>The network is seamlessly translated to an SNN:
<strong>``bootstrap.mode.SNN``</strong> mode.</p></li>
<li><p>SAMPLE mode and FIT mode are repeated for a few iterations every
couple of epochs, thus maintaining an accurate ANN estimate.</p></li>
</ul>
</div>
<div class="section" id="hybridization">
<h2>Hybridization<a class="headerlink" href="#hybridization" title="Permalink to this headline"></a></h2>
<p>The dynamic estimation of ANN activation function may still not be
enough to reduce the gap between SNN and it’s equivalent ANN, especially
when the inference timesteps are low and the networks grow deep. In such
a scenario, one can look at a hybrid approach of directly training a
part of the network as SNN layers/blocks while acclearating the rest of
the layers/blocks with bootstrap training.</p>
<p>With <code class="docutils literal notranslate"><span class="pre">bootstrap.block</span></code> interface, some of the layers in the network
can be run in SNN and rest in ANN. We define a <strong>crossover</strong> layer which
splits layers earlier than it to always SNN and rest to ANN-SNN
bootstrap mode.</p>
<p align="center">
<img src="https://user-images.githubusercontent.com/29907126/140596065-e72e1340-351d-4e5f-b4e0-8b77ed95eb9a.png" alt="Drawing" style="height: 350px;"/>
</p></div>
<div class="section" id="tutorials">
<h2>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><ul>
<li><p><a class="reference external" href="notebooks/mnist/train.html">MNIST digit classification</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="modules">
<h2>Modules<a class="headerlink" href="#modules" title="Permalink to this headline"></a></h2>
<p>The main modules are</p>
<div class="section" id="bootstrap-block">
<h3><code class="docutils literal notranslate"><span class="pre">bootstrap.block</span></code><a class="headerlink" href="#bootstrap-block" title="Permalink to this headline"></a></h3>
<p>It provides <code class="docutils literal notranslate"><span class="pre">lava.lib.dl.slayer.block</span></code> based network definition
interface.</p>
</div>
<div class="section" id="bootstrap-ann-sampler">
<h3><code class="docutils literal notranslate"><span class="pre">bootstrap.ann_sampler</span></code><a class="headerlink" href="#bootstrap-ann-sampler" title="Permalink to this headline"></a></h3>
<p>It provides utilities for sampling SNN data points and pievewise linear
ANN fit.</p>
</div>
<div class="section" id="bootstrap-routine">
<h3><code class="docutils literal notranslate"><span class="pre">bootstrap.routine</span></code><a class="headerlink" href="#bootstrap-routine" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">bootstrap.routine.Scheduler</span></code> provides an easy scheduling utility to
seamlessly switch between SAMPLING | FIT | ANN | SNN mode. It also
provides ANN-SNN bootstrap <strong>hybrid training</strong> utility as well
determined by crossover point.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../slayer/slayer.html" class="btn btn-neutral float-left" title="Lava-DL SLAYER" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../netx/netx.html" class="btn btn-neutral float-right" title="Lava-DL NetX" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Intel Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>