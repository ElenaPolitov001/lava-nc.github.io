<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Excitatory-Inhibitory Neural Network with Lava &mdash; Lava  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Spike-timing Dependent Plasticity (STDP)" href="../in_depth/tutorial08_stdp.html" />
    <link rel="prev" title="MNIST Digit Classification with Lava" href="tutorial01_mnist_digit_classification.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Lava
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../lava_architecture_overview.html">Lava Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../lava_architecture_overview.html#key-attributes">Key attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../lava_architecture_overview.html#why-do-we-need-lava">Why do we need Lava?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../lava_architecture_overview.html#lava-s-foundational-concepts">Lava’s foundational concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../lava_architecture_overview.html#processes">1. Processes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava_architecture_overview.html#behavioral-implementations-via-processmodels">2. Behavioral implementations via ProcessModels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava_architecture_overview.html#composability-and-connectivity">3. Composability and connectivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava_architecture_overview.html#cross-platform-execution">4. Cross-platform execution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../lava_architecture_overview.html#lava-software-stack">Lava software stack</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../getting_started_with_lava.html">Getting Started with Lava</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../in_depth/tutorial01_installing_lava.html">Installing Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial01_installing_lava.html#1.-System-Requirements">1. System Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial01_installing_lava.html#2.-Getting-Started">2. Getting Started</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial01_installing_lava.html#2.1-Cloning-Lava-and-Running-from-Source">2.1 Cloning Lava and Running from Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial01_installing_lava.html#2.2-[Alternative]-Installing-Lava-from-Binaries">2.2 [Alternative] Installing Lava from Binaries</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial01_installing_lava.html#3.-Running-Lava-on-Intel-Loihi">3. Running Lava on Intel Loihi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial01_installing_lava.html#4.-Lava-Developer-Guide">4. Lava Developer Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial01_installing_lava.html#5.-Tutorials">5. Tutorials</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial01_installing_lava.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial00_tour_through_lava.html">Walk through Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial00_tour_through_lava.html#1.-Usage-of-the-Process-Library">1. Usage of the Process Library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial00_tour_through_lava.html#Processes">Processes</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial00_tour_through_lava.html#Ports-and-connections">Ports and connections</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial00_tour_through_lava.html#Variables">Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial00_tour_through_lava.html#Record-internal-Vars-over-time">Record internal Vars over time</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial00_tour_through_lava.html#Execution">Execution</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial00_tour_through_lava.html#Retrieve-recorded-data">Retrieve recorded data</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial00_tour_through_lava.html#Summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial00_tour_through_lava.html#Learn-more-about">Learn more about</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tutorial00_tour_through_lava.html#2.-Create-a-custom-Process">2. Create a custom Process</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial00_tour_through_lava.html#Create-a-new-ProcessModel">Create a new ProcessModel</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial00_tour_through_lava.html#Use-the-custom-SpikeGenerator">Use the custom SpikeGenerator</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial00_tour_through_lava.html#Execute-and-plot">Execute and plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial00_tour_through_lava.html#id1">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial00_tour_through_lava.html#id2">Learn more about</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial00_tour_through_lava.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../in_depth/tutorial02_processes.html">Processes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial02_processes.html#Recommended-tutorials-before-starting:">Recommended tutorials before starting:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial02_processes.html#What-is-a-Process?">What is a <em>Process</em>?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial02_processes.html#How-to-build-a-Process?">How to build a <em>Process</em>?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial02_processes.html#Overall-architecture">Overall architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial02_processes.html#AbstractProcess:-Defining-Vars,-Ports,-and-the-API"><em>AbstractProcess</em>: Defining <em>Vars</em>, <em>Ports</em>, and the API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial02_processes.html#ProcessModel:-Defining-the-behavior-of-a-Process"><em>ProcessModel</em>: Defining the behavior of a <em>Process</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial02_processes.html#Instantiating-the-Process">Instantiating the <em>Process</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial02_processes.html#Interacting-with-Processes">Interacting with <em>Processes</em></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial02_processes.html#Accessing-Vars">Accessing <em>Vars</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial02_processes.html#Using-custom-APIs">Using custom APIs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial02_processes.html#Executing-a-Process">Executing a <em>Process</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial02_processes.html#Update-Vars">Update <em>Vars</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial02_processes.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../in_depth/tutorial03_process_models.html"><em>ProcessModels</em></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial03_process_models.html#Recommended-tutorials-before-starting:">Recommended tutorials before starting:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial03_process_models.html#Create-a-LIF-Process">Create a LIF <em>Process</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial03_process_models.html#Create-a-Python-LeafProcessModel-that-implements-the-LIF-Process">Create a Python <em>LeafProcessModel</em> that implements the LIF <em>Process</em></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial03_process_models.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial03_process_models.html#Defining-a-PyLifModel-for-LIF">Defining a <em>PyLifModel</em> for LIF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial03_process_models.html#Compile-and-run-PyLifModel">Compile and run <em>PyLifModel</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial03_process_models.html#Selecting-1-ProcessModel:-More-on-LeafProcessModel-attributes-and-relations">Selecting 1 <em>ProcessModel</em>: More on <em>LeafProcessModel</em> attributes and relations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial03_process_models.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../in_depth/tutorial04_execution.html">Execution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial04_execution.html#Recommended-tutorials-before-starting:">Recommended tutorials before starting:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial04_execution.html#Configuring-and-starting-execution">Configuring and starting execution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial04_execution.html#Run-conditions">Run conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial04_execution.html#Run-configurations">Run configurations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial04_execution.html#Running-multiple-Processes">Running multiple <em>Processes</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial04_execution.html#Pausing,-resuming,-and-stopping-execution">Pausing, resuming, and stopping execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial04_execution.html#Manual-compilation-and-execution">Manual compilation and execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial04_execution.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../in_depth/tutorial05_connect_processes.html">Connect processes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial05_connect_processes.html#Recommended-tutorials-before-starting:">Recommended tutorials before starting:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial05_connect_processes.html#Building-a-network-of-Processes">Building a network of <em>Processes</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial05_connect_processes.html#Create-a-connection">Create a connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial05_connect_processes.html#Possible-connections">Possible connections</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial05_connect_processes.html#There-are-some-things-to-consider-though:">There are some things to consider though:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial05_connect_processes.html#Connect-multiple-InPorts-from-a-single-OutPort">Connect multiple <em>InPorts</em> from a single <em>OutPort</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial05_connect_processes.html#Connecting-multiple-InPorts-to-a-single-OutPort">Connecting multiple <em>InPorts</em> to a single <em>OutPort</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial05_connect_processes.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../in_depth/tutorial06_hierarchical_processes.html">Hierarchical <em>Processes</em> and <em>SubProcessModels</em></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial06_hierarchical_processes.html#Recommended-tutorials-before-starting:">Recommended tutorials before starting:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial06_hierarchical_processes.html#Create-LIF-and-Dense-Processes-and-ProcessModels">Create LIF and Dense <em>Processes</em> and <em>ProcessModels</em></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial06_hierarchical_processes.html#Create-a-Dense-connection-Process">Create a Dense connection <em>Process</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial06_hierarchical_processes.html#Create-a-Python-Dense-connection-ProcessModel-implementing-the-Loihi-Sync-Protocol-and-requiring-a-CPU-compute-resource">Create a Python Dense connection <em>ProcessModel</em> implementing the Loihi Sync Protocol and requiring a CPU compute resource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial06_hierarchical_processes.html#Create-a-LIF-neuron-Process">Create a LIF neuron <em>Process</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial06_hierarchical_processes.html#Create-a-Python-LIF-neuron-ProcessModel-implementing-the-Loihi-Sync-Protocol-and-requiring-a-CPU-compute-resource">Create a Python LIF neuron <em>ProcessModel</em> implementing the Loihi Sync Protocol and requiring a CPU compute resource</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial06_hierarchical_processes.html#Create-a-DenseLayer-Hierarchical-Process-that-encompasses-Dense-and-LIF-Process-behavior">Create a DenseLayer Hierarchical <em>Process</em> that encompasses Dense and LIF <em>Process</em> behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial06_hierarchical_processes.html#Create-a-SubProcessModel-that-implements-the-DenseLayer-Process-using-Dense-and-LIF-child-Processes">Create a <em>SubProcessModel</em> that implements the DenseLayer <em>Process</em> using Dense and LIF child <em>Processes</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial06_hierarchical_processes.html#Run-the-DenseLayer-Process">Run the DenseLayer <em>Process</em></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial06_hierarchical_processes.html#Run-Connected-DenseLayer-Processes">Run Connected DenseLayer <em>Processes</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial06_hierarchical_processes.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../in_depth/tutorial07_remote_memory_access.html">Remote Memory Access</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial07_remote_memory_access.html#Recommended-tutorials-before-starting:">Recommended tutorials before starting:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial07_remote_memory_access.html#Create-a-minimal-Process-and-ProcessModel-with-a-RefPort">Create a minimal <em>Process</em> and <em>ProcessModel</em> with a <em>RefPort</em></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial07_remote_memory_access.html#Create-a-Python-Process-Model-implementing-the-Loihi-Sync-Protocol-and-requiring-a-CPU-compute-resource">Create a Python Process Model implementing the Loihi Sync Protocol and requiring a CPU compute resource</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial07_remote_memory_access.html#Run-the-Processes">Run the <em>Processes</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial07_remote_memory_access.html#Implicit-and-explicit-VarPorts">Implicit and explicit VarPorts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial07_remote_memory_access.html#Options-to-connect-RefPorts-and-VarPorts">Options to connect RefPorts and VarPorts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial07_remote_memory_access.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial01_mnist_digit_classification.html">MNIST Digit Classification with Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial01_mnist_digit_classification.html#This-tutorial-assumes-that-you:">This tutorial assumes that you:</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial01_mnist_digit_classification.html#This-tutorial-gives-a-bird’s-eye-view-of">This tutorial gives a bird’s-eye view of</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial01_mnist_digit_classification.html#Our-MNIST-Classifier">Our MNIST Classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial01_mnist_digit_classification.html#General-Imports">General Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial01_mnist_digit_classification.html#Lava-Processes">Lava Processes</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial01_mnist_digit_classification.html#ProcessModels-for-Python-execution">ProcessModels for Python execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial01_mnist_digit_classification.html#Connecting-Processes">Connecting Processes</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial01_mnist_digit_classification.html#Execution-and-results">Execution and results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial01_mnist_digit_classification.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tutorial01_mnist_digit_classification.html#Follow-the-links-below-for-deep-dive-tutorials-on-the-concepts-in-this-tutorial:">Follow the links below for deep-dive tutorials on the concepts in this tutorial:</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Excitatory-Inhibitory Neural Network with Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#This-tutorial-assumes-that-you:">This tutorial assumes that you:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#This-tutorial-gives-a-high-level-view-of">This tutorial gives a high level view of</a></li>
<li class="toctree-l3"><a class="reference internal" href="#E/I-Network">E/I Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="#General-imports">General imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="#E/I-Network-Lava-Process">E/I Network Lava Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ProcessModels-for-Python-execution">ProcessModels for Python execution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Rate-neurons">Rate neurons</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Defining-the-parameters-for-the-network">Defining the parameters for the network</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Execution-and-Results">Execution and Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Visualizing-the-activity">Visualizing the activity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Further-analysis">Further analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Controlling-the-network">Controlling the network</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#LIF-Neurons">LIF Neurons</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id7">Execution and Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">Visualizing the activity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">Controlling the network</a></li>
<li class="toctree-l3"><a class="reference internal" href="#DIfferent-recurrent-activation-regimes">DIfferent recurrent activation regimes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Running-a-ProcessModel-bit-accurate-with-Loihi">Running a ProcessModel bit-accurate with Loihi</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Execution-of-bit-accurate-model">Execution of bit accurate model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Follow-the-links-below-for-deep-dive-tutorials-on-the-concepts-in-this-tutorial:">Follow the links below for deep-dive tutorials on the concepts in this tutorial:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../in_depth/tutorial08_stdp.html">Spike-timing Dependent Plasticity (STDP)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial08_stdp.html#This-tutorial-assumes-that-you:">This tutorial assumes that you:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial08_stdp.html#STDP-from-Lavas-Process-Library">STDP from Lavas Process Library</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial08_stdp.html#The-plastic-connection-Process">The plastic connection Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial08_stdp.html#Plot-spike-trains">Plot spike trains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial08_stdp.html#Plot-traces">Plot traces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial08_stdp.html#Plot-STDP-learning-window-and-weight-changes">Plot STDP learning window and weight changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../in_depth/tutorial09_custom_learning_rules.html">Custom Learning Rules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial09_custom_learning_rules.html#This-tutorial-assumes-that-you:">This tutorial assumes that you:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/tutorial09_custom_learning_rules.html#2.-Loihi’s-learning-engine">2. Loihi’s learning engine</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial09_custom_learning_rules.html#Epoch-based-updates">Epoch-based updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial09_custom_learning_rules.html#Synaptic-variables">Synaptic variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial09_custom_learning_rules.html#Learning-rules">Learning rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial09_custom_learning_rules.html#Dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial09_custom_learning_rules.html#Scaling-factors">Scaling factors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial09_custom_learning_rules.html#Factors">Factors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial09_custom_learning_rules.html#Traces">Traces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial09_custom_learning_rules.html#Example:-Basic-pair-based-STDP">Example: Basic pair-based STDP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial09_custom_learning_rules.html#Instantiating-LearningRule">Instantiating LearningRule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial09_custom_learning_rules.html#The-plastic-connection-Process">The plastic connection Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial09_custom_learning_rules.html#Plot-spike-trains">Plot spike trains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial09_custom_learning_rules.html#Plot-traces">Plot traces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial09_custom_learning_rules.html#Plot-STDP-learning-window-and-weight-changes">Plot STDP learning window and weight changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/tutorial09_custom_learning_rules.html#Follow-the-links-below-for-deep-dive-tutorials-on-the-concepts-in-this-tutorial:">Follow the links below for deep-dive tutorials on the concepts in this tutorial:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../in_depth/three_factor_learning/tutorial01_Reward_Modulated_STDP.html">Three Factor Learning with Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/three_factor_learning/tutorial01_Reward_Modulated_STDP.html#This-tutorial-assumes-that-you:">This tutorial assumes that you:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/three_factor_learning/tutorial01_Reward_Modulated_STDP.html#Defining-three-factor-learning-rule-interfaces-in-Lava">Defining three-factor learning rule interfaces in Lava</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/three_factor_learning/tutorial01_Reward_Modulated_STDP.html#Reward-modulated-Spike-Timing-Dependent-Plasticity-(R-STDP)-learning-rule">Reward-modulated Spike-Timing Dependent Plasticity (R-STDP) learning rule</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/three_factor_learning/tutorial01_Reward_Modulated_STDP.html#Defining-a-simple-learning-network-with-localized-reward-signals">Defining a simple learning network with localized reward signals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/three_factor_learning/tutorial01_Reward_Modulated_STDP.html#Initialize-network-parameters-and-weights">Initialize network parameters and weights</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/three_factor_learning/tutorial01_Reward_Modulated_STDP.html#Generate-binary-input-and-graded-reward-spikes">Generate binary input and graded reward spikes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/three_factor_learning/tutorial01_Reward_Modulated_STDP.html#Initialize-Network-Processes">Initialize Network Processes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/three_factor_learning/tutorial01_Reward_Modulated_STDP.html#Connect-Network-Processes">Connect Network Processes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/three_factor_learning/tutorial01_Reward_Modulated_STDP.html#Create-monitors-to-observe-the-weight-and-trace-dynamics-during-learning">Create monitors to observe the weight and trace dynamics during learning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/three_factor_learning/tutorial01_Reward_Modulated_STDP.html#Run-the-network">Run the network</a></li>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/three_factor_learning/tutorial01_Reward_Modulated_STDP.html#Visualize-the-learning-results">Visualize the learning results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/three_factor_learning/tutorial01_Reward_Modulated_STDP.html#Plot-eligibility-trace-dynamics">Plot eligibility trace dynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/three_factor_learning/tutorial01_Reward_Modulated_STDP.html#Plot-reward-trace-dynamics">Plot reward trace dynamics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/three_factor_learning/tutorial01_Reward_Modulated_STDP.html#Advanced-Topic:-Implementing-custom-learning-rule-interfaces">Advanced Topic: Implementing custom learning rule interfaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="../in_depth/three_factor_learning/tutorial01_Reward_Modulated_STDP.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../in_depth/three_factor_learning/tutorial01_Reward_Modulated_STDP.html#Follow-the-links-below-for-deep-dive-tutorials-on-the-concepts-in-this-tutorial:">Follow the links below for deep-dive tutorials on the concepts in this tutorial:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../algorithms.html">Algorithms and Application Libraries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../dl.html">Deep Learning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../dl.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dl.html#lava-dl-workflow">Lava-DL Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dl.html#getting-started">Getting Started</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dl.html#slayer-2-0">SLAYER 2.0</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../dl.html#example-code">Example Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../dl.html#bootstrap">Bootstrap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../dl.html#example-code-1">Example Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../dl.html#network-exchange-netx-library">Network Exchange (NetX) Library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../dl.html#example-code-2">Example Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../dl.html#detailed-description">Detailed Description</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/slayer.html">Lava-DL SLAYER</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/bootstrap/bootstrap.html">Lava-DL Bootstrap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/netx/netx.html">Lava-DL NetX</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../dnf.html">Dynamic Neural Fields</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../dnf.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dnf.html#what-is-lava-dnf">What is lava-dnf?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dnf.html#key-features">Key features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dnf.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../optimization.html">Neuromorphic Constrained Optimization Library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../optimization.html#about-the-project">About the Project</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../optimization.html#taxonomy-of-optimization-problems">Taxonomy of Optimization Problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimization.html#optimizationsolver-and-optimizationproblem-classes">OptimizationSolver and OptimizationProblem Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimization.html#tutorials">Tutorials</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../optimization.html#quadratic-programming">Quadratic Programming</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimization.html#quadratic-uncosntrained-binary-optimization">Quadratic Uncosntrained Binary Optimization</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimization.html#examples">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../optimization.html#solving-qp-problems">Solving QP problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimization.html#solving-qubo">Solving QUBO</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimization.html#getting-started">Getting Started</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../optimization.html#requirements">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimization.html#installation">Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimization.html#alternative-installing-lava-via-conda">[Alternative] Installing Lava via Conda</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer_guide.html">Developer Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide.html#lava-s-origins">Lava’s Origins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide.html#contact-information">Contact Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide.html#development-roadmap">Development Roadmap</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#initial-release">Initial Release</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide.html#how-to-contribute-to-lava">How to contribute to Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#open-an-issue">Open an Issue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#pull-request-checklist">Pull Request Checklist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#open-a-pull-request">Open a Pull Request</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide.html#coding-conventions">Coding Conventions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#code-requirements">Code Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#guidelines">Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#docstring-format">Docstring Format</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide.html#contributors">Contributors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#contributor">Contributor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#committer">Committer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../developer_guide.html#list-of-lava-nc-lava-project-committers">List of lava-nc/lava Project Committers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../developer_guide.html#list-of-lava-nc-lava-dnf-project-committers">List of lava-nc/lava-dnf Project Committers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../developer_guide.html#list-of-lava-nc-lava-optimization-project-committers">List of lava-nc/lava-optimization Project Committers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../developer_guide.html#list-of-lava-nc-lava-dl-project-committers">List of lava-nc/lava-dl Project Committers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../developer_guide.html#committer-promotion">Committer Promotion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide.html#repository-structure">Repository Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#id17">lava-nc/lava</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#lava-nc-lava-dnf">lava-nc/lava-dnf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#lava-nc-lava-dl">lava-nc/lava-dl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#lava-nc-lava-optimization">lava-nc/lava-optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#lava-nc-lava-docs">lava-nc/lava-docs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide.html#code-of-conduct">Code of Conduct</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide.html#licenses">Licenses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../lava_api_documentation.html">Lava API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lava.html">Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lava.magma.html">Magma</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lava.magma.compiler.html">lava.magma.compiler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.magma.core.html">lava.magma.core</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.magma.runtime.html">lava.magma.runtime</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lava.proc.html">Lava process library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.conv.html">lava.proc.conv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.dense.html">lava.proc.dense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.io.html">lava.proc.io</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.learning_rules.html">lava.proc.learning_rules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.lif.html">lava.proc.lif</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.monitor.html">lava.proc.monitor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.receiver.html">lava.proc.receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.sdn.html">lava.proc.sdn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.spiker.html">lava.proc.spiker</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lava.utils.html">Lava Utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lava.utils.dataloader.html">lava.utils.dataloader</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.utils.html#lava-utils-float2fixed">lava.utils.float2fixed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.utils.html#lava-utils-profiler">lava.utils.profiler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.utils.html#lava-utils-system">lava.utils.system</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.utils.html#lava-utils-validator">lava.utils.validator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.utils.html#lava-utils-visualizer">lava.utils.visualizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.utils.html#lava-utils-weightutils">lava.utils.weightutils</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../lava-lib-dl/index.html">Lava - Deep Learning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-dl/slayer/index.html">SLAYER</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/neuron/modules.html">Neuron</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/synapse/modules.html">Synapse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/spike/modules.html">Spike</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/axon/modules.html">Axon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/dendrite/modules.html">Dendrite</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/block/modules.html">Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/loss.html">Loss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/classifier.html">Classifier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/io.html">Input/Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/auto.html">Auto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/utils/modules.html">Utilities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-dl/slayer/index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-dl/bootstrap/index.html">Bootstrap (ANN-SNN training)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/bootstrap/block/modules.html">Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/bootstrap/ann_sampler.html">ANN Statistics Sampler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/bootstrap/routine.html">Routine</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-dl/bootstrap/index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-dl/netx/index.html">Lava-DL NetX</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/netx/blocks/modules.html">Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/netx/hdf5.html">HDF5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/netx/utils.html">Utils</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-dl/netx/index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.html">Lava - Dynamic Neural Fields</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.connect.html">lava.lib.dnf.connect</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.connect.html#lava-lib-dnf-connect-connect">lava.lib.dnf.connect.connect</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.connect.html#lava-lib-dnf-connect-exceptions">lava.lib.dnf.connect.exceptions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.kernels.html">lava.lib.dnf.kernels</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.kernels.html#lava-lib-dnf-kernels-kernels">lava.lib.dnf.kernels.kernels</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.operations.html">lava.lib.dnf.operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.operations.html#lava-lib-dnf-operations-enums">lava.lib.dnf.operations.enums</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.operations.html#lava-lib-dnf-operations-exceptions">lava.lib.dnf.operations.exceptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.operations.html#lava-lib-dnf-operations-operations">lava.lib.dnf.operations.operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.operations.html#lava-lib-dnf-operations-shape-handlers">lava.lib.dnf.operations.shape_handlers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.inputs.html">lava.lib.dnf.inputs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.inputs.gauss_pattern.html">lava.lib.dnf.inputs.gauss_pattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.inputs.rate_code_spike_gen.html">lava.lib.dnf.inputs.rate_code_spike_gen</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.utils.html">lava.lib.dnf.utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.utils.html#lava-lib-dnf-utils-convenience">lava.lib.dnf.utils.convenience</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.utils.html#lava-lib-dnf-utils-math">lava.lib.dnf.utils.math</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.utils.html#lava-lib-dnf-utils-plotting">lava.lib.dnf.utils.plotting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dnf/lava.lib.dnf.utils.html#lava-lib-dnf-utils-validation">lava.lib.dnf.utils.validation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.html">Lava - Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.problems.html">lava.lib.optimization.problems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.problems.bayesian.html">lava.lib.optimization.problems.bayesian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.problems.html#lava-lib-optimization-problems-coefficients">lava.lib.optimization.problems.coefficients</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.problems.html#lava-lib-optimization-problems-constraints">lava.lib.optimization.problems.constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.problems.html#lava-lib-optimization-problems-cost">lava.lib.optimization.problems.cost</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.problems.html#lava-lib-optimization-problems-problems">lava.lib.optimization.problems.problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.problems.html#lava-lib-optimization-problems-variables">lava.lib.optimization.problems.variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.solvers.html">lava.lib.optimization.solvers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.solvers.bayesian.html">lava.lib.optimization.solvers.bayesian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.solvers.generic.html">lava.lib.optimization.solvers.generic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.solvers.qp.html">lava.lib.optimization.solvers.qp</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.utils.html">lava.lib.optimization.utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.utils.generators.html">lava.lib.optimization.utils.generators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.utils.html#lava-lib-optimization-utils-solver-tuner">lava.lib.optimization.utils.solver_tuner</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Lava</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../getting_started_with_lava.html">Getting Started with Lava</a></li>
      <li class="breadcrumb-item active">Excitatory-Inhibitory Neural Network with Lava</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/lava/notebooks/end_to_end/tutorial02_excitatory_inhibitory_network.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<p><em>Copyright (C) 2022-23 Intel Corporation</em> <em>SPDX-License-Identifier: BSD-3-Clause</em> <em>See: https://spdx.org/licenses/</em></p>
<hr class="docutils" />
<section id="Excitatory-Inhibitory-Neural-Network-with-Lava">
<h1>Excitatory-Inhibitory Neural Network with Lava<a class="headerlink" href="#Excitatory-Inhibitory-Neural-Network-with-Lava" title="Permalink to this heading"></a></h1>
<p><strong>Motivation</strong>: In this tutorial, we will build a Lava Process for a neural networks of excitatory and inhibitory neurons (E/I network). E/I networks are a fundamental example of neural networks mimicking the structure of the brain and exhibiting rich dynamical behavior.</p>
<section id="This-tutorial-assumes-that-you:">
<h2>This tutorial assumes that you:<a class="headerlink" href="#This-tutorial-assumes-that-you:" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>have the <a class="reference internal" href="../in_depth/tutorial01_installing_lava.html"><span class="doc">Lava framework installed</span></a></p></li>
<li><p>are familiar with the <a class="reference internal" href="../in_depth/tutorial02_processes.html"><span class="doc">Process concept in Lava</span></a></p></li>
</ul>
</section>
<section id="This-tutorial-gives-a-high-level-view-of">
<h2>This tutorial gives a high level view of<a class="headerlink" href="#This-tutorial-gives-a-high-level-view-of" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>how to implement simple E/I Network Lava Process</p></li>
<li><p>how to define and select multiple ProcessModels for the E/I Network, based on Rate and <a class="reference external" href="https://github.com/lava-nc/lava/tree/main/src/lava/proc/lif">Leaky Integrate-and-Fire (LIF)</a> neurons</p></li>
<li><p>how to use tags to chose between different ProcessModels when running the Process</p></li>
<li><p>the principle adjustments needed to run bit-accurate ProcessModels</p></li>
</ul>
</section>
<section id="E/I-Network">
<h2>E/I Network<a class="headerlink" href="#E/I-Network" title="Permalink to this heading"></a></h2>
<p>From bird’s-eye view, an E/I network is a recurrently coupled network of neurons. Since positive couplings (excitatory synapses) alone lead to a positive feedback loop ultimately causing a divergence in the activity of the network, appropriate negative couplings (inhibitory synapses) need to be introduced to counterbalance this effect. We here require a separation of the neurons into two populations: Neurons can either be inhibitory or excitatory. Such networks exhibit different dynamical
states. By introducing a control parameter, we can switch between these states and simultaneously alter the response properties of the network. In the notebook below, we introduce two incarnations of E/I networks with different single neuron models: Rate and LIF neurons. By providing a utility function that maps the weights from rate to LIF networks, we can retain hallmark properties of the dynamic in both networks. Technically, the abstract E/I network is implemented via a LavaProcess, the
concrete behavior - Rate and LIF dynamics - is realized with different ProcessModels.</p>
</section>
<section id="General-imports">
<h2>General imports<a class="headerlink" href="#General-imports" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
</section>
<section id="E/I-Network-Lava-Process">
<h2>E/I Network Lava Process<a class="headerlink" href="#E/I-Network-Lava-Process" title="Permalink to this heading"></a></h2>
<p>We define the structure of the E/I Network Lava Process class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import Process level primitives.</span>
<span class="kn">from</span> <span class="nn">lava.magma.core.process.process</span> <span class="kn">import</span> <span class="n">AbstractProcess</span>
<span class="kn">from</span> <span class="nn">lava.magma.core.process.variable</span> <span class="kn">import</span> <span class="n">Var</span>
<span class="kn">from</span> <span class="nn">lava.magma.core.process.ports.ports</span> <span class="kn">import</span> <span class="n">InPort</span><span class="p">,</span> <span class="n">OutPort</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">EINetwork</span><span class="p">(</span><span class="n">AbstractProcess</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Network of recurrently connected neurons.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">shape_exc</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;shape_exc&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
        <span class="n">bias_exc</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;bias_exc&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">shape_inh</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;shape_inh&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
        <span class="n">bias_inh</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;bias_inh&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># Factor controlling strength of inhibitory synapses relative to excitatory synapses.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g_factor</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;g_factor&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="c1"># Factor controlling response properties of network.</span>
        <span class="c1"># Larger q_factor implies longer lasting effect of provided input.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q_factor</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;q_factor&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;weights&quot;</span><span class="p">)</span>

        <span class="n">full_shape</span> <span class="o">=</span> <span class="n">shape_exc</span> <span class="o">+</span> <span class="n">shape_inh</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">full_shape</span><span class="p">,),</span> <span class="n">init</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># Variable for possible alternative state.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_alt</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">full_shape</span><span class="p">,),</span> <span class="n">init</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># Biases provided to neurons.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias_exc</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">shape_exc</span><span class="p">,),</span> <span class="n">init</span><span class="o">=</span><span class="n">bias_exc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias_inh</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">shape_inh</span><span class="p">,),</span> <span class="n">init</span><span class="o">=</span><span class="n">bias_inh</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">Var</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">full_shape</span><span class="p">,</span> <span class="n">full_shape</span><span class="p">),</span> <span class="n">init</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>

        <span class="c1"># Ports for receiving input or sending output.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inport</span> <span class="o">=</span> <span class="n">InPort</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">full_shape</span><span class="p">,))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outport</span> <span class="o">=</span> <span class="n">OutPort</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">full_shape</span><span class="p">,))</span>
</pre></div>
</div>
</div>
</section>
<section id="ProcessModels-for-Python-execution">
<h2>ProcessModels for Python execution<a class="headerlink" href="#ProcessModels-for-Python-execution" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import parent classes for ProcessModels for Hierarchical Processes.</span>
<span class="kn">from</span> <span class="nn">lava.magma.core.model.py.model</span> <span class="kn">import</span> <span class="n">PyLoihiProcessModel</span>
<span class="kn">from</span> <span class="nn">lava.magma.core.model.sub.model</span> <span class="kn">import</span> <span class="n">AbstractSubProcessModel</span>

<span class="c1"># Import execution protocol.</span>
<span class="kn">from</span> <span class="nn">lava.magma.core.sync.protocols.loihi_protocol</span> <span class="kn">import</span> <span class="n">LoihiProtocol</span>

<span class="c1"># Import decorators.</span>
<span class="kn">from</span> <span class="nn">lava.magma.core.decorator</span> <span class="kn">import</span> <span class="n">implements</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">requires</span>
</pre></div>
</div>
</div>
<section id="Rate-neurons">
<h3>Rate neurons<a class="headerlink" href="#Rate-neurons" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>We next turn to the different implementations of the E/I Network. We start with a rate network obeying the equation :nbsphinx-math:<a href="#id1"><span class="problematic" id="id2">`</span></a>begin{equation}</dt><dd><p>taudot{r} =  -r + W phi(r) + I_{mathrm{bias}}.</p>
</dd>
<dt>end{equation}` The rate or state <span class="math">r</span> is a vector containing the excitatory and inhibitory populations. The non-linearity <span class="math">\phi</span> is chosen to be the error function. The dynamics consists of a dampening part (<span class="math">-r</span>), a part modelling the recurrent connectivity ($ W <span class="math">\phi`(r)\ :math:</span>)  and an external bias (<cite>I_{:nbsphinx-math:</cite>mathrm{bias}`})$. We discretize the equation as follows: :nbsphinx-math:<a href="#id3"><span class="problematic" id="id4">`</span></a>begin{equation}</dt><dd><p>r(i + 1) = (1 - dr) odot r(i) + W phi(r(i)) odot dr + I_{mathrm{bias}} odot dr</p>
</dd>
</dl>
<p>end{equation}` Potentially different time scales in the neuron dynamics of excitatory and inhibitory neurons as well as different bias currents for these subpopulations are encoded in the vectors <span class="math">dr</span> and <span class="math">I_{\mathrm{bias}}</span>. We use the error function as non-linearity <span class="math">\phi</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lava.magma.core.model.py.type</span> <span class="kn">import</span> <span class="n">LavaPyType</span>
<span class="kn">from</span> <span class="nn">lava.magma.core.model.py.ports</span> <span class="kn">import</span> <span class="n">PyInPort</span><span class="p">,</span> <span class="n">PyOutPort</span>
<span class="kn">from</span> <span class="nn">lava.magma.core.resources</span> <span class="kn">import</span> <span class="n">CPU</span>
<span class="kn">from</span> <span class="nn">lava.magma.core.model.model</span> <span class="kn">import</span> <span class="n">AbstractProcessModel</span>

<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">erf</span>

<span class="nd">@implements</span><span class="p">(</span><span class="n">proc</span><span class="o">=</span><span class="n">EINetwork</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">LoihiProtocol</span><span class="p">)</span>
<span class="nd">@tag</span><span class="p">(</span><span class="s1">&#39;rate_neurons&#39;</span><span class="p">)</span> <span class="c1"># Tag allows for easy selection of ProcessModel in case multiple are defined.</span>
<span class="nd">@requires</span><span class="p">(</span><span class="n">CPU</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">RateEINetworkModel</span><span class="p">(</span><span class="n">PyLoihiProcessModel</span><span class="p">):</span>

    <span class="n">outport</span><span class="p">:</span> <span class="n">PyOutPort</span> <span class="o">=</span> <span class="n">LavaPyType</span><span class="p">(</span><span class="n">PyOutPort</span><span class="o">.</span><span class="n">VEC_DENSE</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
    <span class="n">inport</span><span class="p">:</span> <span class="n">PyInPort</span> <span class="o">=</span> <span class="n">LavaPyType</span><span class="p">(</span><span class="n">PyInPort</span><span class="o">.</span><span class="n">VEC_DENSE</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
    <span class="n">state</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">LavaPyType</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
    <span class="n">state_alt</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">LavaPyType</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
    <span class="n">bias_exc</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">LavaPyType</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
    <span class="n">bias_inh</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">LavaPyType</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
    <span class="n">weights</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">LavaPyType</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proc_params</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">proc_params</span><span class="o">=</span><span class="n">proc_params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dr_exc</span> <span class="o">=</span> <span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dr_exc&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dr_inh</span> <span class="o">=</span> <span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dr_inh&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">shape_exc</span> <span class="o">=</span> <span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;shape_exc&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape_inh</span> <span class="o">=</span> <span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;shape_inh&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">proc_params</span> <span class="o">=</span> <span class="n">proc_params</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">got_decay</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">got_bias</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights_scaled</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">get_decay</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Construct decay factor.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">dr_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dr_exc</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_exc</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dr_inh</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_inh</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decay</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">dr_full</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">got_decay</span><span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">get_bias</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Construce biases.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">bias_exc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias_inh</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">got_bias</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">scale_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Scale the weights with integration time step.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_exc</span><span class="p">:]</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_exc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[:,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">shape_exc</span><span class="p">]</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_inh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">overwrite</span><span class="p">(</span><span class="s1">&#39;weights&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">weights_scaled</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">state_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update network state according to:</span>
<span class="sd">            r[i + 1] = (1 - dr)r[i] + Wr[i]*r*dr + bias*dr</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">state_new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decay</span> <span class="o">*</span> <span class="n">state</span> <span class="c1"># Decay the state.</span>
        <span class="n">state_new</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias_full</span> <span class="c1"># Add the bias.</span>
        <span class="n">state_new</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">@</span> <span class="n">erf</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="c1"># Add the recurrent input.</span>
        <span class="k">return</span> <span class="n">state_new</span>

    <span class="k">def</span> <span class="nf">run_spk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The run function that performs the actual computation during</span>
<span class="sd">        execution orchestrated by a PyLoihiProcessModel using the</span>
<span class="sd">        LoihiProtocol.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">got_decay</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_decay</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">got_bias</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_bias</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights_scaled</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scale_weights</span><span class="p">()</span>

        <span class="n">a_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inport</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">)</span> <span class="o">+</span> <span class="n">a_in</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outport</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Defining-the-parameters-for-the-network">
<h2>Defining the parameters for the network<a class="headerlink" href="#Defining-the-parameters-for-the-network" title="Permalink to this heading"></a></h2>
<p>Next, we need to constrain the network with the needed parameters. First, we define the dimensionality of the network which we identify with the total number of neurons as well as the single neuron parameters. We here follow the common choice that the ratio between the number of excitatory and inhibitory neurons equals <span class="math">4</span> and that the connection probability between two arbitrary neurons is identical. The recurrent weights must <em>balance</em> the network, i.e. the average recurrent input to a
neuron must be less or equal than <span class="math">0</span>. This implies that we need to increase the strength of the inhibitory weights, the <code class="docutils literal notranslate"><span class="pre">g_factor</span></code>, to at least <span class="math">4</span>. We choose <span class="math">4.5</span> to unambiguously place the network in the inhibition dominated regime. Finally, we set a parameter that controls the response properties of the network by scaling up the recurrent weights, the <code class="docutils literal notranslate"><span class="pre">q_factor</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fix the randomness.</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>

<span class="c1"># Define dimensionality of the network.</span>
<span class="n">dim</span> <span class="o">=</span> <span class="mi">400</span>
<span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">dim</span><span class="p">,)</span>

<span class="c1"># We represent the dimensionality by 400 neurons. As stated above 80% of the neurons will be excitatory.</span>
<span class="n">num_neurons_exc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dim</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">num_neurons_inh</span> <span class="o">=</span> <span class="n">dim</span> <span class="o">-</span> <span class="n">num_neurons_exc</span>

<span class="c1"># Single neuron paramters.</span>
<span class="n">params_exc</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;shape_exc&quot;</span><span class="p">:</span> <span class="n">num_neurons_exc</span><span class="p">,</span>
    <span class="s2">&quot;dr_exc&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="s2">&quot;bias_exc&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">}</span>

<span class="n">params_inh</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;shape_inh&quot;</span><span class="p">:</span> <span class="n">num_neurons_inh</span><span class="p">,</span>
    <span class="s2">&quot;dr_inh&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="s2">&quot;bias_inh&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">}</span>

<span class="c1"># Inhibition-exciation balance for scaling inhibitory weights to maintain balance (4 times as many excitatory neurons).</span>
<span class="n">g_factor</span> <span class="o">=</span> <span class="mf">4.5</span>

<span class="c1"># Factor controlling the response properties.</span>
<span class="n">q_factor</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Parameters Paramters for E/I network.</span>
<span class="n">network_params_balanced</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">network_params_balanced</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params_exc</span><span class="p">)</span>
<span class="n">network_params_balanced</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params_inh</span><span class="p">)</span>
<span class="n">network_params_balanced</span><span class="p">[</span><span class="s1">&#39;g_factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">g_factor</span>
<span class="n">network_params_balanced</span><span class="p">[</span><span class="s1">&#39;q_factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_factor</span>
</pre></div>
</div>
</div>
<p>Finally, we have to set the weights given the above constraints. To this end, we sample the weights randomly from a Gaussian distribution with zero-mean and a standard deviation that scales with the <code class="docutils literal notranslate"><span class="pre">q_factor</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate_gaussian_weights</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">num_neurons_exc</span><span class="p">,</span> <span class="n">q_factor</span><span class="p">,</span> <span class="n">g_factor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Generate connectivity drawn from a Gaussian distribution with mean 0</span>
<span class="sd">    and std of (2 * q_factor) ** 2  / dim.</span>
<span class="sd">    If a excitatory neuron has a negative weight, we set it to 0 and similarly adapt</span>
<span class="sd">    positive weights for inhibitory neurons.</span>
<span class="sd">    W[i, j] is connection weight from pre-synaptic neuron j to post-synaptic neuron i.</span>

<span class="sd">    Paramerters</span>
<span class="sd">    -----------</span>
<span class="sd">    dim : int</span>
<span class="sd">        Dimensionality of network</span>
<span class="sd">    num_neurons_exc : int</span>
<span class="sd">        Number of excitatory neurons</span>
<span class="sd">    q_factor : float</span>
<span class="sd">        Factor determining response properties of network</span>
<span class="sd">    g_factor : float</span>
<span class="sd">        Factor determining inhibition-excitation balance</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    weights : np.ndarray</span>
<span class="sd">        E/I weight matrix</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Set scaled standard deviation of recurrent weights, J = q_factor**2 * 6 / full_shape.</span>
    <span class="n">J</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">q_factor</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">dim</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span>
                                   <span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">dim</span><span class="p">))</span>

    <span class="c1"># Impose constraint that neurons can **either** be excitatory (positive weight)</span>
    <span class="c1"># **or** inhibitory (negative weight).</span>
    <span class="n">exc_conns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">exc_conns</span><span class="p">[:,</span> <span class="n">num_neurons_exc</span><span class="p">:]</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># Set entries for inhibitory neurons to False.</span>
    <span class="n">inh_conns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">exc_conns</span><span class="p">)</span>

    <span class="n">mask_pos_weights</span> <span class="o">=</span> <span class="p">(</span><span class="n">weights</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">mask_neg_weights</span> <span class="o">=</span> <span class="p">(</span><span class="n">weights</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Set negative weights of exciatory neurons to zero and similarly for inhibitory neurons.</span>
    <span class="c1"># This induce sparsity in the connectivity.</span>
    <span class="n">weights</span><span class="p">[</span><span class="n">mask_neg_weights</span> <span class="o">*</span> <span class="n">exc_conns</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">weights</span><span class="p">[</span><span class="n">mask_pos_weights</span> <span class="o">*</span> <span class="n">inh_conns</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># We finally need to increase the inhibitory weights by a factor to control balance.</span>
    <span class="n">weights</span><span class="p">[</span><span class="n">inh_conns</span><span class="p">]</span> <span class="o">*=</span> <span class="n">g_factor</span>

    <span class="k">return</span> <span class="n">weights</span>

<span class="c1"># Generate weights and store them in parameter dictionary.</span>
<span class="n">network_params_balanced</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">generate_gaussian_weights</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span>
                                                               <span class="n">num_neurons_exc</span><span class="p">,</span>
                                                               <span class="n">network_params_balanced</span><span class="p">[</span><span class="s1">&#39;q_factor&#39;</span><span class="p">],</span>
                                                               <span class="n">network_params_balanced</span><span class="p">[</span><span class="s1">&#39;g_factor&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</section>
<section id="Execution-and-Results">
<h2>Execution and Results<a class="headerlink" href="#Execution-and-Results" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lava.magma.core.run_conditions</span> <span class="kn">import</span> <span class="n">RunSteps</span>
<span class="kn">from</span> <span class="nn">lava.magma.core.run_configs</span> <span class="kn">import</span> <span class="n">Loihi1SimCfg</span>
<span class="c1"># Import monitoring Process.</span>
<span class="kn">from</span> <span class="nn">lava.proc.monitor.process</span> <span class="kn">import</span> <span class="n">Monitor</span>

<span class="c1"># Configurations for execution.</span>
<span class="n">num_steps</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">rcfg</span> <span class="o">=</span> <span class="n">Loihi1SimCfg</span><span class="p">(</span><span class="n">select_tag</span><span class="o">=</span><span class="s1">&#39;rate_neurons&#39;</span><span class="p">)</span>
<span class="n">run_cond</span> <span class="o">=</span> <span class="n">RunSteps</span><span class="p">(</span><span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">)</span>

<span class="c1"># Instantiating network and IO processes.</span>
<span class="n">network_balanced</span> <span class="o">=</span> <span class="n">EINetwork</span><span class="p">(</span><span class="o">**</span><span class="n">network_params_balanced</span><span class="p">)</span>
<span class="n">state_monitor</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>

<span class="n">state_monitor</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">network_balanced</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>  <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">)</span>

<span class="c1"># Run the network.</span>
<span class="n">network_balanced</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">run_cfg</span><span class="o">=</span><span class="n">rcfg</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span><span class="n">run_cond</span><span class="p">)</span>
<span class="n">states_balanced</span> <span class="o">=</span> <span class="n">state_monitor</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="n">network_balanced</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="n">network_balanced</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
<span class="n">network_balanced</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Visualizing-the-activity">
<h2>Visualizing the activity<a class="headerlink" href="#Visualizing-the-activity" title="Permalink to this heading"></a></h2>
<p>We first have a look at the activity of the network by plotting the numerical value of the state of the first <span class="math">50</span> neurons.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time Step&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;State value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">states_balanced</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">50</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_19_0.png" src="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_19_0.png" />
</div>
</div>
<p>We observe that after an initial period the network settles in a fixed point. As it turns out, this is a global stable fixed point of the network dynamics: If we applied a small perturbation, the network would return to the stable state. Such a network is unfit for performing meaningful computations, the dynamics is low-dimensional and rather poor. To better understand this, we apply an additional analysis.</p>
</section>
<section id="Further-analysis">
<h2>Further analysis<a class="headerlink" href="#Further-analysis" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>We introduce the <em>auto-correlation function</em> <span class="math">c(\tau)</span>. With this function, one can assess the <em>memory</em> of the network as well as the richness of the dynamics. Denoting the (temporally averaged) network activity by <span class="math">a</span>, the <em>auto-covariance function</em> is the variance (here denoted <span class="math">\mathrm{Cov}(\cdot, \cdot)</span>) of <span class="math">a</span> with a time shifted version of itself: :nbsphinx-math:<a href="#id5"><span class="problematic" id="id6">`</span></a>begin{equation}</dt><dd><p>c(tau) = mathrm{Cov}(a(t), a(t+tau))</p>
</dd>
</dl>
<p>end{equation}` This means for positive <span class="math">\tau</span> the value of the auto-covariance function gives a measure for the similarity of the network state <span class="math">a(t)</span> and <span class="math">a(t+\tau)</span>. By comparing <span class="math">c(\tau)</span> with <span class="math">c(0)</span>, we may assess the <em>memory</em> a network has of its previous states after <span class="math">\tau</span> time steps. Note that the auto-covariance function is not normalised! Due to this, we may derive further information about the network state: If <span class="math">c(0)</span> is small (in our case
<span class="math">&lt;&lt; 1</span>), the network activity is not rich and does not exhibit a large temporal variety across neurons. Thus the networks is unable to perform meaningful computations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">auto_cov_fct</span><span class="p">(</span><span class="n">acts</span><span class="p">,</span> <span class="n">max_lag</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">200</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Auto-correlation function of parallel spike trains.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    acts : np.ndarray shape (timesteps, num_neurons)</span>
<span class="sd">        Activity of neurons, a spike is indicated by a one</span>
<span class="sd">    max_lag : int</span>
<span class="sd">        Maximal lag for compuation of auto-correlation function</span>

<span class="sd">    Returns:</span>

<span class="sd">    lags : np.ndarray</span>
<span class="sd">        lags for auto-correlation function</span>
<span class="sd">    auto_corr_fct : np.ndarray</span>
<span class="sd">        auto-correlation function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">acts_local</span> <span class="o">=</span> <span class="n">acts</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">offset</span><span class="p">:</span><span class="o">-</span><span class="n">offset</span><span class="p">]</span> <span class="c1"># Disregard time steps at beginning and end.</span>
    <span class="k">assert</span> <span class="n">max_lag</span> <span class="o">&lt;</span> <span class="n">acts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Maximal lag must be smaller then total number of time points&#39;</span>
    <span class="n">num_neurons</span> <span class="o">=</span> <span class="n">acts_local</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">acts_local</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">acts_local</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Perform temporal averaging.</span>
    <span class="n">auto_corr_fct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">max_lag</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">max_lag</span><span class="p">,</span> <span class="n">max_lag</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">max_lag</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lags</span><span class="p">):</span>
        <span class="n">shifted_acts_local</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">acts_local</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="n">lag</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">auto_corrs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">acts_local</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">act</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">acts_local</span><span class="p">):</span>
            <span class="n">auto_corrs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">act</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">act</span><span class="p">),</span>
                                   <span class="n">shifted_acts_local</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">shifted_acts_local</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span><span class="o">/</span><span class="n">num_neurons</span>
        <span class="n">auto_corr_fct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">auto_corrs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">lags</span><span class="p">,</span> <span class="n">auto_corr_fct</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lags</span><span class="p">,</span> <span class="n">ac_fct_balanced</span> <span class="o">=</span> <span class="n">auto_cov_fct</span><span class="p">(</span><span class="n">acts</span><span class="o">=</span><span class="n">states_balanced</span><span class="p">)</span>

<span class="c1"># Plotting the auto-correlation function.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Covariance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="n">ac_fct_balanced</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_23_0.png" src="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_23_0.png" />
</div>
</div>
<p>As expected, there is covariance has its maximum at a time lag of <span class="math">0</span>. Examining the covariance function, we first note its values are small (<span class="math">&lt;&lt;1</span>) implying low dimensional dynamics of the network. This fits our observation made above on the grounds of the display of the time-resolved activity.</p>
</section>
<section id="Controlling-the-network">
<h2>Controlling the network<a class="headerlink" href="#Controlling-the-network" title="Permalink to this heading"></a></h2>
<p>We saw that the states of the neurons quickly converged to a globally stable fixed point. The reason for this fixed point is, that the dampening part dominates the dynamical behavior - we need to increase the weights! This we can achieve by increasing the <code class="docutils literal notranslate"><span class="pre">q_factor</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Defining new, larger q_factor.</span>
<span class="n">q_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dim</span> <span class="o">/</span> <span class="mi">6</span><span class="p">)</span>

<span class="c1"># Changing the strenghts of the recurrent connections.</span>
<span class="n">network_params_critical</span> <span class="o">=</span> <span class="n">network_params_balanced</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">network_params_critical</span><span class="p">[</span><span class="s1">&#39;q_factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_factor</span>
<span class="n">network_params_critical</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">generate_gaussian_weights</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span>
                                                               <span class="n">num_neurons_exc</span><span class="p">,</span>
                                                               <span class="n">network_params_critical</span><span class="p">[</span><span class="s1">&#39;q_factor&#39;</span><span class="p">],</span>
                                                               <span class="n">network_params_critical</span><span class="p">[</span><span class="s1">&#39;g_factor&#39;</span><span class="p">])</span>


<span class="c1"># Configurations for execution.</span>
<span class="n">num_steps</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">rcfg</span> <span class="o">=</span> <span class="n">Loihi1SimCfg</span><span class="p">(</span><span class="n">select_tag</span><span class="o">=</span><span class="s1">&#39;rate_neurons&#39;</span><span class="p">)</span>
<span class="n">run_cond</span> <span class="o">=</span> <span class="n">RunSteps</span><span class="p">(</span><span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">)</span>

<span class="c1"># Instantiating network and IO processes.</span>
<span class="n">network_critical</span> <span class="o">=</span> <span class="n">EINetwork</span><span class="p">(</span><span class="o">**</span><span class="n">network_params_critical</span><span class="p">)</span>
<span class="n">state_monitor</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>

<span class="n">state_monitor</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">network_critical</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>  <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">)</span>

<span class="c1"># Run the network.</span>
<span class="n">network_critical</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">run_cfg</span><span class="o">=</span><span class="n">rcfg</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span><span class="n">run_cond</span><span class="p">)</span>
<span class="n">states_critical</span> <span class="o">=</span> <span class="n">state_monitor</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="n">network_critical</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="n">network_critical</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
<span class="n">network_critical</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time Step&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;State value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">states_critical</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">50</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_27_0.png" src="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_27_0.png" />
</div>
</div>
<p>We find that after increasing the <code class="docutils literal notranslate"><span class="pre">q_factor</span></code>, the network shows a very different behavior. The stable fixed point is gone, instead we observe chaotic network dynamics: The single neuron trajectories behave unpredictably and fluctuate widely, a small perturbation would lead to completely different state.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lags</span><span class="p">,</span> <span class="n">ac_fct_critical</span> <span class="o">=</span> <span class="n">auto_cov_fct</span><span class="p">(</span><span class="n">acts</span><span class="o">=</span><span class="n">states_critical</span><span class="p">)</span>

<span class="c1"># Plotting the auto-correlation function.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Correlation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="n">ac_fct_critical</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_29_0.png" src="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_29_0.png" />
</div>
</div>
<p>We moreover see that for positive time lags the auto-covariance function still is large. This means that the network has memory of its previous states: The state at a given point in time influences strongly the subsequent path of the trajectories of the neurons. Such a network can perform meaningful computations.</p>
<section id="LIF-Neurons">
<h3>LIF Neurons<a class="headerlink" href="#LIF-Neurons" title="Permalink to this heading"></a></h3>
<p>We now turn to a E/I networks implementing its dynamic behavior with leaky integrate-and-fire neurons. For this, we harness the concepts of Hierarchical Lava Processes and SubProcessModels. These allow us to avoid implementing everything ourselves, but rather to use already defined Processes and their ProcessModels to build more complicated programs. We here use the behavior defined for the <a class="reference external" href="https://github.com/lava-nc/lava/tree/main/src/lava/proc/lif">LIF</a> and
<a class="reference external" href="https://github.com/lava-nc/lava/tree/main/src/lava/proc/dense">Dense</a> Processes, we define the behavior of the E/I Network Process. Moreover, we would like to place the LIF E/I network in a similar dynamical regime as the rate network. This is a difficult task since the underlying single neurons dynamics are quite different. We here provide an approximate conversion function that allows for a parameter mapping and especially qualitatively retains properties of the auto-covariance function.
With the implementation below, we may either pass LIF specific parameters directly <strong>or</strong> use the same parameters needed for instantiating the rate E/I network and then convert them automatically.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lava.proc.dense.process</span> <span class="kn">import</span> <span class="n">Dense</span>
<span class="kn">from</span> <span class="nn">lava.proc.lif.process</span> <span class="kn">import</span> <span class="n">LIF</span>
<span class="kn">from</span> <span class="nn">convert_params</span> <span class="kn">import</span> <span class="n">convert_rate_to_lif_params</span>

<span class="nd">@implements</span><span class="p">(</span><span class="n">proc</span><span class="o">=</span><span class="n">EINetwork</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">LoihiProtocol</span><span class="p">)</span>
<span class="nd">@tag</span><span class="p">(</span><span class="s1">&#39;lif_neurons&#39;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">SubEINetworkModel</span><span class="p">(</span><span class="n">AbstractSubProcessModel</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proc</span><span class="p">):</span>

        <span class="n">convert</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;convert&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">convert</span><span class="p">:</span>
            <span class="n">proc_params</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">_parameters</span>
            <span class="c1"># Convert rate parameters to LIF parameters.</span>
            <span class="c1"># The mapping is based on:</span>
            <span class="c1"># A unified view on weakly correlated recurrent network, Grytskyy et al., 2013.</span>
            <span class="n">lif_params</span> <span class="o">=</span> <span class="n">convert_rate_to_lif_params</span><span class="p">(</span><span class="o">**</span><span class="n">proc_params</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">lif_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">proc</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;weights&#39;</span><span class="p">:</span>
                        <span class="c1"># Weights need to be updated.</span>
                        <span class="n">proc</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">_parameters</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">continue</span>

        <span class="c1"># Fetch values for excitatory neurons or set default.</span>
        <span class="n">shape_exc</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;shape_exc&#39;</span><span class="p">)</span>
        <span class="n">shape_inh</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;shape_inh&#39;</span><span class="p">)</span>
        <span class="n">du_exc</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;du_exc&#39;</span><span class="p">)</span>
        <span class="n">dv_exc</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dv_exc&#39;</span><span class="p">)</span>
        <span class="n">vth_exc</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;vth_exc&#39;</span><span class="p">)</span>
        <span class="n">bias_mant_exc</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bias_mant_exc&#39;</span><span class="p">)</span>
        <span class="n">bias_exp_exc</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bias_exp_exc&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


        <span class="c1"># Fetch values for inhibitory neurons or set default.</span>
        <span class="n">du_inh</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;du_inh&#39;</span><span class="p">)</span>
        <span class="n">dv_inh</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dv_inh&#39;</span><span class="p">)</span>
        <span class="n">vth_inh</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;vth_inh&#39;</span><span class="p">)</span>
        <span class="n">bias_mant_inh</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bias_mant_inh&#39;</span><span class="p">)</span>
        <span class="n">bias_exp_inh</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bias_exp_inh&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Create parameters for full network.</span>
        <span class="n">du_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">du_exc</span><span class="p">]</span> <span class="o">*</span> <span class="n">shape_exc</span>
                           <span class="o">+</span> <span class="p">[</span><span class="n">du_inh</span><span class="p">]</span> <span class="o">*</span> <span class="n">shape_inh</span><span class="p">)</span>
        <span class="n">dv_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dv_exc</span><span class="p">]</span> <span class="o">*</span> <span class="n">shape_exc</span>
                           <span class="o">+</span> <span class="p">[</span><span class="n">dv_inh</span><span class="p">]</span> <span class="o">*</span> <span class="n">shape_inh</span><span class="p">)</span>
        <span class="n">vth_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vth_exc</span><span class="p">]</span> <span class="o">*</span> <span class="n">shape_exc</span>
                            <span class="o">+</span> <span class="p">[</span><span class="n">vth_inh</span><span class="p">]</span> <span class="o">*</span> <span class="n">shape_inh</span><span class="p">)</span>
        <span class="n">bias_mant_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">bias_mant_exc</span><span class="p">]</span> <span class="o">*</span> <span class="n">shape_exc</span>
                                  <span class="o">+</span> <span class="p">[</span><span class="n">bias_mant_inh</span><span class="p">]</span> <span class="o">*</span> <span class="n">shape_inh</span><span class="p">)</span>
        <span class="n">bias_exp_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">bias_exp_exc</span><span class="p">]</span> <span class="o">*</span> <span class="n">shape_exc</span> <span class="o">+</span>
                                 <span class="p">[</span><span class="n">bias_exp_inh</span><span class="p">]</span> <span class="o">*</span> <span class="n">shape_inh</span><span class="p">)</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;weights&#39;</span><span class="p">)</span>
        <span class="n">weight_exp</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;weight_exp&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">full_shape</span> <span class="o">=</span> <span class="n">shape_exc</span> <span class="o">+</span> <span class="n">shape_inh</span>

        <span class="c1"># Instantiate LIF and Dense Lava Processes.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lif</span> <span class="o">=</span> <span class="n">LIF</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">full_shape</span><span class="p">,),</span>
                       <span class="n">du</span><span class="o">=</span><span class="n">du_full</span><span class="p">,</span>
                       <span class="n">dv</span><span class="o">=</span><span class="n">dv_full</span><span class="p">,</span>
                       <span class="n">vth</span><span class="o">=</span><span class="n">vth_full</span><span class="p">,</span>
                       <span class="n">bias_mant</span><span class="o">=</span><span class="n">bias_mant_full</span><span class="p">,</span>
                       <span class="n">bias_exp</span><span class="o">=</span><span class="n">bias_exp_full</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dense</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span>
                           <span class="n">weight_exp</span><span class="o">=</span><span class="n">weight_exp</span><span class="p">)</span>


        <span class="c1"># Recurrently connect neurons to E/I Network.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lif</span><span class="o">.</span><span class="n">s_out</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dense</span><span class="o">.</span><span class="n">s_in</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dense</span><span class="o">.</span><span class="n">a_out</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lif</span><span class="o">.</span><span class="n">a_in</span><span class="p">)</span>

        <span class="c1"># Connect incoming activation to neurons and elicited spikes to ouport.</span>
        <span class="n">proc</span><span class="o">.</span><span class="n">inport</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lif</span><span class="o">.</span><span class="n">a_in</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lif</span><span class="o">.</span><span class="n">s_out</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">outport</span><span class="p">)</span>

        <span class="c1"># Alias v with state and u with state_alt.</span>
        <span class="n">proc</span><span class="o">.</span><span class="n">vars</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lif</span><span class="o">.</span><span class="n">vars</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>
        <span class="n">proc</span><span class="o">.</span><span class="n">vars</span><span class="o">.</span><span class="n">state_alt</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lif</span><span class="o">.</span><span class="n">vars</span><span class="o">.</span><span class="n">u</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="id7">
<h2>Execution and Results<a class="headerlink" href="#id7" title="Permalink to this heading"></a></h2>
<p>In order to execute the LIF E/I network and the infrastructure to monitor the activity, we introduce a <code class="docutils literal notranslate"><span class="pre">CustomRunConfig</span></code> where we specify which ProcessModel we select for execution.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lava.magma.core.run_conditions</span> <span class="kn">import</span> <span class="n">RunSteps</span>
<span class="kn">from</span> <span class="nn">lava.magma.core.run_configs</span> <span class="kn">import</span> <span class="n">Loihi1SimCfg</span>
<span class="c1"># Import io processes.</span>
<span class="kn">from</span> <span class="nn">lava.proc</span> <span class="kn">import</span> <span class="n">io</span>

<span class="kn">from</span> <span class="nn">lava.proc.dense.models</span> <span class="kn">import</span> <span class="n">PyDenseModelFloat</span>
<span class="kn">from</span> <span class="nn">lava.proc.lif.models</span> <span class="kn">import</span> <span class="n">PyLifModelFloat</span>


<span class="c1"># Configurations for execution.</span>
<span class="n">num_steps</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">run_cond</span> <span class="o">=</span> <span class="n">RunSteps</span><span class="p">(</span><span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">CustomRunConfigFloat</span><span class="p">(</span><span class="n">Loihi1SimCfg</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proc</span><span class="p">,</span> <span class="n">proc_models</span><span class="p">):</span>
        <span class="c1"># Customize run config to always use float model for io.sink.RingBuffer.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">proc</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">sink</span><span class="o">.</span><span class="n">RingBuffer</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">io</span><span class="o">.</span><span class="n">sink</span><span class="o">.</span><span class="n">PyReceiveModelFloat</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">proc</span><span class="p">,</span> <span class="n">LIF</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">PyLifModelFloat</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">proc</span><span class="p">,</span> <span class="n">Dense</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">PyDenseModelFloat</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">proc</span><span class="p">,</span> <span class="n">proc_models</span><span class="p">)</span>

<span class="n">rcfg</span> <span class="o">=</span> <span class="n">CustomRunConfigFloat</span><span class="p">(</span><span class="n">select_tag</span><span class="o">=</span><span class="s1">&#39;lif_neurons&#39;</span><span class="p">,</span> <span class="n">select_sub_proc_model</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Instantiating network and IO processes.</span>
<span class="n">lif_network_balanced</span> <span class="o">=</span> <span class="n">EINetwork</span><span class="p">(</span> <span class="o">**</span><span class="n">network_params_balanced</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">outport_plug</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">sink</span><span class="o">.</span><span class="n">RingBuffer</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="n">num_steps</span><span class="p">)</span>

<span class="c1"># Instantiate Monitors to record the voltage and the current of the LIF neurons.</span>
<span class="n">monitor_v</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>
<span class="n">monitor_u</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>

<span class="n">lif_network_balanced</span><span class="o">.</span><span class="n">outport</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">outport_plug</span><span class="o">.</span><span class="n">a_in</span><span class="p">)</span>
<span class="n">monitor_v</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">lif_network_balanced</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>  <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">)</span>
<span class="n">monitor_u</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">lif_network_balanced</span><span class="o">.</span><span class="n">state_alt</span><span class="p">,</span>  <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">)</span>

<span class="n">lif_network_balanced</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">condition</span><span class="o">=</span><span class="n">run_cond</span><span class="p">,</span> <span class="n">run_cfg</span><span class="o">=</span><span class="n">rcfg</span><span class="p">)</span>

<span class="c1"># Fetching spiking activity.</span>
<span class="n">spks_balanced</span> <span class="o">=</span> <span class="n">outport_plug</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">data_v_balanced</span> <span class="o">=</span> <span class="n">monitor_v</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="n">lif_network_balanced</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="n">lif_network_balanced</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
<span class="n">data_u_balanced</span> <span class="o">=</span> <span class="n">monitor_u</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="n">lif_network_balanced</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="n">lif_network_balanced</span><span class="o">.</span><span class="n">state_alt</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>

<span class="n">lif_network_balanced</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="id8">
<h2>Visualizing the activity<a class="headerlink" href="#id8" title="Permalink to this heading"></a></h2>
<p>First, we visually inspect to spiking activity of the neurons in the network. To this end, we display neurons on the vertical axis and mark the time step when a neuron spiked.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lava.utils.plots</span> <span class="kn">import</span> <span class="n">raster_plot</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">raster_plot</span><span class="p">(</span><span class="n">spikes</span><span class="o">=</span><span class="n">spks_balanced</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_36_0.png" src="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_36_0.png" />
</div>
</div>
<p>After an initial synchronous burst (all neurons are simultaneously driven to the threshold by the external current), we observe an immediate decoupling of the single neuron activities due to the recurrent connectivity. Overall, we see a heterogeneous network state with asynchronous as well as synchronous spiking across neurons. This network state resembles qualitatively the fixed point observed above for the rate network. Before we turn to the study of the auto-covariance we need to address a
subtlety in the comparison of spiking and rate network. Comparing spike trains and rates directly is difficult due dynamics of single spiking neurons: Most of the time, a neuron does not spike! To overcome this problem and meaningfully compare quantities like the auto-covariance function, we follow the usual approach and bin the spikes. This means, we apply a sliding box-car window of a given length and count at each time step the spikes in that window to obtain an estimate of the rate.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">window_size</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">window_size</span><span class="p">)</span> <span class="c1"># Window size of 25 time steps for binning.</span>
<span class="n">binned_sps_balanced</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">spks_balanced</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">window</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)])[:,</span> <span class="p">:</span><span class="o">-</span><span class="n">window_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>After having an estimate of the rate, we compare the temporally-averaged mean rate of both networks in the first state. To avoid boundary effects of the binning, we disregard time steps at the beginning and the end.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">offset</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">timesteps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">offset</span><span class="p">:</span> <span class="o">-</span><span class="n">offset</span><span class="p">]</span>

<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mean rate of Rate network&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timesteps</span><span class="p">,</span>
         <span class="p">(</span><span class="n">states_balanced</span> <span class="o">-</span> <span class="n">states_balanced</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,:])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">offset</span><span class="p">:</span> <span class="o">-</span><span class="n">offset</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mean rate&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time Step&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mean rate of LIF network&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timesteps</span><span class="p">,</span>
         <span class="p">(</span><span class="n">binned_sps_balanced</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">binned_sps_balanced</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">offset</span><span class="p">:</span> <span class="o">-</span><span class="n">offset</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time Step&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_40_0.png" src="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_40_0.png" />
</div>
</div>
<p>Both networks behave similarly inasmuch the rates are stationary with only very small fluctuations around the baseline in the LIF case. Next, we turn to the auto-covariance function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lags</span><span class="p">,</span> <span class="n">ac_fct</span> <span class="o">=</span> <span class="n">auto_cov_fct</span><span class="p">(</span><span class="n">acts</span><span class="o">=</span><span class="n">binned_sps_balanced</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="c1"># Plotting the auto-covariance function.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Covariance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="n">ac_fct</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7feff717d4b0&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_42_1.png" src="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_42_1.png" />
</div>
</div>
<p>Examining the auto-covariance function, we first note that again the overall values are small. Moreover, we see that for non-vanishing time lags the auto-covariance function quickly decays. This means that the network has no memory of its previous states: Already after few time step we lost almost all information of the previous network state, former states leave little trace in the overall network activity. Such a network is unfit to perform meaningful computation.</p>
</section>
<section id="id9">
<h2>Controlling the network<a class="headerlink" href="#id9" title="Permalink to this heading"></a></h2>
<p>Next, we pass the rate network parameters for which we increased the <code class="docutils literal notranslate"><span class="pre">q_factor</span></code> to the spiking E/I network. Dynamically, this increase again should result in a fundamentally different network state.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_steps</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">rcfg</span> <span class="o">=</span> <span class="n">CustomRunConfigFloat</span><span class="p">(</span><span class="n">select_tag</span><span class="o">=</span><span class="s1">&#39;lif_neurons&#39;</span><span class="p">,</span> <span class="n">select_sub_proc_model</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">run_cond</span> <span class="o">=</span> <span class="n">RunSteps</span><span class="p">(</span><span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">)</span>

<span class="c1"># Creating new new network with changed weights.</span>
<span class="n">lif_network_critical</span> <span class="o">=</span> <span class="n">EINetwork</span><span class="p">(</span><span class="o">**</span><span class="n">network_params_critical</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">outport_plug</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">sink</span><span class="o">.</span><span class="n">RingBuffer</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="n">num_steps</span><span class="p">)</span>

<span class="c1"># Instantiate Monitors to record the voltage and the current of the LIF neurons.</span>
<span class="n">monitor_v</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>
<span class="n">monitor_u</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>

<span class="n">lif_network_critical</span><span class="o">.</span><span class="n">outport</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">outport_plug</span><span class="o">.</span><span class="n">a_in</span><span class="p">)</span>
<span class="n">monitor_v</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">lif_network_critical</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>  <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">)</span>
<span class="n">monitor_u</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">lif_network_critical</span><span class="o">.</span><span class="n">state_alt</span><span class="p">,</span>  <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">)</span>

<span class="n">lif_network_critical</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">condition</span><span class="o">=</span><span class="n">run_cond</span><span class="p">,</span> <span class="n">run_cfg</span><span class="o">=</span><span class="n">rcfg</span><span class="p">)</span>

<span class="c1"># Fetching spiking activity.</span>
<span class="n">spks_critical</span> <span class="o">=</span> <span class="n">outport_plug</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">data_v_critical</span> <span class="o">=</span> <span class="n">monitor_v</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="n">lif_network_critical</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="n">lif_network_critical</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
<span class="n">data_u_critical</span> <span class="o">=</span> <span class="n">monitor_u</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="n">lif_network_critical</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="n">lif_network_critical</span><span class="o">.</span><span class="n">state_alt</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>

<span class="n">lif_network_critical</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">raster_plot</span><span class="p">(</span><span class="n">spikes</span><span class="o">=</span><span class="n">spks_critical</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_46_0.png" src="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_46_0.png" />
</div>
</div>
<p>Here we see a qualitatively different network activity where the recurrent connections play a more dominant role: At seemingly random times, single neurons enter an active states of variable length. Next, we have a look at the auto-covariance function of the network, especially in direct comparison with the respective function of the rate network.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">window_size</span><span class="p">)</span>
<span class="n">binned_sps_critical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">spks_critical</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">window</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)])[:,</span> <span class="p">:</span><span class="o">-</span><span class="n">window_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">lags</span><span class="p">,</span> <span class="n">ac_fct_lif_critical</span> <span class="o">=</span> <span class="n">auto_cov_fct</span><span class="p">(</span><span class="n">acts</span><span class="o">=</span><span class="n">binned_sps_critical</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We again compare the rate of both networks in the same state.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">offset</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">timesteps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">offset</span><span class="p">:</span> <span class="o">-</span><span class="n">offset</span><span class="p">]</span>

<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mean rate of Rate network&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timesteps</span><span class="p">,</span>
         <span class="p">(</span><span class="n">states_critical</span> <span class="o">-</span> <span class="n">states_critical</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,:])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">offset</span><span class="p">:</span> <span class="o">-</span><span class="n">offset</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mean rate&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time Step&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mean rate of LIF network&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timesteps</span><span class="p">,</span>
         <span class="p">(</span><span class="n">binned_sps_critical</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">binned_sps_critical</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">offset</span><span class="p">:</span> <span class="o">-</span><span class="n">offset</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time Step&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_50_0.png" src="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_50_0.png" />
</div>
</div>
<p>Again, we observe a similar behavior on the rate level: In both networks the mean rate fluctuates on a longer time scale with larger values around the baseline in a similar range. Next we compare the auto-covariance functions:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="n">ac_fct_lif_critical</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Auto-Cov function: LIF network&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Lag&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Covariance&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="n">ac_fct_critical</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Auto-Cov function: Rate network&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Lag&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Covariance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_52_0.png" src="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_52_0.png" />
</div>
</div>
<p>We observe in the auto-covariance function of the LIF network a slowly decay, akin to the rate network. Even though both auto-covariance functions are not identical, they qualitatively match in that both networks exhibit long-lasting temporal correlations and an activity at the edge of chaos. This implies that both network are in a suitable regime for computation, e.g. in the context of reservoir computing.</p>
</section>
<section id="DIfferent-recurrent-activation-regimes">
<h2>DIfferent recurrent activation regimes<a class="headerlink" href="#DIfferent-recurrent-activation-regimes" title="Permalink to this heading"></a></h2>
<p>After having observed these two radically different dynamical states also in the LIF network, we next turn to the question how they come about. The difference between both version of LIF E/I networks is in the recurrently provided activations. We now examine these activations by having look at the excitatory, inhibitory as well as total activation provided to each neuron in both networks.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_activation</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">spks</span><span class="p">,</span> <span class="n">num_exc_neurons</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate excitatory, inhibitory and total activation to neurons.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    weights : np.ndarray (num_neurons, num_neurons)</span>
<span class="sd">        Weights of recurrent connections</span>
<span class="sd">    spks : np.ndarray (num_neurons, num_time_steps)</span>
<span class="sd">        Spike times of neurons, 0 if neuron did not spike, 1 otherwise</span>
<span class="sd">    num_exc_neurons : int</span>
<span class="sd">        Number of excitatory neurons</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    activation_exc : np.ndarray (num_neurons, num_time_steps)</span>
<span class="sd">        Excitatory activation provided to neurons</span>
<span class="sd">    activation_inh : np.ndarray (num_neurons, num_time_steps)</span>
<span class="sd">        Inhibitory activation provided to neurons</span>
<span class="sd">    activations_total : np.ndarray (num_neurons, num_time_steps)</span>
<span class="sd">        Total activation provided to neurons</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">weights_exc</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[:,</span> <span class="p">:</span><span class="n">num_exc_neurons</span><span class="p">]</span>
    <span class="n">weights_inh</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[:,</span> <span class="n">num_exc_neurons</span><span class="p">:]</span>

    <span class="n">spks_exc</span> <span class="o">=</span> <span class="n">spks</span><span class="p">[:</span><span class="n">num_exc_neurons</span><span class="p">]</span>
    <span class="n">spks_inh</span> <span class="o">=</span> <span class="n">spks</span><span class="p">[</span><span class="n">num_exc_neurons</span><span class="p">:]</span>

    <span class="n">activation_exc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">weights_exc</span><span class="p">,</span> <span class="n">spks_exc</span><span class="p">)</span>
    <span class="n">activation_inh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">weights_inh</span><span class="p">,</span> <span class="n">spks_inh</span><span class="p">)</span>

    <span class="n">activation_total</span> <span class="o">=</span> <span class="n">activation_exc</span> <span class="o">+</span> <span class="n">activation_inh</span>

    <span class="k">return</span> <span class="n">activation_exc</span><span class="p">,</span> <span class="n">activation_inh</span><span class="p">,</span> <span class="n">activation_total</span>
</pre></div>
</div>
</div>
<p>Since the network needs some time to settle in it’s dynamical state, we discard the first <span class="math">200</span> time steps.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">offset</span> <span class="o">=</span> <span class="mi">200</span>

<span class="n">act_exc_balanced</span><span class="p">,</span> <span class="n">act_inh_balanced</span><span class="p">,</span> <span class="n">act_tot_balanced</span> \
    <span class="o">=</span> <span class="n">calculate_activation</span><span class="p">(</span><span class="n">lif_network_balanced</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;weights&#39;</span><span class="p">),</span>
                          <span class="n">spks_balanced</span><span class="p">[:,</span><span class="n">offset</span><span class="p">:],</span>
                          <span class="n">network_params_balanced</span><span class="p">[</span><span class="s1">&#39;shape_exc&#39;</span><span class="p">])</span>

<span class="n">act_exc_critical</span><span class="p">,</span> <span class="n">act_inh_critical</span><span class="p">,</span> <span class="n">act_tot_critical</span> \
    <span class="o">=</span> <span class="n">calculate_activation</span><span class="p">(</span><span class="n">lif_network_critical</span><span class="o">.</span><span class="n">proc_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;weights&#39;</span><span class="p">),</span>
                          <span class="n">spks_critical</span><span class="p">[:,</span><span class="n">offset</span><span class="p">:],</span>
                          <span class="n">network_params_balanced</span><span class="p">[</span><span class="s1">&#39;shape_exc&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>First, we look at the distribution of activation of a random neuron in both network states.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rnd_neuron</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Low weights&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Activation&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">act_exc_balanced</span><span class="p">[</span><span class="n">rnd_neuron</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">act_inh_balanced</span><span class="p">[</span><span class="n">rnd_neuron</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I&#39;</span><span class="p">),</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">act_tot_balanced</span><span class="p">[</span><span class="n">rnd_neuron</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;High weights&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Activation&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">act_exc_critical</span><span class="p">[</span><span class="n">rnd_neuron</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">act_inh_critical</span><span class="p">[</span><span class="n">rnd_neuron</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">act_tot_critical</span><span class="p">[</span><span class="n">rnd_neuron</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_59_0.png" src="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_59_0.png" />
</div>
</div>
<p>Next, we plot the distribution of the temporal average:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Low weights&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Activation&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">act_exc_balanced</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">act_inh_balanced</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I&#39;</span><span class="p">),</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">act_tot_balanced</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;High weights&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Activation&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">act_exc_critical</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">act_inh_critical</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">act_tot_critical</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_61_0.png" src="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_61_0.png" />
</div>
</div>
<p>We first note that the the total activation is close to zero with a slight shift to negative values, this prevents the divergence of activity. Secondly, we observe that the width of the distributions is orders of magnitude larger in the high weight case as compared to the low weight network. Finally, we look at the evolution of the mean activation over time. To this end we plot three random sample:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_steps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Low weights&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time step&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Activation&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">act_tot_balanced</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>


<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;High weights&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time step&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Activation&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_steps</span><span class="p">,</span> <span class="n">act_tot_critical</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_63_0.png" src="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_63_0.png" />
</div>
</div>
<p>We see that the temporal evolution of the total activation in the low weights case is much narrower than in the high weights network. Moreover, we see that in the high weights network, the fluctuations of the activations evolve on a very long time scale as compared to the other network. This implies that a neuron can sustain it’s active, bursting state over longer periods of time leading to memory in the network as well as activity at the edge of chaos.</p>
<section id="Running-a-ProcessModel-bit-accurate-with-Loihi">
<h3>Running a ProcessModel bit-accurate with Loihi<a class="headerlink" href="#Running-a-ProcessModel-bit-accurate-with-Loihi" title="Permalink to this heading"></a></h3>
<p>So far, we have used neuron models and weights that are internally represented as floating point numbers. Next, we turn to bit-accurate implementations of the LIF and Dense process where only a fixed precision for the numerical values is allowed. Here, the parameters need to be mapped to retain the dynamical behavior of the network. First, we define a method for mapping the parameters. It consists of finding an optimal scaling function that consistently maps all appearing floating-point numbers
to fixed-point numbers.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">_scaling_funct</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Find optimal scaling function for float- to fixed-point mapping.</span>

<span class="sd">    Parameter</span>
<span class="sd">    ---------</span>
<span class="sd">    params : dict</span>
<span class="sd">        Dictionary containing information required for float- to fixed-point mapping</span>

<span class="sd">    Returns</span>
<span class="sd">    ------</span>
<span class="sd">    scaling_funct : callable</span>
<span class="sd">        Optimal scaling function for float- to fixed-point conversion</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">sorted_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;val&#39;</span><span class="p">])),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

    <span class="c1"># Initialize scaling function.</span>
    <span class="n">scaling_funct</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">sorted_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">val</span><span class="p">[</span><span class="s1">&#39;signed&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span>
            <span class="n">signed_shift</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">signed_shift</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">])):</span>
            <span class="n">max_abs</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">max_abs_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">max_abs</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">max_abs_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]))</span>

        <span class="k">if</span> <span class="n">max_abs</span><span class="p">:</span>
            <span class="n">rep_val</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="s1">&#39;bits&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">signed_shift</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rep_val</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="s1">&#39;bits&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">signed_shift</span><span class="p">)</span>

        <span class="n">max_shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="s1">&#39;shift&#39;</span><span class="p">])</span>

        <span class="n">max_rep_val</span> <span class="o">=</span> <span class="n">rep_val</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="n">max_shift</span>

        <span class="k">if</span> <span class="n">scaling_funct</span><span class="p">:</span>
            <span class="n">scaled_vals</span> <span class="o">=</span> <span class="n">scaling_funct</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">])</span>

            <span class="n">max_abs_scaled_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">scaled_vals</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">max_abs_scaled_vals</span> <span class="o">&lt;=</span> <span class="n">max_rep_val</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">p1</span> <span class="o">=</span> <span class="n">max_rep_val</span>
                <span class="n">p2</span> <span class="o">=</span> <span class="n">max_abs_val</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">p1</span> <span class="o">=</span> <span class="n">max_rep_val</span>
            <span class="n">p2</span> <span class="o">=</span> <span class="n">max_abs_val</span>

        <span class="n">scaling_funct</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">p1</span> <span class="o">/</span> <span class="n">p2</span> <span class="o">*</span> <span class="n">x</span>

    <span class="k">return</span> <span class="n">scaling_funct</span>

<span class="k">def</span> <span class="nf">float2fixed_lif_parameter</span><span class="p">(</span><span class="n">lif_params</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Float- to fixed-point mapping for LIF parameters.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ---------</span>
<span class="sd">    lif_params : dict</span>
<span class="sd">        Dictionary with parameters for LIF network with floating-point ProcModel</span>

<span class="sd">    Returns</span>
<span class="sd">    ------</span>
<span class="sd">    lif_params_fixed : dict</span>
<span class="sd">        Dictionary with parameters for LIF network with fixed-point ProcModel</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">scaling_funct</span> <span class="o">=</span> <span class="n">_scaling_funct</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

    <span class="n">bias_mant_bits</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;bias&#39;</span><span class="p">][</span><span class="s1">&#39;bits&#39;</span><span class="p">]</span>
    <span class="n">scaled_bias</span> <span class="o">=</span> <span class="n">scaling_funct</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;bias&#39;</span><span class="p">][</span><span class="s1">&#39;val&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">bias_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">scaled_bias</span><span class="p">)</span> <span class="o">-</span> <span class="n">bias_mant_bits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">bias_exp</span> <span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">bias_exp</span> <span class="o">=</span> <span class="mi">0</span>


    <span class="n">weight_mant_bits</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">][</span><span class="s1">&#39;bits&#39;</span><span class="p">]</span>
    <span class="n">scaled_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">scaling_funct</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">][</span><span class="s1">&#39;val&#39;</span><span class="p">]))</span>
    <span class="n">weight_exp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">scaled_bias</span><span class="p">)</span> <span class="o">-</span> <span class="n">weight_mant_bits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">weight_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">weight_exp</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span>
    <span class="k">if</span> <span class="n">weight_exp</span> <span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">weight_exp</span>
        <span class="n">weight_exp</span> <span class="o">=</span> <span class="mi">0</span>


    <span class="n">bias_mant</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">scaled_bias</span> <span class="o">//</span> <span class="mi">2</span><span class="o">**</span><span class="n">bias_exp</span><span class="p">)</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">scaled_weights</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

    <span class="n">lif_params_fixed</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vth&#39;</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">scaling_funct</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;vth&#39;</span><span class="p">][</span><span class="s1">&#39;val&#39;</span><span class="p">])</span> <span class="o">//</span> <span class="mi">2</span><span class="o">**</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;vth&#39;</span><span class="p">][</span><span class="s1">&#39;shift&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
                        <span class="s1">&#39;bias_mant&#39;</span><span class="p">:</span> <span class="n">bias_mant</span><span class="p">,</span>
                        <span class="s1">&#39;bias_exp&#39;</span><span class="p">:</span> <span class="n">bias_exp</span><span class="p">,</span>
                        <span class="s1">&#39;weights&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">scaled_weights</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">][</span><span class="s1">&#39;shift&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span>
                        <span class="s1">&#39;weight_exp&#39;</span><span class="p">:</span> <span class="n">weight_exp</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">lif_params_fixed</span>

<span class="k">def</span> <span class="nf">scaling_funct_dudv</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Scaling function for du, dv in LIF</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">assert</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Passed value must be smaller than 1&#39;</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">val</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>After having defined some primitive conversion functionality we next convert the parameters for the critical network. To constrain the values that we need to represent in the bit-accurate model, we have to find the dynamical range of the state parameters of the network, namely <code class="docutils literal notranslate"><span class="pre">u</span></code> and <code class="docutils literal notranslate"><span class="pre">v</span></code> of the LIF neurons.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Current&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data_u_critical</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Voltage&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data_v_critical</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_68_0.png" src="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_68_0.png" />
</div>
</div>
<p>We note that for both variables the distributions attain large (small) values with low probability. We hence will remove them in the dynamical range to increase the precision of the overall representation. We do so by choosing <span class="math">0.2</span> and <span class="math">0.8</span> quantiles as minimal resp. maximal values for the dynamic ranges. We finally also need to pass some information about the concrete implementation, e.g. the precision and the bit shifts performed.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u_low</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">data_u_critical</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">u_high</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">data_u_critical</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">v_low</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">data_v_critical</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">v_high</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">data_v_critical</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="mf">0.8</span><span class="p">)</span>

<span class="n">lif_params_critical</span> <span class="o">=</span> <span class="n">convert_rate_to_lif_params</span><span class="p">(</span><span class="o">**</span><span class="n">network_params_critical</span><span class="p">)</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">lif_params_critical</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">]</span>
<span class="n">bias</span> <span class="o">=</span> <span class="n">lif_params_critical</span><span class="p">[</span><span class="s1">&#39;bias_mant_exc&#39;</span><span class="p">]</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vth&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;bits&#39;</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span> <span class="s1">&#39;signed&#39;</span><span class="p">:</span> <span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="s1">&#39;shift&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">]),</span> <span class="s1">&#39;val&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">])},</span>
          <span class="s1">&#39;u&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;bits&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;signed&#39;</span><span class="p">:</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;shift&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;val&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">u_low</span><span class="p">,</span> <span class="n">u_high</span><span class="p">])},</span>
          <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;bits&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;signed&#39;</span><span class="p">:</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;shift&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;val&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">v_low</span><span class="p">,</span> <span class="n">v_high</span><span class="p">])},</span>
          <span class="s1">&#39;bias&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;bits&#39;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span> <span class="s1">&#39;signed&#39;</span><span class="p">:</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;shift&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;val&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">bias</span><span class="p">])},</span>
          <span class="s1">&#39;weights&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;bits&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;signed&#39;</span><span class="p">:</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;shift&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;val&#39;</span><span class="p">:</span> <span class="n">weights</span><span class="p">}}</span>

<span class="n">mapped_params</span> <span class="o">=</span> <span class="n">float2fixed_lif_parameter</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Using the mapped parameters, we construct the fully-fledged parameter dictionary for the E/I network Process using the LIF SubProcessModel.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up parameters for bit accurate model</span>
<span class="n">lif_params_critical_fixed</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;shape_exc&#39;</span><span class="p">:</span> <span class="n">lif_params_critical</span><span class="p">[</span><span class="s1">&#39;shape_exc&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;shape_inh&#39;</span><span class="p">:</span> <span class="n">lif_params_critical</span><span class="p">[</span><span class="s1">&#39;shape_inh&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;g_factor&#39;</span><span class="p">:</span> <span class="n">lif_params_critical</span><span class="p">[</span><span class="s1">&#39;g_factor&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;q_factor&#39;</span><span class="p">:</span> <span class="n">lif_params_critical</span><span class="p">[</span><span class="s1">&#39;q_factor&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;vth_exc&#39;</span><span class="p">:</span> <span class="n">mapped_params</span><span class="p">[</span><span class="s1">&#39;vth&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;vth_inh&#39;</span><span class="p">:</span> <span class="n">mapped_params</span><span class="p">[</span><span class="s1">&#39;vth&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;bias_mant_exc&#39;</span><span class="p">:</span> <span class="n">mapped_params</span><span class="p">[</span><span class="s1">&#39;bias_mant&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;bias_exp_exc&#39;</span><span class="p">:</span> <span class="n">mapped_params</span><span class="p">[</span><span class="s1">&#39;bias_exp&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;bias_mant_inh&#39;</span><span class="p">:</span> <span class="n">mapped_params</span><span class="p">[</span><span class="s1">&#39;bias_mant&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;bias_exp_inh&#39;</span><span class="p">:</span> <span class="n">mapped_params</span><span class="p">[</span><span class="s1">&#39;bias_exp&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;weights&#39;</span><span class="p">:</span> <span class="n">mapped_params</span><span class="p">[</span><span class="s1">&#39;weights&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;weight_exp&#39;</span><span class="p">:</span> <span class="n">mapped_params</span><span class="p">[</span><span class="s1">&#39;weight_exp&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;du_exc&#39;</span><span class="p">:</span> <span class="n">scaling_funct_dudv</span><span class="p">(</span><span class="n">lif_params_critical</span><span class="p">[</span><span class="s1">&#39;du_exc&#39;</span><span class="p">]),</span>
                             <span class="s1">&#39;dv_exc&#39;</span><span class="p">:</span> <span class="n">scaling_funct_dudv</span><span class="p">(</span><span class="n">lif_params_critical</span><span class="p">[</span><span class="s1">&#39;dv_exc&#39;</span><span class="p">]),</span>
                             <span class="s1">&#39;du_inh&#39;</span><span class="p">:</span> <span class="n">scaling_funct_dudv</span><span class="p">(</span><span class="n">lif_params_critical</span><span class="p">[</span><span class="s1">&#39;du_inh&#39;</span><span class="p">]),</span>
                             <span class="s1">&#39;dv_inh&#39;</span><span class="p">:</span> <span class="n">scaling_funct_dudv</span><span class="p">(</span><span class="n">lif_params_critical</span><span class="p">[</span><span class="s1">&#39;dv_inh&#39;</span><span class="p">])}</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Execution-of-bit-accurate-model">
<h2>Execution of bit accurate model<a class="headerlink" href="#Execution-of-bit-accurate-model" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import bit accurate ProcessModels.</span>
<span class="kn">from</span> <span class="nn">lava.proc.dense.models</span> <span class="kn">import</span> <span class="n">PyDenseModelBitAcc</span>
<span class="kn">from</span> <span class="nn">lava.proc.lif.models</span> <span class="kn">import</span> <span class="n">PyLifModelBitAcc</span>

<span class="c1"># Configurations for execution.</span>
<span class="n">num_steps</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">run_cond</span> <span class="o">=</span> <span class="n">RunSteps</span><span class="p">(</span><span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">)</span>

<span class="c1"># Define custom Run Config for execution of bit accurate models.</span>
<span class="k">class</span> <span class="nc">CustomRunConfigFixed</span><span class="p">(</span><span class="n">Loihi1SimCfg</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proc</span><span class="p">,</span> <span class="n">proc_models</span><span class="p">):</span>
        <span class="c1"># Customize run config to always use float model for io.sink.RingBuffer.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">proc</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">sink</span><span class="o">.</span><span class="n">RingBuffer</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">io</span><span class="o">.</span><span class="n">sink</span><span class="o">.</span><span class="n">PyReceiveModelFloat</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">proc</span><span class="p">,</span> <span class="n">LIF</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">PyLifModelBitAcc</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">proc</span><span class="p">,</span> <span class="n">Dense</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">PyDenseModelBitAcc</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">proc</span><span class="p">,</span> <span class="n">proc_models</span><span class="p">)</span>

<span class="n">rcfg</span> <span class="o">=</span> <span class="n">CustomRunConfigFixed</span><span class="p">(</span><span class="n">select_tag</span><span class="o">=</span><span class="s1">&#39;lif_neurons&#39;</span><span class="p">,</span> <span class="n">select_sub_proc_model</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">lif_network_critical_fixed</span> <span class="o">=</span> <span class="n">EINetwork</span><span class="p">(</span><span class="o">**</span><span class="n">lif_params_critical_fixed</span><span class="p">)</span>
<span class="n">outport_plug</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">sink</span><span class="o">.</span><span class="n">RingBuffer</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="n">num_steps</span><span class="p">)</span>

<span class="n">lif_network_critical_fixed</span><span class="o">.</span><span class="n">outport</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">outport_plug</span><span class="o">.</span><span class="n">a_in</span><span class="p">)</span>

<span class="n">lif_network_critical_fixed</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">condition</span><span class="o">=</span><span class="n">run_cond</span><span class="p">,</span> <span class="n">run_cfg</span><span class="o">=</span><span class="n">rcfg</span><span class="p">)</span>

<span class="c1"># Fetching spiking activity.</span>
<span class="n">spks_critical_fixed</span> <span class="o">=</span> <span class="n">outport_plug</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

<span class="n">lif_network_critical_fixed</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">raster_plot</span><span class="p">(</span><span class="n">spikes</span><span class="o">=</span><span class="n">spks_critical</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">raster_plot</span><span class="p">(</span><span class="n">spikes</span><span class="o">=</span><span class="n">spks_critical_fixed</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_75_0.png" src="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_75_0.png" />
</div>
</div>
<p>Comparing the spike times after the parameter conversion, we find that after the first initial time steps, the spike times start diverging, even though certain structural similarities remain. This, however, is expected: Since the systems is in a chaotic state, slight differences in the variables lead to a completely different output after some time steps. This is generally the behavior in spiking neural network. <strong>But</strong> the network stays in a <em>very similar dynamical state</em> with <em>similar
activity</em>, as can be seen when examining the overall behavior of the rate as well as auto-covariance function.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">window_size</span><span class="p">)</span>
<span class="n">binned_sps_critical_fixed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span>
    <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">spks_critical_fixed</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">window</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">)])[:,:</span><span class="o">-</span><span class="n">window_size</span> <span class="o">+</span><span class="mi">1</span><span class="p">]</span>
<span class="n">lags</span><span class="p">,</span> <span class="n">ac_fct_lif_critical_fixed</span> <span class="o">=</span> <span class="n">auto_cov_fct</span><span class="p">(</span><span class="n">acts</span><span class="o">=</span><span class="n">binned_sps_critical_fixed</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">offset</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">timesteps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="n">offset</span><span class="p">:</span> <span class="o">-</span><span class="n">offset</span><span class="p">]</span>

<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mean rate of floating-point LIF network&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timesteps</span><span class="p">,</span>
         <span class="p">(</span><span class="n">binned_sps_critical</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">binned_sps_critical</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">offset</span><span class="p">:</span> <span class="o">-</span><span class="n">offset</span><span class="p">])</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mean rate&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time Step&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mean rate of fixed-point LIF network&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timesteps</span><span class="p">,</span>
         <span class="p">(</span><span class="n">binned_sps_critical_fixed</span>
          <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">binned_sps_critical_fixed</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">offset</span><span class="p">:</span> <span class="o">-</span><span class="n">offset</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time Step&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_78_0.png" src="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_78_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting the auto-correlation function.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Covariance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="n">ac_fct_lif_critical_fixed</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bit accurate model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="n">ac_fct_lif_critical</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Floating point model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_79_0.png" src="../../../_images/lava_notebooks_end_to_end_tutorial02_excitatory_inhibitory_network_79_0.png" />
</div>
</div>
</section>
<section id="Follow-the-links-below-for-deep-dive-tutorials-on-the-concepts-in-this-tutorial:">
<h2>Follow the links below for deep-dive tutorials on the concepts in this tutorial:<a class="headerlink" href="#Follow-the-links-below-for-deep-dive-tutorials-on-the-concepts-in-this-tutorial:" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../in_depth/tutorial02_processes.html"><span class="doc">Processes</span></a></p></li>
<li><p><a class="reference internal" href="../in_depth/tutorial03_process_models.html"><span class="doc">ProcessModel</span></a></p></li>
<li><p><a class="reference internal" href="../in_depth/tutorial05_connect_processes.html"><span class="doc">Connections</span></a></p></li>
<li><p><a class="reference internal" href="../in_depth/tutorial04_execution.html"><span class="doc">Execution</span></a></p></li>
<li><p><a class="reference internal" href="../in_depth/tutorial06_hierarchical_processes.html"><span class="doc">SubProcessModels</span></a> or <a class="reference internal" href="../in_depth/tutorial06_hierarchical_processes.html"><span class="doc">Hierarchical Processes</span></a></p></li>
</ul>
<p>If you want to find out more about Lava, have a look at the <a class="reference external" href="https://lava-nc.org/">Lava documentation</a> or dive into the <a class="reference external" href="https://github.com/lava-nc/lava/">source code</a>.</p>
<p>To receive regular updates on the latest developments and releases of the Lava Software Framework please subscribe to the <a class="reference external" href="http://eepurl.com/hJCyhb">INRC newsletter</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial01_mnist_digit_classification.html" class="btn btn-neutral float-left" title="MNIST Digit Classification with Lava" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../in_depth/tutorial08_stdp.html" class="btn btn-neutral float-right" title="Spike-timing Dependent Plasticity (STDP)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Intel Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>