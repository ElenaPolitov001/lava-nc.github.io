<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Three Factor Learning with Lava &mdash; Lava  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Algorithms and Application Libraries" href="../../../../algorithms.html" />
    <link rel="prev" title="Custom Learning Rules" href="../tutorial09_custom_learning_rules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            Lava
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../lava_architecture_overview.html">Lava Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../lava_architecture_overview.html#key-attributes">Key attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../lava_architecture_overview.html#why-do-we-need-lava">Why do we need Lava?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../lava_architecture_overview.html#lava-s-foundational-concepts">Lava’s foundational concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../lava_architecture_overview.html#processes">1. Processes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../lava_architecture_overview.html#behavioral-implementations-via-processmodels">2. Behavioral implementations via ProcessModels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../lava_architecture_overview.html#composability-and-connectivity">3. Composability and connectivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../lava_architecture_overview.html#cross-platform-execution">4. Cross-platform execution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../lava_architecture_overview.html#lava-software-stack">Lava software stack</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../getting_started_with_lava.html">Getting Started with Lava</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../tutorial01_installing_lava.html">Installing Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial01_installing_lava.html#1.-System-Requirements">1. System Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial01_installing_lava.html#2.-Getting-Started">2. Getting Started</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorial01_installing_lava.html#2.1-Cloning-Lava-and-Running-from-Source">2.1 Cloning Lava and Running from Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorial01_installing_lava.html#2.2-[Alternative]-Installing-Lava-from-Binaries">2.2 [Alternative] Installing Lava from Binaries</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial01_installing_lava.html#3.-Running-Lava-on-Intel-Loihi">3. Running Lava on Intel Loihi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial01_installing_lava.html#4.-Lava-Developer-Guide">4. Lava Developer Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial01_installing_lava.html#5.-Tutorials">5. Tutorials</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial01_installing_lava.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../end_to_end/tutorial00_tour_through_lava.html">Walk through Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial00_tour_through_lava.html#1.-Usage-of-the-Process-Library">1. Usage of the Process Library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../end_to_end/tutorial00_tour_through_lava.html#Processes">Processes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../end_to_end/tutorial00_tour_through_lava.html#Ports-and-connections">Ports and connections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../end_to_end/tutorial00_tour_through_lava.html#Variables">Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../end_to_end/tutorial00_tour_through_lava.html#Record-internal-Vars-over-time">Record internal Vars over time</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../end_to_end/tutorial00_tour_through_lava.html#Execution">Execution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../end_to_end/tutorial00_tour_through_lava.html#Retrieve-recorded-data">Retrieve recorded data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../end_to_end/tutorial00_tour_through_lava.html#Summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../end_to_end/tutorial00_tour_through_lava.html#Learn-more-about">Learn more about</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial00_tour_through_lava.html#2.-Create-a-custom-Process">2. Create a custom Process</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../end_to_end/tutorial00_tour_through_lava.html#Create-a-new-ProcessModel">Create a new ProcessModel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../end_to_end/tutorial00_tour_through_lava.html#Use-the-custom-SpikeGenerator">Use the custom SpikeGenerator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../end_to_end/tutorial00_tour_through_lava.html#Execute-and-plot">Execute and plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../end_to_end/tutorial00_tour_through_lava.html#id1">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../end_to_end/tutorial00_tour_through_lava.html#id2">Learn more about</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../end_to_end/tutorial00_tour_through_lava.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial02_processes.html">Processes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial02_processes.html#Recommended-tutorials-before-starting:">Recommended tutorials before starting:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial02_processes.html#What-is-a-Process?">What is a <em>Process</em>?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial02_processes.html#How-to-build-a-Process?">How to build a <em>Process</em>?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorial02_processes.html#Overall-architecture">Overall architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorial02_processes.html#AbstractProcess:-Defining-Vars,-Ports,-and-the-API"><em>AbstractProcess</em>: Defining <em>Vars</em>, <em>Ports</em>, and the API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorial02_processes.html#ProcessModel:-Defining-the-behavior-of-a-Process"><em>ProcessModel</em>: Defining the behavior of a <em>Process</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorial02_processes.html#Instantiating-the-Process">Instantiating the <em>Process</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial02_processes.html#Interacting-with-Processes">Interacting with <em>Processes</em></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorial02_processes.html#Accessing-Vars">Accessing <em>Vars</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorial02_processes.html#Using-custom-APIs">Using custom APIs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorial02_processes.html#Executing-a-Process">Executing a <em>Process</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorial02_processes.html#Update-Vars">Update <em>Vars</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial02_processes.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial03_process_models.html"><em>ProcessModels</em></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial03_process_models.html#Recommended-tutorials-before-starting:">Recommended tutorials before starting:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial03_process_models.html#Create-a-LIF-Process">Create a LIF <em>Process</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial03_process_models.html#Create-a-Python-LeafProcessModel-that-implements-the-LIF-Process">Create a Python <em>LeafProcessModel</em> that implements the LIF <em>Process</em></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorial03_process_models.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorial03_process_models.html#Defining-a-PyLifModel-for-LIF">Defining a <em>PyLifModel</em> for LIF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorial03_process_models.html#Compile-and-run-PyLifModel">Compile and run <em>PyLifModel</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial03_process_models.html#Selecting-1-ProcessModel:-More-on-LeafProcessModel-attributes-and-relations">Selecting 1 <em>ProcessModel</em>: More on <em>LeafProcessModel</em> attributes and relations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial03_process_models.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial04_execution.html">Execution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial04_execution.html#Recommended-tutorials-before-starting:">Recommended tutorials before starting:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial04_execution.html#Configuring-and-starting-execution">Configuring and starting execution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorial04_execution.html#Run-conditions">Run conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorial04_execution.html#Run-configurations">Run configurations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial04_execution.html#Running-multiple-Processes">Running multiple <em>Processes</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial04_execution.html#Pausing,-resuming,-and-stopping-execution">Pausing, resuming, and stopping execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial04_execution.html#Manual-compilation-and-execution">Manual compilation and execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial04_execution.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial05_connect_processes.html">Connect processes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial05_connect_processes.html#Recommended-tutorials-before-starting:">Recommended tutorials before starting:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial05_connect_processes.html#Building-a-network-of-Processes">Building a network of <em>Processes</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial05_connect_processes.html#Create-a-connection">Create a connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial05_connect_processes.html#Possible-connections">Possible connections</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorial05_connect_processes.html#There-are-some-things-to-consider-though:">There are some things to consider though:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial05_connect_processes.html#Connect-multiple-InPorts-from-a-single-OutPort">Connect multiple <em>InPorts</em> from a single <em>OutPort</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial05_connect_processes.html#Connecting-multiple-InPorts-to-a-single-OutPort">Connecting multiple <em>InPorts</em> to a single <em>OutPort</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial05_connect_processes.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial06_hierarchical_processes.html">Hierarchical <em>Processes</em> and <em>SubProcessModels</em></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial06_hierarchical_processes.html#Recommended-tutorials-before-starting:">Recommended tutorials before starting:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial06_hierarchical_processes.html#Create-LIF-and-Dense-Processes-and-ProcessModels">Create LIF and Dense <em>Processes</em> and <em>ProcessModels</em></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorial06_hierarchical_processes.html#Create-a-Dense-connection-Process">Create a Dense connection <em>Process</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorial06_hierarchical_processes.html#Create-a-Python-Dense-connection-ProcessModel-implementing-the-Loihi-Sync-Protocol-and-requiring-a-CPU-compute-resource">Create a Python Dense connection <em>ProcessModel</em> implementing the Loihi Sync Protocol and requiring a CPU compute resource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorial06_hierarchical_processes.html#Create-a-LIF-neuron-Process">Create a LIF neuron <em>Process</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorial06_hierarchical_processes.html#Create-a-Python-LIF-neuron-ProcessModel-implementing-the-Loihi-Sync-Protocol-and-requiring-a-CPU-compute-resource">Create a Python LIF neuron <em>ProcessModel</em> implementing the Loihi Sync Protocol and requiring a CPU compute resource</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial06_hierarchical_processes.html#Create-a-DenseLayer-Hierarchical-Process-that-encompasses-Dense-and-LIF-Process-behavior">Create a DenseLayer Hierarchical <em>Process</em> that encompasses Dense and LIF <em>Process</em> behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial06_hierarchical_processes.html#Create-a-SubProcessModel-that-implements-the-DenseLayer-Process-using-Dense-and-LIF-child-Processes">Create a <em>SubProcessModel</em> that implements the DenseLayer <em>Process</em> using Dense and LIF child <em>Processes</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial06_hierarchical_processes.html#Run-the-DenseLayer-Process">Run the DenseLayer <em>Process</em></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorial06_hierarchical_processes.html#Run-Connected-DenseLayer-Processes">Run Connected DenseLayer <em>Processes</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial06_hierarchical_processes.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial07_remote_memory_access.html">Remote Memory Access</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial07_remote_memory_access.html#Recommended-tutorials-before-starting:">Recommended tutorials before starting:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial07_remote_memory_access.html#Create-a-minimal-Process-and-ProcessModel-with-a-RefPort">Create a minimal <em>Process</em> and <em>ProcessModel</em> with a <em>RefPort</em></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorial07_remote_memory_access.html#Create-a-Python-Process-Model-implementing-the-Loihi-Sync-Protocol-and-requiring-a-CPU-compute-resource">Create a Python Process Model implementing the Loihi Sync Protocol and requiring a CPU compute resource</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial07_remote_memory_access.html#Run-the-Processes">Run the <em>Processes</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial07_remote_memory_access.html#Implicit-and-explicit-VarPorts">Implicit and explicit VarPorts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial07_remote_memory_access.html#Options-to-connect-RefPorts-and-VarPorts">Options to connect RefPorts and VarPorts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial07_remote_memory_access.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../end_to_end/tutorial01_mnist_digit_classification.html">MNIST Digit Classification with Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial01_mnist_digit_classification.html#This-tutorial-assumes-that-you:">This tutorial assumes that you:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial01_mnist_digit_classification.html#This-tutorial-gives-a-bird’s-eye-view-of">This tutorial gives a bird’s-eye view of</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial01_mnist_digit_classification.html#Our-MNIST-Classifier">Our MNIST Classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial01_mnist_digit_classification.html#General-Imports">General Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial01_mnist_digit_classification.html#Lava-Processes">Lava Processes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial01_mnist_digit_classification.html#ProcessModels-for-Python-execution">ProcessModels for Python execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial01_mnist_digit_classification.html#Connecting-Processes">Connecting Processes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial01_mnist_digit_classification.html#Execution-and-results">Execution and results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../end_to_end/tutorial01_mnist_digit_classification.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial01_mnist_digit_classification.html#Follow-the-links-below-for-deep-dive-tutorials-on-the-concepts-in-this-tutorial:">Follow the links below for deep-dive tutorials on the concepts in this tutorial:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html">Excitatory-Inhibitory Neural Network with Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#This-tutorial-assumes-that-you:">This tutorial assumes that you:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#This-tutorial-gives-a-high-level-view-of">This tutorial gives a high level view of</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#E/I-Network">E/I Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#General-imports">General imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#E/I-Network-Lava-Process">E/I Network Lava Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#ProcessModels-for-Python-execution">ProcessModels for Python execution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#Rate-neurons">Rate neurons</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#Defining-the-parameters-for-the-network">Defining the parameters for the network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#Execution-and-Results">Execution and Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#Visualizing-the-activity">Visualizing the activity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#Further-analysis">Further analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#Controlling-the-network">Controlling the network</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#LIF-Neurons">LIF Neurons</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#id7">Execution and Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#id8">Visualizing the activity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#id9">Controlling the network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#DIfferent-recurrent-activation-regimes">DIfferent recurrent activation regimes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#Running-a-ProcessModel-bit-accurate-with-Loihi">Running a ProcessModel bit-accurate with Loihi</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#Execution-of-bit-accurate-model">Execution of bit accurate model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../end_to_end/tutorial02_excitatory_inhibitory_network.html#Follow-the-links-below-for-deep-dive-tutorials-on-the-concepts-in-this-tutorial:">Follow the links below for deep-dive tutorials on the concepts in this tutorial:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial08_stdp.html">Spike-timing Dependent Plasticity (STDP)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial08_stdp.html#This-tutorial-assumes-that-you:">This tutorial assumes that you:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorial08_stdp.html#STDP-from-Lavas-Process-Library">STDP from Lavas Process Library</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial08_stdp.html#The-plastic-connection-Process">The plastic connection Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial08_stdp.html#Plot-spike-trains">Plot spike trains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial08_stdp.html#Plot-traces">Plot traces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial08_stdp.html#Plot-STDP-learning-window-and-weight-changes">Plot STDP learning window and weight changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial09_custom_learning_rules.html">Custom Learning Rules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial09_custom_learning_rules.html#This-tutorial-assumes-that-you:">This tutorial assumes that you:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorial09_custom_learning_rules.html#2.-Loihi’s-learning-engine">2. Loihi’s learning engine</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial09_custom_learning_rules.html#Epoch-based-updates">Epoch-based updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial09_custom_learning_rules.html#Synaptic-variables">Synaptic variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial09_custom_learning_rules.html#Learning-rules">Learning rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial09_custom_learning_rules.html#Dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial09_custom_learning_rules.html#Scaling-factors">Scaling factors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial09_custom_learning_rules.html#Factors">Factors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial09_custom_learning_rules.html#Traces">Traces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial09_custom_learning_rules.html#Example:-Basic-pair-based-STDP">Example: Basic pair-based STDP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial09_custom_learning_rules.html#Instantiating-LearningRule">Instantiating LearningRule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial09_custom_learning_rules.html#The-plastic-connection-Process">The plastic connection Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial09_custom_learning_rules.html#Plot-spike-trains">Plot spike trains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial09_custom_learning_rules.html#Plot-traces">Plot traces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial09_custom_learning_rules.html#Plot-STDP-learning-window-and-weight-changes">Plot STDP learning window and weight changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial09_custom_learning_rules.html#Follow-the-links-below-for-deep-dive-tutorials-on-the-concepts-in-this-tutorial:">Follow the links below for deep-dive tutorials on the concepts in this tutorial:</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Three Factor Learning with Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#This-tutorial-assumes-that-you:">This tutorial assumes that you:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Defining-three-factor-learning-rule-interfaces-in-Lava">Defining three-factor learning rule interfaces in Lava</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Reward-modulated-Spike-Timing-Dependent-Plasticity-(R-STDP)-learning-rule">Reward-modulated Spike-Timing Dependent Plasticity (R-STDP) learning rule</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Defining-a-simple-learning-network-with-localized-reward-signals">Defining a simple learning network with localized reward signals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Initialize-network-parameters-and-weights">Initialize network parameters and weights</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Generate-binary-input-and-graded-reward-spikes">Generate binary input and graded reward spikes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Initialize-Network-Processes">Initialize Network Processes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Connect-Network-Processes">Connect Network Processes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Create-monitors-to-observe-the-weight-and-trace-dynamics-during-learning">Create monitors to observe the weight and trace dynamics during learning</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Run-the-network">Run the network</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Visualize-the-learning-results">Visualize the learning results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Plot-eligibility-trace-dynamics">Plot eligibility trace dynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Plot-reward-trace-dynamics">Plot reward trace dynamics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Advanced-Topic:-Implementing-custom-learning-rule-interfaces">Advanced Topic: Implementing custom learning rule interfaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Follow-the-links-below-for-deep-dive-tutorials-on-the-concepts-in-this-tutorial:">Follow the links below for deep-dive tutorials on the concepts in this tutorial:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../algorithms.html">Algorithms and Application Libraries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../dl.html">Deep Learning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../dl.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../dl.html#lava-dl-workflow">Lava-DL Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../dl.html#getting-started">Getting Started</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../dl.html#slayer-2-0">SLAYER 2.0</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../dl.html#example-code">Example Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../dl.html#bootstrap">Bootstrap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../dl.html#example-code-1">Example Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../dl.html#network-exchange-netx-library">Network Exchange (NetX) Library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../dl.html#example-code-2">Example Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../dl.html#detailed-description">Detailed Description</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/slayer/slayer.html">Lava-DL SLAYER</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/bootstrap/bootstrap.html">Lava-DL Bootstrap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/netx/netx.html">Lava-DL NetX</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../dnf.html">Dynamic Neural Fields</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../dnf.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../dnf.html#what-is-lava-dnf">What is lava-dnf?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../dnf.html#key-features">Key features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../dnf.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../optimization.html">Neuromorphic Constrained Optimization Library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../optimization.html#about-the-project">About the Project</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../optimization.html#taxonomy-of-optimization-problems">Taxonomy of Optimization Problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../optimization.html#optimizationsolver-and-optimizationproblem-classes">OptimizationSolver and OptimizationProblem Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../optimization.html#tutorials">Tutorials</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../optimization.html#quadratic-programming">Quadratic Programming</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../optimization.html#quadratic-uncosntrained-binary-optimization">Quadratic Uncosntrained Binary Optimization</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../optimization.html#examples">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../optimization.html#solving-qp-problems">Solving QP problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../optimization.html#solving-qubo">Solving QUBO</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../optimization.html#getting-started">Getting Started</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../optimization.html#requirements">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../optimization.html#installation">Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../optimization.html#alternative-installing-lava-via-conda">[Alternative] Installing Lava via Conda</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_guide.html">Developer Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../developer_guide.html#lava-s-origins">Lava’s Origins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../developer_guide.html#contact-information">Contact Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../developer_guide.html#development-roadmap">Development Roadmap</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../developer_guide.html#initial-release">Initial Release</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../developer_guide.html#how-to-contribute-to-lava">How to contribute to Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../developer_guide.html#open-an-issue">Open an Issue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../developer_guide.html#pull-request-checklist">Pull Request Checklist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../developer_guide.html#open-a-pull-request">Open a Pull Request</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../developer_guide.html#coding-conventions">Coding Conventions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../developer_guide.html#code-requirements">Code Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../developer_guide.html#guidelines">Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../developer_guide.html#docstring-format">Docstring Format</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../developer_guide.html#contributors">Contributors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../developer_guide.html#contributor">Contributor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../developer_guide.html#committer">Committer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../developer_guide.html#list-of-lava-nc-lava-project-committers">List of lava-nc/lava Project Committers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../developer_guide.html#list-of-lava-nc-lava-dnf-project-committers">List of lava-nc/lava-dnf Project Committers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../developer_guide.html#list-of-lava-nc-lava-optimization-project-committers">List of lava-nc/lava-optimization Project Committers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../developer_guide.html#list-of-lava-nc-lava-dl-project-committers">List of lava-nc/lava-dl Project Committers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../developer_guide.html#committer-promotion">Committer Promotion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../developer_guide.html#repository-structure">Repository Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../developer_guide.html#id17">lava-nc/lava</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../developer_guide.html#lava-nc-lava-dnf">lava-nc/lava-dnf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../developer_guide.html#lava-nc-lava-dl">lava-nc/lava-dl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../developer_guide.html#lava-nc-lava-optimization">lava-nc/lava-optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../developer_guide.html#lava-nc-lava-docs">lava-nc/lava-docs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../developer_guide.html#code-of-conduct">Code of Conduct</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../developer_guide.html#licenses">Licenses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../lava_api_documentation.html">Lava API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../lava.html">Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../lava.magma.html">Magma</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.magma.compiler.html">lava.magma.compiler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.magma.core.html">lava.magma.core</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.magma.runtime.html">lava.magma.runtime</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava.proc.html">Lava process library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.proc.conv.html">lava.proc.conv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.proc.dense.html">lava.proc.dense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.proc.io.html">lava.proc.io</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.proc.learning_rules.html">lava.proc.learning_rules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.proc.lif.html">lava.proc.lif</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.proc.monitor.html">lava.proc.monitor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.proc.receiver.html">lava.proc.receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.proc.sdn.html">lava.proc.sdn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.proc.spiker.html">lava.proc.spiker</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava.utils.html">Lava Utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.utils.dataloader.html">lava.utils.dataloader</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.utils.html#lava-utils-float2fixed">lava.utils.float2fixed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.utils.html#lava-utils-profiler">lava.utils.profiler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.utils.html#lava-utils-system">lava.utils.system</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.utils.html#lava-utils-validator">lava.utils.validator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.utils.html#lava-utils-visualizer">lava.utils.visualizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava.utils.html#lava-utils-weightutils">lava.utils.weightutils</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../lava-lib-dl/index.html">Lava - Deep Learning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../lava-lib-dl/slayer/index.html">SLAYER</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/slayer/neuron/modules.html">Neuron</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/slayer/synapse/modules.html">Synapse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/slayer/spike/modules.html">Spike</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/slayer/axon/modules.html">Axon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/slayer/dendrite/modules.html">Dendrite</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/slayer/block/modules.html">Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/slayer/loss.html">Loss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/slayer/classifier.html">Classifier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/slayer/io.html">Input/Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/slayer/auto.html">Auto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/slayer/utils/modules.html">Utilities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../lava-lib-dl/slayer/index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../lava-lib-dl/bootstrap/index.html">Bootstrap (ANN-SNN training)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/bootstrap/block/modules.html">Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/bootstrap/ann_sampler.html">ANN Statistics Sampler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/bootstrap/routine.html">Routine</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../lava-lib-dl/bootstrap/index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../lava-lib-dl/netx/index.html">Lava-DL NetX</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/netx/blocks/modules.html">Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/netx/hdf5.html">HDF5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dl/netx/utils.html">Utils</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../lava-lib-dl/netx/index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.html">Lava - Dynamic Neural Fields</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.connect.html">lava.lib.dnf.connect</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.connect.html#lava-lib-dnf-connect-connect">lava.lib.dnf.connect.connect</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.connect.html#lava-lib-dnf-connect-exceptions">lava.lib.dnf.connect.exceptions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.kernels.html">lava.lib.dnf.kernels</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.kernels.html#lava-lib-dnf-kernels-kernels">lava.lib.dnf.kernels.kernels</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.operations.html">lava.lib.dnf.operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.operations.html#lava-lib-dnf-operations-enums">lava.lib.dnf.operations.enums</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.operations.html#lava-lib-dnf-operations-exceptions">lava.lib.dnf.operations.exceptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.operations.html#lava-lib-dnf-operations-operations">lava.lib.dnf.operations.operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.operations.html#lava-lib-dnf-operations-shape-handlers">lava.lib.dnf.operations.shape_handlers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.inputs.html">lava.lib.dnf.inputs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.inputs.gauss_pattern.html">lava.lib.dnf.inputs.gauss_pattern</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.inputs.rate_code_spike_gen.html">lava.lib.dnf.inputs.rate_code_spike_gen</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.utils.html">lava.lib.dnf.utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.utils.html#lava-lib-dnf-utils-convenience">lava.lib.dnf.utils.convenience</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.utils.html#lava-lib-dnf-utils-math">lava.lib.dnf.utils.math</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.utils.html#lava-lib-dnf-utils-plotting">lava.lib.dnf.utils.plotting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-dnf/lava.lib.dnf.utils.html#lava-lib-dnf-utils-validation">lava.lib.dnf.utils.validation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../lava-lib-optimization/lava.lib.optimization.html">Lava - Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../lava-lib-optimization/lava.lib.optimization.problems.html">lava.lib.optimization.problems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-optimization/lava.lib.optimization.problems.bayesian.html">lava.lib.optimization.problems.bayesian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-optimization/lava.lib.optimization.problems.html#lava-lib-optimization-problems-coefficients">lava.lib.optimization.problems.coefficients</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-optimization/lava.lib.optimization.problems.html#lava-lib-optimization-problems-constraints">lava.lib.optimization.problems.constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-optimization/lava.lib.optimization.problems.html#lava-lib-optimization-problems-cost">lava.lib.optimization.problems.cost</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-optimization/lava.lib.optimization.problems.html#lava-lib-optimization-problems-problems">lava.lib.optimization.problems.problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-optimization/lava.lib.optimization.problems.html#lava-lib-optimization-problems-variables">lava.lib.optimization.problems.variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../lava-lib-optimization/lava.lib.optimization.solvers.html">lava.lib.optimization.solvers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-optimization/lava.lib.optimization.solvers.bayesian.html">lava.lib.optimization.solvers.bayesian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-optimization/lava.lib.optimization.solvers.generic.html">lava.lib.optimization.solvers.generic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-optimization/lava.lib.optimization.solvers.qp.html">lava.lib.optimization.solvers.qp</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../lava-lib-optimization/lava.lib.optimization.utils.html">lava.lib.optimization.utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-optimization/lava.lib.optimization.utils.generators.html">lava.lib.optimization.utils.generators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../lava-lib-optimization/lava.lib.optimization.utils.html#lava-lib-optimization-utils-solver-tuner">lava.lib.optimization.utils.solver_tuner</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Lava</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../getting_started_with_lava.html">Getting Started with Lava</a></li>
      <li class="breadcrumb-item active">Three Factor Learning with Lava</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/lava/notebooks/in_depth/three_factor_learning/tutorial01_Reward_Modulated_STDP.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<p><em>Copyright (C) 2022 Intel Corporation</em> <em>SPDX-License-Identifier: BSD-3-Clause</em> <em>See: https://spdx.org/licenses/</em></p>
<hr class="docutils" />
<section id="Three-Factor-Learning-with-Lava">
<h1>Three Factor Learning with Lava<a class="headerlink" href="#Three-Factor-Learning-with-Lava" title="Permalink to this heading"></a></h1>
<p><strong>Motivation</strong>: This tutorial demonstrates how Lava users can define and implement three factor learning rules using a software model of Loihi’s learning engine.</p>
<section id="This-tutorial-assumes-that-you:">
<h2>This tutorial assumes that you:<a class="headerlink" href="#This-tutorial-assumes-that-you:" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>have the <a class="reference internal" href="../tutorial01_installing_lava.html"><span class="doc">Lava framework installed</span></a></p></li>
<li><p>are familiar with <a class="reference internal" href="../tutorial02_processes.html"><span class="doc">Process interfaces in Lava</span></a></p></li>
<li><p>are familiar with <a class="reference external" href="../../in_depth/tutorial02_process_models.ipynb">ProcessModel implementations in Lava</a></p></li>
<li><p>are familiar with how to <a class="reference internal" href="../tutorial05_connect_processes.html"><span class="doc">connect Lava Processes</span></a></p></li>
<li><p>are familiar with how to <a class="reference internal" href="../tutorial08_stdp.html"><span class="doc">implement a custom learning rule</span></a></p></li>
</ul>
<p>This tutorial demonstrates how the Lava Learning API can be used for simulation of three-factor learning rules. We first instantiate a high-level interface for the reward-modulated spike-timing dependent plasticity (R-STDP) rule defined in the Lava Process Library. We then execute a simulation of a spiking neural network in which localized, graded reward factors are mapped to specific plastic synapses, demonstrating Lava support for this new Loihi 2 learning capability. Finally, we demonstrate
how users can define their own custom, three-factor learning rule interfaces and implement custom post-synaptic trace dynamics in simulation, as supported on Loihi 2 through microcoded post-synaptic neuron instructions. With these capabilities, Lava now provides support for many of the latest neuro-inspired learning algorithms under study!</p>
<section id="Defining-three-factor-learning-rule-interfaces-in-Lava">
<h3>Defining three-factor learning rule interfaces in Lava<a class="headerlink" href="#Defining-three-factor-learning-rule-interfaces-in-Lava" title="Permalink to this heading"></a></h3>
<p>The Lava learning API can be used to represent a wide range of local learning rules that obey Loihi’s sum-of-product learning rule form. Users can define define custom, reusable learning rule interfaces atop the full Lava learning engine equation parser. Here, we import a reusable interface for reward-modulated spike-timing dependent plasticity (R-STDP) that is now part of the standard Lava Process Library.</p>
</section>
</section>
<section id="Reward-modulated-Spike-Timing-Dependent-Plasticity-(R-STDP)-learning-rule">
<h2>Reward-modulated Spike-Timing Dependent Plasticity (R-STDP) learning rule<a class="headerlink" href="#Reward-modulated-Spike-Timing-Dependent-Plasticity-(R-STDP)-learning-rule" title="Permalink to this heading"></a></h2>
<p>Reward-modulated STDP is a three-factor learning rule that can explain how behaviourly relevant adaptive changes in a complex network of spiking neurons could be achieved in a self-organizing manner through local synaptic plasticity. A third, reward signal modulates the outcome of the pairwise two-factor learning rule STDP. The implementation of the R-STDP described below is adapted from <a class="reference external" href="https://www.frontiersin.org/articles/10.3389/fncir.2015.00085/full">Neuromodulated Spike-Timing-Dependent
Plasticity</a>.</p>
<p>Synaptic weights, <span class="math">W</span>, are modulated as a function of the eligibility trace <span class="math">E</span> and reward term <span class="math">R</span>:</p>
<div class="math">
<p><span class="math">\dot{W} = R \cdot E</span></p>
</div><p>The synaptic eligibility trace stores a temporary memory of the STDP outcome that persists through the epoch when a delayed reward signal is received. Defining the learning window of a traditional Hebbian STDP as <span class="math">STDP(pre, post)</span>, where “pre” represents the pre-synaptic activity of a synapse and “post” represents the state of the post-synaptic neuron, the synaptic eligibility trace dynamics have the form:</p>
<div class="math">
<p><span class="math">\dot{E} = - \frac{E}{\tau_e} + STDP(pre, post)</span></p>
</div><p>NOTE: Learning parameters are adapted from online implemention of <a class="reference external" href="http://www.scholarpedia.org/article/Spike-timing_dependent_plasticity">Spike-Timing Dependent Plasticity (STDP)</a> and can vary based on implementation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lava.proc.learning_rules.r_stdp_learning_rule</span> <span class="kn">import</span> <span class="n">RewardModulatedSTDP</span>

<span class="n">R_STDP</span> <span class="o">=</span> <span class="n">RewardModulatedSTDP</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                             <span class="n">A_plus</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                             <span class="n">A_minus</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span>
                             <span class="n">pre_trace_decay_tau</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                             <span class="n">post_trace_decay_tau</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                             <span class="n">pre_trace_kernel_magnitude</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
                             <span class="n">post_trace_kernel_magnitude</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
                             <span class="n">eligibility_trace_decay_tau</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                             <span class="n">t_epoch</span><span class="o">=</span><span class="mi">1</span>
                             <span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Defining-a-simple-learning-network-with-localized-reward-signals">
<h3>Defining a simple learning network with localized reward signals<a class="headerlink" href="#Defining-a-simple-learning-network-with-localized-reward-signals" title="Permalink to this heading"></a></h3>
<p>We can now define a simple spiking network in which connections are modified according to our R-STDP learning rule. The core of the learning network is comprised of one pre-synaptic leaky-integrate-and-fire (LIF) neuron and two post-synaptic LIF neurons, all of which are driven by binary spiking inputs. The pre- and post-synaptic neurons are connected via a LearningDense Process, which learns weights according to the R-STDP learning rule. The binary spiking inputs drive the pre- and post-
populations to affect the dynamics of the R-STDP eligibility trace.</p>
<p>The network’s post-synaptic population also receives localized, graded reward spikes. The post-synaptic neurons transform the graded reward spikes to localized reward traces, which act as targeted modulators to specific plastic synapses within the LearningDense process. This tutorials now includes a RSTDPLIF Process, used for post-synaptic neurons that can each compute up to two custom reward traces or “third factor” modulators.</p>
<p>The diagram below explains the structure of the spiking network used to demonstrate the learnable weights modified with the R-STDP learning rule.</p>
<p><img alt="R_STDP_structure" src="https://raw.githubusercontent.com/lava-nc/lava-docs/three_factor_learning/_static/images/tutorial_learning/r_stdp__tutorial_structure.svg" /></p>
<p>The simple spiking network shown above translates to a connected Lava process architecture as shown below.</p>
<p><img alt="R_STDP_architecture" src="https://raw.githubusercontent.com/lava-nc/lava-docs/three_factor_learning/_static/images/tutorial_learning/r_stdp_tutorial_architecture.svg" /></p>
<p><em>NOTE : Though the RSTDPLIF Process can currently only be executed on CPU backend, it is modeled from Loihi 2’s ability to compute custom post-traces in microcoded neuron instructions. Lava support for on-chip execution will be available soon!</em></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Set this tag to &quot;fixed_pt&quot; or &quot;floating_pt&quot; to choose the corresponding models.</span>
<span class="n">SELECT_TAG</span> <span class="o">=</span> <span class="s2">&quot;fixed_pt&quot;</span>

<span class="c1"># LIF parameters</span>
<span class="k">if</span> <span class="n">SELECT_TAG</span> <span class="o">==</span> <span class="s2">&quot;fixed_pt&quot;</span><span class="p">:</span>
    <span class="n">du</span> <span class="o">=</span> <span class="mi">4095</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="mi">4095</span>
<span class="k">elif</span> <span class="n">SELECT_TAG</span> <span class="o">==</span> <span class="s2">&quot;floating_pt&quot;</span><span class="p">:</span>
    <span class="n">du</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">vth</span> <span class="o">=</span> <span class="mi">240</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Initialize-network-parameters-and-weights">
<h2>Initialize network parameters and weights<a class="headerlink" href="#Initialize-network-parameters-and-weights" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pre-synaptic neuron parameters</span>
<span class="n">num_neurons_pre</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">shape_lif_pre</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_neurons_pre</span><span class="p">,</span> <span class="p">)</span>
<span class="n">shape_conn_pre</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_neurons_pre</span><span class="p">,</span> <span class="n">num_neurons_pre</span><span class="p">)</span>

<span class="c1"># SpikeIn -&gt; pre-synaptic LIF connection weight</span>
<span class="n">wgt_inp_pre</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">num_neurons_pre</span><span class="p">)</span> <span class="o">*</span> <span class="mi">250</span>


<span class="c1"># Post-synaptic neuron parameters</span>
<span class="n">num_neurons_post</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">shape_lif_post</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_neurons_post</span><span class="p">,</span> <span class="p">)</span>
<span class="n">shape_conn_post</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_neurons_post</span><span class="p">,</span> <span class="n">num_neurons_pre</span><span class="p">)</span>

<span class="c1"># SpikeIn -&gt; post-synaptic LIF connection weight</span>
<span class="n">wgt_inp_post</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">num_neurons_post</span><span class="p">)</span> <span class="o">*</span> <span class="mi">250</span>


<span class="c1"># Third-factor input weights</span>
<span class="c1"># Graded SpikeIn -&gt; post-synaptic LIF connection weight</span>
<span class="n">wgt_inp_reward</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">num_neurons_post</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>


<span class="c1"># pre-LIF -&gt; post-LIF connection initial weight (learning-enabled)</span>
<span class="c1"># Plastic synapse</span>
<span class="n">wgt_plast_conn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shape_conn_post</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Generate-binary-input-and-graded-reward-spikes">
<h2>Generate binary input and graded reward spikes<a class="headerlink" href="#Generate-binary-input-and-graded-reward-spikes" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">generate_post_spikes</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Number of simulation time steps</span>
<span class="n">num_steps</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">time</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Spike times</span>
<span class="n">spike_prob</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">]</span>

<span class="c1"># Create random spike rasters</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">156</span><span class="p">)</span>
<span class="n">spike_raster_pre</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_neurons_pre</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">spike_raster_pre</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_neurons_pre</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">spike_prob</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Create post spikes raster</span>
<span class="n">spike_raster_post</span> <span class="o">=</span> <span class="n">generate_post_spikes</span><span class="p">(</span><span class="n">spike_raster_pre</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">,</span> <span class="n">spike_prob</span><span class="p">)</span>

<span class="c1"># Create graded reward input spikes</span>
<span class="n">graded_reward_spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_neurons_post</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">))</span>
<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_steps</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">70</span><span class="p">):</span>
        <span class="n">graded_reward_spikes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">170</span><span class="p">):</span>
        <span class="n">graded_reward_spikes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</section>
<section id="Initialize-Network-Processes">
<h2>Initialize Network Processes<a class="headerlink" href="#Initialize-Network-Processes" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lava.proc.lif.process</span> <span class="kn">import</span> <span class="n">LIF</span>
<span class="kn">from</span> <span class="nn">lava.proc.io.source</span> <span class="kn">import</span> <span class="n">RingBuffer</span> <span class="k">as</span> <span class="n">SpikeIn</span>
<span class="kn">from</span> <span class="nn">lava.proc.dense.process</span> <span class="kn">import</span> <span class="n">LearningDense</span><span class="p">,</span> <span class="n">Dense</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">RSTDPLIF</span><span class="p">,</span> <span class="n">RSTDPLIFModelFloat</span><span class="p">,</span> <span class="n">RSTDPLIFBitAcc</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create input devices</span>
<span class="n">pattern_pre</span> <span class="o">=</span> <span class="n">SpikeIn</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">spike_raster_pre</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
<span class="n">pattern_post</span> <span class="o">=</span> <span class="n">SpikeIn</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">spike_raster_post</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>

<span class="c1"># Create graded reward input device</span>
<span class="n">reward_pattern_post</span> <span class="o">=</span> <span class="n">SpikeIn</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">graded_reward_spikes</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>

<span class="c1"># Create input connectivity</span>
<span class="n">conn_inp_pre</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">wgt_inp_pre</span><span class="p">)</span>
<span class="n">conn_inp_post</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">wgt_inp_post</span><span class="p">)</span>
<span class="n">conn_inp_reward</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">wgt_inp_reward</span><span class="p">,</span> <span class="n">num_message_bits</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Create pre-synaptic neurons</span>
<span class="n">lif_pre</span> <span class="o">=</span> <span class="n">LIF</span><span class="p">(</span><span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
              <span class="n">v</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
              <span class="n">du</span><span class="o">=</span><span class="n">du</span><span class="p">,</span>
              <span class="n">dv</span><span class="o">=</span><span class="n">du</span><span class="p">,</span>
              <span class="n">bias_mant</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
              <span class="n">bias_exp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
              <span class="n">vth</span><span class="o">=</span><span class="n">vth</span><span class="p">,</span>
              <span class="n">shape</span><span class="o">=</span><span class="n">shape_lif_pre</span><span class="p">,</span>
              <span class="n">name</span><span class="o">=</span><span class="s1">&#39;lif_pre&#39;</span><span class="p">)</span>

<span class="c1"># Create plastic connection</span>
<span class="n">plast_conn</span> <span class="o">=</span> <span class="n">LearningDense</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">wgt_plast_conn</span><span class="p">,</span>
                           <span class="n">learning_rule</span><span class="o">=</span><span class="n">R_STDP</span><span class="p">,</span>
                           <span class="n">name</span><span class="o">=</span><span class="s1">&#39;plastic_dense&#39;</span><span class="p">)</span>

<span class="c1"># Create post-synaptic neuron</span>
<span class="n">lif_post</span> <span class="o">=</span> <span class="n">RSTDPLIF</span><span class="p">(</span><span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">v</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">du</span><span class="o">=</span><span class="n">du</span><span class="p">,</span>
                    <span class="n">dv</span><span class="o">=</span><span class="n">du</span><span class="p">,</span>
                    <span class="n">bias_mant</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">bias_exp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">vth</span><span class="o">=</span><span class="n">vth</span><span class="p">,</span>
                    <span class="n">shape</span><span class="o">=</span><span class="n">shape_lif_post</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;lif_post&#39;</span><span class="p">,</span>
                    <span class="n">learning_rule</span><span class="o">=</span><span class="n">R_STDP</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Connect-Network-Processes">
<h3>Connect Network Processes<a class="headerlink" href="#Connect-Network-Processes" title="Permalink to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Connect network</span>
<span class="n">pattern_pre</span><span class="o">.</span><span class="n">s_out</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">conn_inp_pre</span><span class="o">.</span><span class="n">s_in</span><span class="p">)</span>
<span class="n">conn_inp_pre</span><span class="o">.</span><span class="n">a_out</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">lif_pre</span><span class="o">.</span><span class="n">a_in</span><span class="p">)</span>

<span class="n">pattern_post</span><span class="o">.</span><span class="n">s_out</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">conn_inp_post</span><span class="o">.</span><span class="n">s_in</span><span class="p">)</span>
<span class="n">conn_inp_post</span><span class="o">.</span><span class="n">a_out</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">lif_post</span><span class="o">.</span><span class="n">a_in</span><span class="p">)</span>

<span class="c1"># Reward ports</span>
<span class="n">reward_pattern_post</span><span class="o">.</span><span class="n">s_out</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">conn_inp_reward</span><span class="o">.</span><span class="n">s_in</span><span class="p">)</span>
<span class="n">conn_inp_reward</span><span class="o">.</span><span class="n">a_out</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">lif_post</span><span class="o">.</span><span class="n">a_third_factor_in</span><span class="p">)</span>

<span class="n">lif_pre</span><span class="o">.</span><span class="n">s_out</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">plast_conn</span><span class="o">.</span><span class="n">s_in</span><span class="p">)</span>
<span class="n">plast_conn</span><span class="o">.</span><span class="n">a_out</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">lif_post</span><span class="o">.</span><span class="n">a_in</span><span class="p">)</span>

<span class="c1"># Connect reward trace callback</span>
<span class="c1"># Sending the post synaptic spikes</span>
<span class="n">lif_post</span><span class="o">.</span><span class="n">s_out_bap</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">plast_conn</span><span class="o">.</span><span class="n">s_in_bap</span><span class="p">)</span>

<span class="n">lif_post</span><span class="o">.</span><span class="n">s_out_y1</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">plast_conn</span><span class="o">.</span><span class="n">s_in_y1</span><span class="p">)</span>

<span class="c1"># Sending graded reward spikes</span>
<span class="n">lif_post</span><span class="o">.</span><span class="n">s_out_y2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">plast_conn</span><span class="o">.</span><span class="n">s_in_y2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Create-monitors-to-observe-the-weight-and-trace-dynamics-during-learning">
<h3>Create monitors to observe the weight and trace dynamics during learning<a class="headerlink" href="#Create-monitors-to-observe-the-weight-and-trace-dynamics-during-learning" title="Permalink to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lava.proc.monitor.process</span> <span class="kn">import</span> <span class="n">Monitor</span>

<span class="c1"># Create monitors</span>
<span class="n">mon_pre_trace</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>
<span class="n">mon_post_trace</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>
<span class="n">mon_reward_trace</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>
<span class="n">mon_pre_spikes</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>
<span class="n">mon_post_spikes</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>
<span class="n">mon_weight</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>
<span class="n">mon_tag</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>
<span class="n">mon_s_in_y2</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>
<span class="n">mon_y2</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>

<span class="c1"># Connect monitors</span>
<span class="n">mon_pre_trace</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">plast_conn</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">)</span>
<span class="n">mon_post_trace</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">plast_conn</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">)</span>
<span class="n">mon_reward_trace</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">lif_post</span><span class="o">.</span><span class="n">s_out_y2</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">)</span>
<span class="n">mon_pre_spikes</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">lif_pre</span><span class="o">.</span><span class="n">s_out</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">)</span>
<span class="n">mon_post_spikes</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">lif_post</span><span class="o">.</span><span class="n">s_out</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">)</span>
<span class="n">mon_weight</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">plast_conn</span><span class="o">.</span><span class="n">weights</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">)</span>
<span class="n">mon_tag</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">plast_conn</span><span class="o">.</span><span class="n">tag_1</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Run-the-network">
<h3>Run the network<a class="headerlink" href="#Run-the-network" title="Permalink to this heading"></a></h3>
<p>The spiking neural network is simulated for 200 time steps using the Loihi2 simulation configuration.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lava.magma.core.run_conditions</span> <span class="kn">import</span> <span class="n">RunSteps</span>
<span class="kn">from</span> <span class="nn">lava.magma.core.run_configs</span> <span class="kn">import</span> <span class="n">Loihi2SimCfg</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Running</span>
<span class="n">pattern_pre</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">condition</span><span class="o">=</span><span class="n">RunSteps</span><span class="p">(</span><span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">),</span> <span class="n">run_cfg</span><span class="o">=</span><span class="n">Loihi2SimCfg</span><span class="p">(</span><span class="n">select_tag</span><span class="o">=</span><span class="n">SELECT_TAG</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get data from monitors</span>
<span class="n">pre_trace</span> <span class="o">=</span> <span class="n">mon_pre_trace</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="s1">&#39;plastic_dense&#39;</span><span class="p">][</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span>
<span class="n">post_trace</span> <span class="o">=</span> <span class="n">mon_post_trace</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="s1">&#39;plastic_dense&#39;</span><span class="p">][</span><span class="s1">&#39;y1&#39;</span><span class="p">]</span>
<span class="n">reward_trace</span> <span class="o">=</span> <span class="n">mon_reward_trace</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="s1">&#39;lif_post&#39;</span><span class="p">][</span><span class="s1">&#39;s_out_y2&#39;</span><span class="p">]</span>
<span class="n">pre_spikes</span> <span class="o">=</span> <span class="n">mon_pre_spikes</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="s1">&#39;lif_pre&#39;</span><span class="p">][</span><span class="s1">&#39;s_out&#39;</span><span class="p">]</span>
<span class="n">post_spikes</span> <span class="o">=</span> <span class="n">mon_post_spikes</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="s1">&#39;lif_post&#39;</span><span class="p">][</span><span class="s1">&#39;s_out&#39;</span><span class="p">]</span>
<span class="n">weights_neuron_A</span> <span class="o">=</span> <span class="n">mon_weight</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="s1">&#39;plastic_dense&#39;</span><span class="p">][</span><span class="s1">&#39;weights&#39;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">weights_neuron_B</span> <span class="o">=</span> <span class="n">mon_weight</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="s1">&#39;plastic_dense&#39;</span><span class="p">][</span><span class="s1">&#39;weights&#39;</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">tag_neuron_A</span> <span class="o">=</span> <span class="n">mon_tag</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="s1">&#39;plastic_dense&#39;</span><span class="p">][</span><span class="s1">&#39;tag_1&#39;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">tag_neuron_B</span> <span class="o">=</span> <span class="n">mon_tag</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="s1">&#39;plastic_dense&#39;</span><span class="p">][</span><span class="s1">&#39;tag_1&#39;</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Stopping</span>
<span class="n">pattern_pre</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Visualize-the-learning-results">
<h3>Visualize the learning results<a class="headerlink" href="#Visualize-the-learning-results" title="Permalink to this heading"></a></h3>
</section>
</section>
<section id="Plot-eligibility-trace-dynamics">
<h2>Plot eligibility trace dynamics<a class="headerlink" href="#Plot-eligibility-trace-dynamics" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">plot_spikes</span><span class="p">,</span> <span class="n">plot_time_series</span><span class="p">,</span> <span class="n">plot_time_series_subplots</span><span class="p">,</span> <span class="n">plot_spikes_time_series</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot spikes</span>
<span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">post_spikes</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">post_spikes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pre_spikes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
            <span class="n">legend</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Post-synaptic Neuron B&#39;</span><span class="p">,</span> <span class="s1">&#39;Post-synaptic Neuron A&#39;</span><span class="p">,</span> <span class="s1">&#39;Pre-synaptic&#39;</span><span class="p">],</span>
            <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#ff9912&#39;</span><span class="p">,</span>      <span class="s1">&#39;#458b00&#39;</span><span class="p">,</span>  <span class="s1">&#39;#f14a16&#39;</span><span class="p">],</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Spike arrival&#39;</span><span class="p">,</span>
            <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span>
            <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/lava_notebooks_in_depth_three_factor_learning_tutorial01_Reward_Modulated_STDP_30_0.png" src="../../../../_images/lava_notebooks_in_depth_three_factor_learning_tutorial01_Reward_Modulated_STDP_30_0.png" />
</div>
</div>
<p>This plot shows the spike times at which the pre-synaptic neuron and the post-synaptic neurons ‘A’ and ‘B’ fired across time-steps. The co-relation between the spike timing of the pre-synaptic neuron and the post-synaptic neurons are used to do learning updates throughout the rest of the tutorial.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_spikes_time_series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
                        <span class="n">time_series</span><span class="o">=</span><span class="n">pre_trace</span><span class="p">,</span>
                        <span class="n">spikes</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pre_spikes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]],</span>
                        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
                        <span class="n">legend</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Pre-synaptic Neuron&#39;</span><span class="p">],</span>
                        <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;#f14a16&#39;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Pre-synaptic Trace Dynamics&#39;</span><span class="p">],</span>
                        <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span>
                        <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/lava_notebooks_in_depth_three_factor_learning_tutorial01_Reward_Modulated_STDP_32_0.png" src="../../../../_images/lava_notebooks_in_depth_three_factor_learning_tutorial01_Reward_Modulated_STDP_32_0.png" />
</div>
</div>
<p>The first plot shows the spike times at which the pre-synaptic neuron fired. The pre-traces are updated based on the pre-synaptic spike train shown in the first plot. At the instant of a pre-synaptic spike, the pre-trace value is incremented by the ‘pre_trace_kernel_magnitude’ described in the learning rule. Subsequently, the trace value is decayed by a factor of ‘pre_trace_decay_tau’, with respect to the trace value at that instant, until the event of the next pre-synaptic spike. For example,
the first pre-synaptic spike happens at time step 15 as shown in the first plot by the first red dash. Therefore, the pre-trace value is increamented by a value of 16 (‘pre_trace_kernel_magnitude’), at time step 15, after which the decaying of the trace ensues until the next pre-synaptic spike at time step 46. Similar update dynamics are used to update the post-traces also.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_spikes_time_series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
                        <span class="n">time_series</span><span class="o">=</span><span class="n">post_trace</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                        <span class="n">spikes</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">post_spikes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]],</span>
                        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
                        <span class="n">legend</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Post-synaptic Neuron A&#39;</span><span class="p">],</span>
                        <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;#458b00&#39;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Post-synaptic Trace Dynamics (Neuron A)&#39;</span><span class="p">],</span>
                        <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span>
                        <span class="p">)</span>

<span class="n">plot_spikes_time_series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
                        <span class="n">time_series</span><span class="o">=</span><span class="n">post_trace</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
                        <span class="n">spikes</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">post_spikes</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">]],</span>
                        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
                        <span class="n">legend</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Post-synaptic Neuron B&#39;</span><span class="p">],</span>
                        <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;#ff9912&#39;</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Post-synaptic Trace Dynamics (Neuron B)&#39;</span><span class="p">],</span>
                        <span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span>
                        <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/lava_notebooks_in_depth_three_factor_learning_tutorial01_Reward_Modulated_STDP_34_0.png" src="../../../../_images/lava_notebooks_in_depth_three_factor_learning_tutorial01_Reward_Modulated_STDP_34_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/lava_notebooks_in_depth_three_factor_learning_tutorial01_Reward_Modulated_STDP_34_1.png" src="../../../../_images/lava_notebooks_in_depth_three_factor_learning_tutorial01_Reward_Modulated_STDP_34_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting tag dynamics (dt)</span>
<span class="n">plot_time_series_subplots</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
                          <span class="n">time_series_y1</span><span class="o">=</span><span class="n">tag_neuron_A</span><span class="p">,</span>
                          <span class="n">time_series_y2</span><span class="o">=</span><span class="n">tag_neuron_B</span><span class="p">,</span>
                          <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Trace value&quot;</span><span class="p">,</span>
                          <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Tag Dynamics (dt) for Post-synaptic Neurons&quot;</span><span class="p">,</span>
                          <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                          <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#458b00&#39;</span><span class="p">,</span> <span class="s1">&#39;#ff9912&#39;</span><span class="p">],</span>
                          <span class="n">legend</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Neuron A&#39;</span><span class="p">,</span> <span class="s1">&#39;Neuron B&#39;</span><span class="p">],</span>
                          <span class="n">leg_loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span>
                         <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/lava_notebooks_in_depth_three_factor_learning_tutorial01_Reward_Modulated_STDP_35_0.png" src="../../../../_images/lava_notebooks_in_depth_three_factor_learning_tutorial01_Reward_Modulated_STDP_35_0.png" />
</div>
</div>
<p>The tag dynamics replicate the STDP learning rule with an additional decay behaviour to represent an eligibility trace. The update to the tag trace is based on the co-relation between pre and post-synaptic spikes. Consider the trace dynamics for ‘Neuron A’, the post-synaptic neuron A, fires at time-step 6, which is indicated by the first green dash in the ‘spike arrival’ plot. In Loihi 2, the update of the traces are done after both the pre-synaptic and post-synaptic neurons have fired. At the
advent of pre-synaptic spike at time step 15, the tag trace of the post-synaptic neuron A which fired before the pre-synaptic neuron, is decremented by the dot product of the pre-trace value and the post-trace value at time step 15. This behaviour can be seen in the plot shown above. The evolution of the tag dynamics follows the same principle to do both depression and potentiation with respect to the co-relation between pre and post-spikes.</p>
</section>
<section id="Plot-reward-trace-dynamics">
<h2>Plot reward trace dynamics<a class="headerlink" href="#Plot-reward-trace-dynamics" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting reward trace dynamics</span>
<span class="n">plot_time_series_subplots</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
                          <span class="n">time_series_y1</span><span class="o">=</span><span class="n">reward_trace</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                          <span class="n">time_series_y2</span><span class="o">=</span><span class="n">reward_trace</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
                          <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Trace value&quot;</span><span class="p">,</span>
                          <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Reward Trace for Post-synaptic Neurons&quot;</span><span class="p">,</span>
                          <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                          <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#458b00&#39;</span><span class="p">,</span> <span class="s1">&#39;#ff9912&#39;</span><span class="p">],</span>
                          <span class="n">legend</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Neuron A&#39;</span><span class="p">,</span> <span class="s1">&#39;Neuron B&#39;</span><span class="p">]</span>
                         <span class="p">)</span>

<span class="c1"># Plotting weight dynamics</span>
<span class="n">plot_time_series_subplots</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
                          <span class="n">time_series_y1</span><span class="o">=</span><span class="n">weights_neuron_A</span><span class="p">,</span>
                          <span class="n">time_series_y2</span><span class="o">=</span><span class="n">weights_neuron_B</span><span class="p">,</span>
                          <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Trace value&quot;</span><span class="p">,</span>
                          <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Weight Dynamics (dw) for Plastic Connections&quot;</span><span class="p">,</span>
                          <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                          <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#458b00&#39;</span><span class="p">,</span> <span class="s1">&#39;#ff9912&#39;</span><span class="p">],</span>
                          <span class="n">legend</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Neuron A&#39;</span><span class="p">,</span> <span class="s1">&#39;Neuron B&#39;</span><span class="p">]</span>
                         <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/lava_notebooks_in_depth_three_factor_learning_tutorial01_Reward_Modulated_STDP_38_0.png" src="../../../../_images/lava_notebooks_in_depth_three_factor_learning_tutorial01_Reward_Modulated_STDP_38_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/lava_notebooks_in_depth_three_factor_learning_tutorial01_Reward_Modulated_STDP_38_1.png" src="../../../../_images/lava_notebooks_in_depth_three_factor_learning_tutorial01_Reward_Modulated_STDP_38_1.png" />
</div>
</div>
<p>In Loihi 2, individual post-synaptic neurons can be microcoded with reward traces that can be driven heterogeneously by synaptic inputs that differ in both magnitude and time. The reward trace plot shows the difference in third-factor trace received by the two-post synaptic neurons. The learnable synaptic weight is updated at every ‘t_epoch’ based on the instantanious value of the eligibility trace and the reward trace. In an ‘R-STDP’ rule, the synaptic weight is updated only when a
reward/third-factor value is non-zero. The weight dynamics of ‘Neuron A’ can be seen only being modified during the interval from time step 25 to time step 50, after which the weight trace value remains constant. This behaviour explains the functionality of the Reward-Modulated Spike-Timing Dependent Plasticity rule we defined in this tutorial.</p>
<section id="Advanced-Topic:-Implementing-custom-learning-rule-interfaces">
<h3>Advanced Topic: Implementing custom learning rule interfaces<a class="headerlink" href="#Advanced-Topic:-Implementing-custom-learning-rule-interfaces" title="Permalink to this heading"></a></h3>
<p>The RewardModulatedSTDP Class maps R-STDP parameters to terms understood by Loihi’s sum-of-product form learning engine. The eligibility trace <span class="math">E</span> can be stored in the tag variable <span class="math">t</span> of the Loihi learning engine. Tag dynamics <span class="math">dt</span> evolve according to</p>
<div class="math">
<p><span class="math">dt = STDP(pre, post) - t \cdot \tau_{tag} \cdot u_0</span></p>
</div><p>where <span class="math">\tau_{tag}</span> is the time constant of the tag evolution. As described in the <a class="reference internal" href="../tutorial08_stdp.html"><span class="doc">STDP tutorial</span></a>, pairwise STDP dynamics <span class="math">STDP(pre, post)</span> can be re-defined using Loihi learning engine variables as</p>
<div class="math">
<p><span class="math">dt = ( A_{+} \cdot x_0 \cdot y_1 + A_{-} \cdot y_0 \cdot x_1 ) - t \cdot \tau_{tag} \cdot u_0</span></p>
</div><p>where <span class="math">x_1</span> and <span class="math">y_1</span> are the pre and postsynaptic spikes, <span class="math">x_0</span> and <span class="math">y_0</span> describe a rule execution dependence on the timing of the pre and postsynaptic spikes, respectively, and the spike timing behavior is scaled by the constants <span class="math">A_{+} &lt; 0</span> and <span class="math">A_{-} &gt; 0</span>.</p>
<p>Weight evolution during learning <span class="math">dw</span> is a function of the tag dynamics <span class="math">t</span> and the reward signal, stored in Loihi’s post-synaptic trace variable <span class="math">y_2</span>:</p>
<div class="math">
<p><span class="math">dw = u_0 \cdot t \cdot y_2</span></p>
</div><p><span class="math">u_0</span> is the Loihi learning engine’s way of defining that the weight update occurs at every learning epoch.</p>
<p>The class structure of the RewardModulatedSTDP which converts the user readable variables to Loihi specific parameters and variables is described below.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lava.magma.core.learning.learning_rule</span> <span class="kn">import</span> <span class="n">Loihi3FLearningRule</span>
<span class="kn">from</span> <span class="nn">lava.magma.core.learning.utils</span> <span class="kn">import</span> <span class="n">float_to_literal</span>


<span class="k">class</span> <span class="nc">RewardModulatedSTDP</span><span class="p">(</span><span class="n">Loihi3FLearningRule</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">learning_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="n">A_plus</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="n">A_minus</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="n">pre_trace_decay_tau</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="n">post_trace_decay_tau</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="n">pre_trace_kernel_magnitude</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="n">post_trace_kernel_magnitude</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="n">eligibility_trace_decay_tau</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reward-Modulated Spike-timing dependent plasticity (STDP)</span>
<span class="sd">        as defined in Frémaux, Nicolas, and Wulfram Gerstner.</span>
<span class="sd">        &quot;Neuromodulated spike-timing-dependent plasticity, and</span>
<span class="sd">        theory of three-factor learning rules.&quot; Frontiers in</span>
<span class="sd">        neural circuits 9 (2016).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>

<span class="sd">        learning_rate: float</span>
<span class="sd">            Overall learning rate scaling the intensity of weight changes.</span>
<span class="sd">        A_plus:</span>
<span class="sd">            Scaling the weight change on pre-synaptic spike times.</span>
<span class="sd">        A_minus:</span>
<span class="sd">            Scaling the weight change on post-synaptic spike times.</span>
<span class="sd">        pre_trace_decay_tau:</span>
<span class="sd">            Decay time constant of the pre-synaptic activity trace.</span>
<span class="sd">        post_trace_decay_tau:</span>
<span class="sd">            Decay time constant of the post-synaptic activity trace.</span>
<span class="sd">        pre_trace_kernel_magnitude:</span>
<span class="sd">            The magnitude of increase to the pre-synaptic trace value</span>
<span class="sd">            at the instant of pre-synaptic spike.</span>
<span class="sd">        post_trace_kernel_magnitude:</span>
<span class="sd">            The magnitude of increase to the post-synaptic trace value</span>
<span class="sd">            at the instant of post-synaptic spike.</span>
<span class="sd">        eligibility_trace_decay_tau:</span>
<span class="sd">            Decay time constant of the eligibility trace.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">float_to_literal</span><span class="p">(</span><span class="n">learning_rate</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A_plus</span> <span class="o">=</span> <span class="n">float_to_literal</span><span class="p">(</span><span class="n">A_plus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A_minus</span> <span class="o">=</span> <span class="n">float_to_literal</span><span class="p">(</span><span class="n">A_minus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pre_trace_decay_tau</span> <span class="o">=</span> <span class="n">pre_trace_decay_tau</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">post_trace_decay_tau</span> <span class="o">=</span> <span class="n">post_trace_decay_tau</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pre_trace_kernel_magnitude</span> <span class="o">=</span> <span class="n">pre_trace_kernel_magnitude</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">post_trace_kernel_magnitude</span> <span class="o">=</span> <span class="n">post_trace_kernel_magnitude</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eligibility_trace_decay_tau</span> <span class="o">=</span> \
            <span class="n">float_to_literal</span><span class="p">(</span><span class="n">eligibility_trace_decay_tau</span><span class="p">)</span>

        <span class="c1"># Trace impulse values</span>
        <span class="n">x1_impulse</span> <span class="o">=</span> <span class="n">pre_trace_kernel_magnitude</span>

        <span class="c1"># Trace decay constants</span>
        <span class="n">x1_tau</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_trace_decay_tau</span>

        <span class="c1"># Eligibility trace represented as dt</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span><span class="si">}</span><span class="s2"> * </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">A_minus</span><span class="si">}</span><span class="s2"> * x0 * y1 + &quot;</span> \
             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span><span class="si">}</span><span class="s2"> * </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">A_plus</span><span class="si">}</span><span class="s2"> * y0 * x1 - &quot;</span> \
             <span class="sa">f</span><span class="s2">&quot;u0 * t * </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">eligibility_trace_decay_tau</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># Reward-modulated weight update</span>
        <span class="n">dw</span> <span class="o">=</span> <span class="s2">&quot; u0 * t * y2 &quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">dw</span><span class="o">=</span><span class="n">dw</span><span class="p">,</span>
            <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
            <span class="n">x1_impulse</span><span class="o">=</span><span class="n">x1_impulse</span><span class="p">,</span>
            <span class="n">x1_tau</span><span class="o">=</span><span class="n">x1_tau</span><span class="p">,</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="How-to-learn-more?">
<h3>How to learn more?<a class="headerlink" href="#How-to-learn-more?" title="Permalink to this heading"></a></h3>
</section>
</section>
<section id="Follow-the-links-below-for-deep-dive-tutorials-on-the-concepts-in-this-tutorial:">
<h2>Follow the links below for deep-dive tutorials on the concepts in this tutorial:<a class="headerlink" href="#Follow-the-links-below-for-deep-dive-tutorials-on-the-concepts-in-this-tutorial:" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../tutorial02_processes.html"><span class="doc">Processes</span></a></p></li>
<li><p><a class="reference internal" href="../tutorial03_process_models.html"><span class="doc">ProcessModel</span></a></p></li>
<li><p><a class="reference internal" href="../tutorial04_execution.html"><span class="doc">Execution</span></a></p></li>
<li><p><a class="reference internal" href="../tutorial05_connect_processes.html"><span class="doc">Connecting Processes</span></a></p></li>
</ul>
<p>If you want to find out more about Lava, have a look at the <a class="reference external" href="https://lava-nc.org/">Lava documentation</a> or dive into the <a class="reference external" href="https://github.com/lava-nc/lava/">source code</a>.</p>
<p>To receive regular updates on the latest developments and releases of the Lava Software Framework please subscribe to the <a class="reference external" href="http://eepurl.com/hJCyhb">INRC newsletter</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../tutorial09_custom_learning_rules.html" class="btn btn-neutral float-left" title="Custom Learning Rules" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../../../algorithms.html" class="btn btn-neutral float-right" title="Algorithms and Application Libraries" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Intel Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>