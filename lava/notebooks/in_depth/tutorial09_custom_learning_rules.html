<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Custom Learning Rules &mdash; Lava  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Algorithms and Application Libraries" href="../../../algorithms.html" />
    <link rel="prev" title="Spike-timing Dependent Plasticity (STDP)" href="tutorial08_stdp.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> Lava
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../lava_architecture_overview.html">Lava Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../lava_architecture_overview.html#key-attributes">Key attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../lava_architecture_overview.html#why-do-we-need-lava">Why do we need Lava?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../lava_architecture_overview.html#lava-s-foundational-concepts">Lava’s foundational concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../lava_architecture_overview.html#processes">1. Processes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava_architecture_overview.html#behavioral-implementations-via-processmodels">2. Behavioral implementations via ProcessModels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava_architecture_overview.html#composability-and-connectivity">3. Composability and connectivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava_architecture_overview.html#cross-platform-execution">4. Cross-platform execution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../lava_architecture_overview.html#lava-software-stack">Lava software stack</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../getting_started_with_lava.html">Getting Started with Lava</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial01_installing_lava.html">Installing Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial01_installing_lava.html#1.-System-Requirements">1. System Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial01_installing_lava.html#2.-Getting-Started">2. Getting Started</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial01_installing_lava.html#2.1-Cloning-Lava-and-Running-from-Source">2.1 Cloning Lava and Running from Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial01_installing_lava.html#2.2-[Alternative]-Installing-Lava-from-Binaries">2.2 [Alternative] Installing Lava from Binaries</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tutorial01_installing_lava.html#When-running-tests-if-you-see-‘OSError:-[Errno-24]-Too-many-open-files’-consider-setting-ulimit-using-ulimit--n-4096">When running tests if you see ‘OSError: [Errno 24] Too many open files’ consider setting ulimit using <code class="docutils literal notranslate"><span class="pre">ulimit</span> <span class="pre">-n</span> <span class="pre">4096</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial01_installing_lava.html#3.-Running-Lava-on-Intel-Loihi">3. Running Lava on Intel Loihi</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial01_installing_lava.html#4.-Lava-Developer-Guide">4. Lava Developer Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial01_installing_lava.html#5.-Tutorials">5. Tutorials</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial01_installing_lava.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../end_to_end/tutorial00_tour_through_lava.html">Walk through Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial00_tour_through_lava.html#1.-Usage-of-the-Process-Library">1. Usage of the Process Library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../end_to_end/tutorial00_tour_through_lava.html#Processes">Processes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../end_to_end/tutorial00_tour_through_lava.html#Ports-and-connections">Ports and connections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../end_to_end/tutorial00_tour_through_lava.html#Variables">Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../end_to_end/tutorial00_tour_through_lava.html#Record-internal-Vars-over-time">Record internal Vars over time</a></li>
<li class="toctree-l4"><a class="reference internal" href="../end_to_end/tutorial00_tour_through_lava.html#Execution">Execution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../end_to_end/tutorial00_tour_through_lava.html#Retrieve-recorded-data">Retrieve recorded data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../end_to_end/tutorial00_tour_through_lava.html#Summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../end_to_end/tutorial00_tour_through_lava.html#Learn-more-about">Learn more about</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial00_tour_through_lava.html#2.-Create-a-custom-Process">2. Create a custom Process</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../end_to_end/tutorial00_tour_through_lava.html#Create-a-new-ProcessModel">Create a new ProcessModel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../end_to_end/tutorial00_tour_through_lava.html#Use-the-custom-SpikeGenerator">Use the custom SpikeGenerator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../end_to_end/tutorial00_tour_through_lava.html#Execute-and-plot">Execute and plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../end_to_end/tutorial00_tour_through_lava.html#id1">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../end_to_end/tutorial00_tour_through_lava.html#id2">Learn more about</a></li>
<li class="toctree-l4"><a class="reference internal" href="../end_to_end/tutorial00_tour_through_lava.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial02_processes.html">Processes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial02_processes.html#Recommended-tutorials-before-starting:">Recommended tutorials before starting:</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial02_processes.html#What-is-a-Process?">What is a <em>Process</em>?</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial02_processes.html#How-to-build-a-Process?">How to build a <em>Process</em>?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial02_processes.html#Overall-architecture">Overall architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial02_processes.html#AbstractProcess:-Defining-Vars,-Ports,-and-the-API"><em>AbstractProcess</em>: Defining <em>Vars</em>, <em>Ports</em>, and the API</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial02_processes.html#ProcessModel:-Defining-the-behavior-of-a-Process"><em>ProcessModel</em>: Defining the behavior of a <em>Process</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial02_processes.html#Instantiating-the-Process">Instantiating the <em>Process</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tutorial02_processes.html#Interacting-with-Processes">Interacting with <em>Processes</em></a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial02_processes.html#Accessing-Vars">Accessing <em>Vars</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial02_processes.html#Using-custom-APIs">Using custom APIs</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial02_processes.html#Executing-a-Process">Executing a <em>Process</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial02_processes.html#Update-Vars">Update <em>Vars</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tutorial02_processes.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial03_process_models.html"><em>ProcessModels</em></a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial03_process_models.html#Recommended-tutorials-before-starting:">Recommended tutorials before starting:</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial03_process_models.html#Create-a-LIF-Process">Create a LIF <em>Process</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial03_process_models.html#Create-a-Python-LeafProcessModel-that-implements-the-LIF-Process">Create a Python <em>LeafProcessModel</em> that implements the LIF <em>Process</em></a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial03_process_models.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial03_process_models.html#Defining-a-PyLifModel-for-LIF">Defining a <em>PyLifModel</em> for LIF</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial03_process_models.html#Compile-and-run-PyLifModel">Compile and run <em>PyLifModel</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tutorial03_process_models.html#Selecting-1-ProcessModel:-More-on-LeafProcessModel-attributes-and-relations">Selecting 1 <em>ProcessModel</em>: More on <em>LeafProcessModel</em> attributes and relations</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial03_process_models.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial04_execution.html">Execution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial04_execution.html#Recommended-tutorials-before-starting:">Recommended tutorials before starting:</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial04_execution.html#Configuring-and-starting-execution">Configuring and starting execution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial04_execution.html#Run-conditions">Run conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial04_execution.html#Run-configurations">Run configurations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tutorial04_execution.html#Running-multiple-Processes">Running multiple <em>Processes</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial04_execution.html#Pausing,-resuming,-and-stopping-execution">Pausing, resuming, and stopping execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial04_execution.html#Manual-compilation-and-execution">Manual compilation and execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial04_execution.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial05_connect_processes.html">Connect processes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial05_connect_processes.html#Recommended-tutorials-before-starting:">Recommended tutorials before starting:</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial05_connect_processes.html#Building-a-network-of-Processes">Building a network of <em>Processes</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial05_connect_processes.html#Create-a-connection">Create a connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial05_connect_processes.html#Possible-connections">Possible connections</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial05_connect_processes.html#There-are-some-things-to-consider-though:">There are some things to consider though:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tutorial05_connect_processes.html#Connect-multiple-InPorts-from-a-single-OutPort">Connect multiple <em>InPorts</em> from a single <em>OutPort</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial05_connect_processes.html#Connecting-multiple-InPorts-to-a-single-OutPort">Connecting multiple <em>InPorts</em> to a single <em>OutPort</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial05_connect_processes.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial06_hierarchical_processes.html">Hierarchical <em>Processes</em> and <em>SubProcessModels</em></a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial06_hierarchical_processes.html#Recommended-tutorials-before-starting:">Recommended tutorials before starting:</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial06_hierarchical_processes.html#Create-LIF-and-Dense-Processes-and-ProcessModels">Create LIF and Dense <em>Processes</em> and <em>ProcessModels</em></a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial06_hierarchical_processes.html#Create-a-Dense-connection-Process">Create a Dense connection <em>Process</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial06_hierarchical_processes.html#Create-a-Python-Dense-connection-ProcessModel-implementing-the-Loihi-Sync-Protocol-and-requiring-a-CPU-compute-resource">Create a Python Dense connection <em>ProcessModel</em> implementing the Loihi Sync Protocol and requiring a CPU compute resource</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial06_hierarchical_processes.html#Create-a-LIF-neuron-Process">Create a LIF neuron <em>Process</em></a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial06_hierarchical_processes.html#Create-a-Python-LIF-neuron-ProcessModel-implementing-the-Loihi-Sync-Protocol-and-requiring-a-CPU-compute-resource">Create a Python LIF neuron <em>ProcessModel</em> implementing the Loihi Sync Protocol and requiring a CPU compute resource</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tutorial06_hierarchical_processes.html#Create-a-DenseLayer-Hierarchical-Process-that-encompasses-Dense-and-LIF-Process-behavior">Create a DenseLayer Hierarchical <em>Process</em> that encompasses Dense and LIF <em>Process</em> behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial06_hierarchical_processes.html#Create-a-SubProcessModel-that-implements-the-DenseLayer-Process-using-Dense-and-LIF-child-Processes">Create a <em>SubProcessModel</em> that implements the DenseLayer <em>Process</em> using Dense and LIF child <em>Processes</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial06_hierarchical_processes.html#Run-the-DenseLayer-Process">Run the DenseLayer <em>Process</em></a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial06_hierarchical_processes.html#Run-Connected-DenseLayer-Processes">Run Connected DenseLayer <em>Processes</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tutorial06_hierarchical_processes.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial07_remote_memory_access.html">Remote Memory Access</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial07_remote_memory_access.html#Recommended-tutorials-before-starting:">Recommended tutorials before starting:</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial07_remote_memory_access.html#Create-a-minimal-Process-and-ProcessModel-with-a-RefPort">Create a minimal <em>Process</em> and <em>ProcessModel</em> with a <em>RefPort</em></a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial07_remote_memory_access.html#Create-a-Python-Process-Model-implementing-the-Loihi-Sync-Protocol-and-requiring-a-CPU-compute-resource">Create a Python Process Model implementing the Loihi Sync Protocol and requiring a CPU compute resource</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tutorial07_remote_memory_access.html#Run-the-Processes">Run the <em>Processes</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial07_remote_memory_access.html#Implicit-and-explicit-VarPorts">Implicit and explicit VarPorts</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial07_remote_memory_access.html#Options-to-connect-RefPorts-and-VarPorts">Options to connect RefPorts and VarPorts</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial07_remote_memory_access.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../end_to_end/tutorial01_mnist_digit_classification.html">MNIST Digit Classification with Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial01_mnist_digit_classification.html#This-tutorial-assumes-that-you:">This tutorial assumes that you:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial01_mnist_digit_classification.html#This-tutorial-gives-a-bird’s-eye-view-of">This tutorial gives a bird’s-eye view of</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial01_mnist_digit_classification.html#Our-MNIST-Classifier">Our MNIST Classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial01_mnist_digit_classification.html#General-Imports">General Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial01_mnist_digit_classification.html#Lava-Processes">Lava Processes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial01_mnist_digit_classification.html#ProcessModels-for-Python-execution">ProcessModels for Python execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial01_mnist_digit_classification.html#Connecting-Processes">Connecting Processes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial01_mnist_digit_classification.html#Execution-and-results">Execution and results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../end_to_end/tutorial01_mnist_digit_classification.html#How-to-learn-more?">How to learn more?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial01_mnist_digit_classification.html#Follow-the-links-below-for-deep-dive-tutorials-on-the-concepts-in-this-tutorial:">Follow the links below for deep-dive tutorials on the concepts in this tutorial:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html">Excitatory-Inhibitory Neural Network with Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#This-tutorial-assumes-that-you:">This tutorial assumes that you:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#This-tutorial-gives-a-high-level-view-of">This tutorial gives a high level view of</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#E/I-Network">E/I Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#General-imports">General imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#E/I-Network-Lava-Process">E/I Network Lava Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#ProcessModels-for-Python-execution">ProcessModels for Python execution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#Rate-neurons">Rate neurons</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#Defining-the-parameters-for-the-network">Defining the parameters for the network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#Execution-and-Results">Execution and Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#Visualizing-the-activity">Visualizing the activity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#Further-analysis">Further analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#Controlling-the-network">Controlling the network</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#LIF-Neurons">LIF Neurons</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#id7">Execution and Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#id8">Visualizing the activity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#id9">Controlling the network</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#DIfferent-recurrent-activation-regimes">DIfferent recurrent activation regimes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#Running-a-ProcessModel-bit-accurate-with-Loihi">Running a ProcessModel bit-accurate with Loihi</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#Execution-of-bit-accurate-model">Execution of bit accurate model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../end_to_end/tutorial02_excitatory_inhibitory_network.html#Follow-the-links-below-for-deep-dive-tutorials-on-the-concepts-in-this-tutorial:">Follow the links below for deep-dive tutorials on the concepts in this tutorial:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial08_stdp.html">Spike-timing Dependent Plasticity (STDP)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial08_stdp.html#This-tutorial-assumes-that-you:">This tutorial assumes that you:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial08_stdp.html#STDP-from-Lavas-Process-Library">STDP from Lavas Process Library</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tutorial08_stdp.html#The-plastic-connection-Process">The plastic connection Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial08_stdp.html#Plot-spike-trains">Plot spike trains</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial08_stdp.html#Plot-traces">Plot traces</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial08_stdp.html#Plot-STDP-learning-window-and-weight-changes">Plot STDP learning window and weight changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial08_stdp.html#Follow-the-links-below-for-deep-dive-tutorials-on-the-concepts-in-this-tutorial:">Follow the links below for deep-dive tutorials on the concepts in this tutorial:</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Custom Learning Rules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#This-tutorial-assumes-that-you:">This tutorial assumes that you:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#2.-Loihi’s-learning-engine">2. Loihi’s learning engine</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Epoch-based-updates">Epoch-based updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Synaptic-variables">Synaptic variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Learning-rules">Learning rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Scaling-factors">Scaling factors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Factors">Factors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Traces">Traces</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example:-Basic-pair-based-STDP">Example: Basic pair-based STDP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Instantiating-LearningRule">Instantiating LearningRule</a></li>
<li class="toctree-l3"><a class="reference internal" href="#The-plastic-connection-Process">The plastic connection Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Plot-spike-trains">Plot spike trains</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Plot-traces">Plot traces</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Plot-STDP-learning-window-and-weight-changes">Plot STDP learning window and weight changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Follow-the-links-below-for-deep-dive-tutorials-on-the-concepts-in-this-tutorial:">Follow the links below for deep-dive tutorials on the concepts in this tutorial:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../algorithms.html">Algorithms and Application Libraries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../dl.html">Deep Learning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../dl.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dl.html#lava-dl-workflow">Lava-DL Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dl.html#getting-started">Getting Started</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dl.html#slayer-2-0">SLAYER 2.0</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../dl.html#example-code">Example Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../dl.html#bootstrap">Bootstrap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../dl.html#example-code-1">Example Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../dl.html#network-exchange-netx-library">Network Exchange (NetX) Library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../dl.html#example-code-2">Example Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../dl.html#detailed-description">Detailed Description</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/slayer.html">Lava-DL SLAYER</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/bootstrap/bootstrap.html">Lava-DL Bootstrap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/netx/netx.html">Lava-DL NetX</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../dnf.html">Dynamic Neural Fields</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../dnf.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dnf.html#what-is-lava-dnf">What is lava-dnf?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dnf.html#key-features">Key features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../dnf.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../optimization.html">Neuromorphic Constraint Optimization Library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../optimization.html#taxonomy-of-optimization-problems">Taxonomy of Optimization Problems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimization.html#optimizationsolver-and-optimizationproblem-classes">OptimizationSolver and OptimizationProblem Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimization.html#tutorials">Tutorials</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../optimization.html#qp-tutorial">QP Tutorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimization.html#solving-qp-problems-after-merging-with-the-optimizationsolver-qpsolver-will-be-deprecated">Solving QP problems (After merging with the OptimizationSolver QPSolver will be deprecated)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimization.html#qubo-tutorial">QUBO Tutorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimization.html#solving-qubo-using-the-generic-optimizationsolver">Solving QUBO using the Generic OptimizationSolver</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimization.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimization.html#installation">Installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../optimization.html#linux-macos">[Linux/MacOS]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimization.html#windows">[Windows]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../optimization.html#alternative-installing-lava-via-conda">[Alternative] Installing Lava via Conda</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../optimization.html#id1">Tutorials</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorial_01_solving_lasso.html">Quadratic Programming with Lava</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorial_02_solving_qubos.html">Quadratic Unconstrained Binary Optimization (QUBO) with Lava</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer_guide.html">Developer Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide.html#lava-s-origins">Lava’s Origins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide.html#contact-information">Contact Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide.html#development-roadmap">Development Roadmap</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#initial-release">Initial Release</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide.html#how-to-contribute-to-lava">How to contribute to Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#open-an-issue">Open an Issue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#pull-request-checklist">Pull Request Checklist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#open-a-pull-request">Open a Pull Request</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide.html#coding-conventions">Coding Conventions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#code-requirements">Code Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#guidelines">Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#docstring-format">Docstring Format</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide.html#contributors">Contributors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#contributor">Contributor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#committer">Committer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../developer_guide.html#list-of-lava-nc-lava-project-committers">List of lava-nc/lava Project Committers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../developer_guide.html#list-of-lava-nc-lava-dnf-project-committers">List of lava-nc/lava-dnf Project Committers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../developer_guide.html#list-of-lava-nc-lava-optimization-project-committers">List of lava-nc/lava-optimization Project Committers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../developer_guide.html#list-of-lava-nc-lava-dl-project-committers">List of lava-nc/lava-dl Project Committers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../developer_guide.html#committer-promotion">Committer Promotion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide.html#repository-structure">Repository Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#id17">lava-nc/lava</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#lava-nc-lava-dnf">lava-nc/lava-dnf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#lava-nc-lava-dl">lava-nc/lava-dl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#lava-nc-lava-optimization">lava-nc/lava-optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../developer_guide.html#lava-nc-lava-docs">lava-nc/lava-docs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide.html#code-of-conduct">Code of Conduct</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../developer_guide.html#licenses">Licenses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../lava_api_documentation.html">Lava API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lava.html">Lava</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lava.magma.html">Magma</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lava.magma.compiler.html">lava.magma.compiler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.magma.core.html">lava.magma.core</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.magma.runtime.html">lava.magma.runtime</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lava.proc.html">Lava process library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.conv.html">lava.proc.conv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.cost_integrator.html">lava.proc.cost_integrator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.dense.html">lava.proc.dense</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.io.html">lava.proc.io</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.learning_rules.html">lava.proc.learning_rules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.lif.html">lava.proc.lif</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.monitor.html">lava.proc.monitor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.read_gate.html">lava.proc.read_gate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.receiver.html">lava.proc.receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.scif.html">lava.proc.scif</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.sdn.html">lava.proc.sdn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.proc.spiker.html">lava.proc.spiker</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lava.utils.html">lava.utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lava.utils.dataloader.html">lava.utils.dataloader</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.utils.html#lava-utils-float2fixed">lava.utils.float2fixed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.utils.html#lava-utils-profiler">lava.utils.profiler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.utils.html#lava-utils-system">lava.utils.system</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.utils.html#lava-utils-validator">lava.utils.validator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.utils.html#lava-utils-visualizer">lava.utils.visualizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lava.utils.html#lava-utils-weightutils">lava.utils.weightutils</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../lava-lib-dl/index.html">Lava - Deep Learning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-dl/slayer/index.html">SLAYER</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/neuron/modules.html">Neuron</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/synapse/modules.html">Synapse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/spike/modules.html">Spike</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/axon/modules.html">Axon</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/dendrite/modules.html">Dendrite</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/block/modules.html">Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/loss.html">Loss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/classifier.html">Classifier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/io.html">Input/Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/auto.html">Auto</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/slayer/utils/modules.html">Utilities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-dl/slayer/index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-dl/bootstrap/index.html">Bootstrap (ANN-SNN training)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/bootstrap/block/modules.html">Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/bootstrap/ann_sampler.html">ANN Statistics Sampler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/bootstrap/routine.html">Routine</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-dl/bootstrap/index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-dl/netx/index.html">Lava-DL NetX</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/netx/blocks/modules.html">Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/netx/hdf5.html">HDF5</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-dl/netx/utils.html">Utils</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-dl/netx/index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../lava-lib-dnf/index.html">Lava - Dynamic Neural Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.html">Lava - Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.problems.html">lava.lib.optimization.problems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.problems.html#lava-lib-optimization-problems-coefficients">lava.lib.optimization.problems.coefficients</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.problems.html#lava-lib-optimization-problems-constraints">lava.lib.optimization.problems.constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.problems.html#lava-lib-optimization-problems-cost">lava.lib.optimization.problems.cost</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.problems.html#lava-lib-optimization-problems-problems">lava.lib.optimization.problems.problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.problems.html#lava-lib-optimization-problems-variables">lava.lib.optimization.problems.variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.solvers.html">lava.lib.optimization.solvers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.solvers.generic.html">lava.lib.optimization.solvers.generic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../lava-lib-optimization/lava.lib.optimization.solvers.qp.html">lava.lib.optimization.solvers.qp</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Lava</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../../getting_started_with_lava.html">Getting Started with Lava</a> &raquo;</li>
      <li>Custom Learning Rules</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/lava/notebooks/in_depth/tutorial09_custom_learning_rules.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<p><em>Copyright (C) 2021 Intel Corporation</em> <em>SPDX-License-Identifier: BSD-3-Clause</em> <em>See: https://spdx.org/licenses/</em></p>
<hr class="docutils" />
<div class="section" id="Custom-Learning-Rules">
<h1>Custom Learning Rules<a class="headerlink" href="#Custom-Learning-Rules" title="Permalink to this headline"></a></h1>
<p><strong>Motivation</strong><em>: In this tutorial, we will demonstrate usage of a software model of Loihi’s learning engine, exposed in Lava. This involves the LearningRule object for learning rule and other learning-related information encapsulation and the LearningDense Lava Process modelling learning-enabled connections.</em></p>
<div class="section" id="This-tutorial-assumes-that-you:">
<h2>This tutorial assumes that you:<a class="headerlink" href="#This-tutorial-assumes-that-you:" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>have the <a class="reference external" href="../../in_depth/tutorial01_installing_lava.ipynb">Lava framework installed</a></p></li>
<li><p>are familiar with the <a class="reference external" href="../../in_depth/tutorial02_processes.ipynb">Process concept in Lava</a></p></li>
<li><p>are familiar with the <a class="reference external" href="../../in_depth/tutorial02_process_models.ipynb">ProcessModel concept in Lava</a></p></li>
<li><p>are familiar with how to <a class="reference external" href="../../in_depth/tutorial05_connect_processes.ipynb">connect Lava Processes</a></p></li>
</ul>
<p>This tutorial gives a bird’s-eye view of how to develop custom learning rules for Loihi. For this purpose, we will create a network of LIF and Dense processes with one plastic connection and generate frozen patterns of activity. We can easily choose between a floating point simulation of the learning engine and a fixed point simulation, which approximates the behavior on the Loihi neuromorphic hardware. We also will create monitors to observe the behavior of the weights and activity traces of
the neurons and learning rules.</p>
<div class="section" id="2.-Loihi’s-learning-engine">
<h3>2. Loihi’s learning engine<a class="headerlink" href="#2.-Loihi’s-learning-engine" title="Permalink to this headline"></a></h3>
<p>Loihi provides a programmable learning engine that can evolve synaptic state variables over time as a function of several locally available parameters and the equations relating input terms to output synaptic target variables are called <em>learning rules</em>. These learning rule equations are highly configurable but are constrained to a sum of products form.</p>
</div>
</div>
<div class="section" id="Epoch-based-updates">
<h2>Epoch-based updates<a class="headerlink" href="#Epoch-based-updates" title="Permalink to this headline"></a></h2>
<p>For efficiency reasons, trace and synaptic variable updates proceed in learning epochs with a length of <img class="math" src="../../../_images/math/18994ad4c5c36b4ce43ca4a0516a6757a065b39a.png" alt="t_{epoch}"/> time steps. Within an epoch, spike events are recorded but trace and synaptic variable updates are only computed and applied with a slight delay at the end of the epoch. This delayed application will theoretically not have any impact as long as there is only one spike per synapse and per epoch.</p>
</div>
<div class="section" id="Synaptic-variables">
<h2>Synaptic variables<a class="headerlink" href="#Synaptic-variables" title="Permalink to this headline"></a></h2>
<p>For each synapse, Loihi’s computational model defines a set of three synaptic state variables that can be modified by the learning engine. These are : - Weight <img class="math" src="../../../_images/math/1fbee781f84569077719a167b64e12064360fac1.png" alt="W"/>, representing <em>synaptic efficacy</em>. - Delay <img class="math" src="../../../_images/math/0fcab9067b50b87e868c4fd70f213a086addb964.png" alt="D"/>, representing <em>synaptic delay</em>. - Tag <img class="math" src="../../../_images/math/e8dea8254118f111b5fb20895b03528c17566f06.png" alt="T"/>, which is an additional synaptic variable that allows for constructing more complex learning dynamics.</p>
</div>
<div class="section" id="Learning-rules">
<h2>Learning rules<a class="headerlink" href="#Learning-rules" title="Permalink to this headline"></a></h2>
<p>The amount of change by which a target synaptic variable is updated at the end of a learning epoch is given by the learning rule associated with said variable. The rules are specified in sum-of-products form:</p>
<div class="math">
<p><img src="../../../_images/math/d8d6eac4a7512d99423c78a907f8fcc8b2c3db3b.png" alt="Z \in \{W, D, T\}"/></p>
</div><div class="math">
<p><img src="../../../_images/math/c5155fca7cd79ba825bb905038cb72964d67034c.png" alt="dZ = \sum_{i = 1}^{N_P} D_i \cdot \left[ S_i \cdot \prod_{j = 1}^{N_F^i} F_{i, j} \right]"/></p>
</div><p>The learning rule consists in a <em>sum</em> of <img class="math" src="../../../_images/math/7c085620d2b3350f534f896bd266a7cf978b8803.png" alt="N_P"/> <em>products</em>. Each <img class="math" src="../../../_images/math/5aa339d4daf45a810dda332e3c80a0698e526e04.png" alt="i"/>’th product is composed of a dependency operator <img class="math" src="../../../_images/math/c493811970fe3f0f8605b0cd1b63a11ad19ca165.png" alt="D_i"/>, a scaling factor <img class="math" src="../../../_images/math/f18bf639d8e5490eec40c8a4a6a7a1389c3dd6a5.png" alt="S_i"/> and a sub-product of <img class="math" src="../../../_images/math/06db73eed2c93b7118c21dcee31e32c597728cf5.png" alt="N_F^i"/> factors with <img class="math" src="../../../_images/math/9e8d6edf0347bf3079cb1de0b85c12831e0ec6c6.png" alt="F_{i, j}"/> denoting the <img class="math" src="../../../_images/math/e3fc28292267f066fee7718c64f4bbfece521f24.png" alt="j"/>’th factor of the current product.</p>
</div>
<div class="section" id="Dependencies">
<h2>Dependencies<a class="headerlink" href="#Dependencies" title="Permalink to this headline"></a></h2>
<p>Each product is associated with a <em>dependency</em> operator <img class="math" src="../../../_images/math/c493811970fe3f0f8605b0cd1b63a11ad19ca165.png" alt="D_i"/> that conditions the evaluation of a product on the presence of a pre- or post-synaptic spike during the past epoch or evaluates a product unconditionally every other epoch. <img class="math" src="../../../_images/math/c493811970fe3f0f8605b0cd1b63a11ad19ca165.png" alt="D_i"/> also determines at what time step during an epoch, all trace variables in the associated product are evaluated. The table below lists the various dependency operators and their behavior:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Dependency</p></th>
<th class="head"><p><img class="math" src="../../../_images/math/bfe9f05551148a6dcd7b5d7570a2ffc444cd923a.png" alt="t_{eval}"/></p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><img class="math" src="../../../_images/math/ed7fb0260e58d3ca5851e823ff991dae4cde5671.png" alt="x_0"/></p></td>
<td><p><img class="math" src="../../../_images/math/fead954fcd20a0ead056967239aa13e5df14a0dd.png" alt="t_x"/></p></td>
<td><p>Conditioned on at least one pre-synaptic spike during epoch.</p></td>
</tr>
<tr class="row-odd"><td><p><img class="math" src="../../../_images/math/c02d829cecb5c5b40b5a00db3dc936351b671e07.png" alt="y_0"/></p></td>
<td><p><img class="math" src="../../../_images/math/5717630f8b825bf1b3c5cfc3cfec764aadde0c26.png" alt="t_y"/></p></td>
<td><p>Conditioned on at least one post-synaptic spike during epoch.</p></td>
</tr>
<tr class="row-even"><td><p><img class="math" src="../../../_images/math/2d6ea9e166dd7ac8f5455724a62c820164709cb6.png" alt="u_{\kappa}"/></p></td>
<td><p><img class="math" src="../../../_images/math/18994ad4c5c36b4ce43ca4a0516a6757a065b39a.png" alt="t_{epoch}"/></p></td>
<td><p>Unconditionally executed every <img class="math" src="../../../_images/math/b6742f70fd831234bcc0778c07fc43f6434088e3.png" alt="\kappa \cdot t_{epoch}"/> time steps.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="Scaling-factors">
<h2>Scaling factors<a class="headerlink" href="#Scaling-factors" title="Permalink to this headline"></a></h2>
<p>Each product is also associated with a <em>scaling factor</em> (constant literal) that is given in mantissa/exponent form :</p>
<div class="math">
<p><img src="../../../_images/math/fa1b099509a2d4d1ac2fe107a3c890f8c280daa9.png" alt="S_i = S_i^{mant} \cdot 2^{S_i^{exp}}"/></p>
</div></div>
<div class="section" id="Factors">
<h2>Factors<a class="headerlink" href="#Factors" title="Permalink to this headline"></a></h2>
<p>Furthermore, Loihi provides a set of locally available quantities which can be used in learning rule to derive synaptic variable updates. The table below lists the various types of variables whose value <img class="math" src="../../../_images/math/9e8d6edf0347bf3079cb1de0b85c12831e0ec6c6.png" alt="F_{i, j}"/> can assume:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 51%" />
<col style="width: 49%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Factor</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="math">
<p><img src="../../../_images/math/18a7b7b203393ed99b7fe5401d23399ebe44f927.png" alt="x_0 + C"/></p>
</div></td>
<td><p>Pre-synaptic spike.</p></td>
</tr>
<tr class="row-odd"><td><div class="math">
<p><img src="../../../_images/math/6e7dd7e6421bff81c2e9087bcd1fab71bb7aeb3f.png" alt="x_1(t_{eval}) + C"/></p>
</div></td>
<td><p>Pre-synaptic trace <img class="math" src="../../../_images/math/5ea99039cd8359fa2e14317dbfae4497ebbc1360.png" alt="x_1"/>.</p></td>
</tr>
<tr class="row-even"><td><div class="math">
<p><img src="../../../_images/math/1ff30457e64c39a49212b1ecb1bf8a0a1fdc71b3.png" alt="x_2(t_{eval}) + C"/></p>
</div></td>
<td><p>Pre-synaptic trace <img class="math" src="../../../_images/math/b7bda214149c6fe0d7c6c494b0c896805bf51262.png" alt="x_2"/>.</p></td>
</tr>
<tr class="row-odd"><td><div class="math">
<p><img src="../../../_images/math/3a4ab2eaf1e5e25bc879979ae79d807a894e0516.png" alt="y_0 + C"/></p>
</div></td>
<td><p>Post-synaptic spike.</p></td>
</tr>
<tr class="row-even"><td><div class="math">
<p><img src="../../../_images/math/f70f8838f17b92cc52e85dc0bcee86cdbb2f703c.png" alt="y_1(t_{eval}) + C"/></p>
</div></td>
<td><p>Post-synaptic trace <img class="math" src="../../../_images/math/7a4a430067dab11b32cfcddbd7d7fd6b5f4d3070.png" alt="y_1"/>.</p></td>
</tr>
<tr class="row-odd"><td><div class="math">
<p><img src="../../../_images/math/94c19abb5545320db3f5c041c1e3126d0b9437f8.png" alt="y_2(t_{eval}) + C"/></p>
</div></td>
<td><p>Post-synaptic trace <img class="math" src="../../../_images/math/f5f424471e1f942a67eedbdbb512954c4e722fe8.png" alt="y_2"/>.</p></td>
</tr>
<tr class="row-even"><td><div class="math">
<p><img src="../../../_images/math/9fbf6b650aca1cdbc934258c9906016f98986dd3.png" alt="y_3(t_{eval}) + C"/></p>
</div></td>
<td><p>Post-synaptic trace <img class="math" src="../../../_images/math/11b8c64a04f523c2254e0dcd0514733e6cf3d0ee.png" alt="y_3"/>.</p></td>
</tr>
<tr class="row-odd"><td><div class="math">
<p><img src="../../../_images/math/0c660eada3222857d2c1de6ae724be102e342b48.png" alt="W + C"/></p>
</div></td>
<td><p>Weight synaptic variable <img class="math" src="../../../_images/math/1fbee781f84569077719a167b64e12064360fac1.png" alt="W"/>.</p></td>
</tr>
<tr class="row-even"><td><div class="math">
<p><img src="../../../_images/math/a9d8fc935f16b49ff9f35a6b4c8b825ce4cb6ed5.png" alt="D + C"/></p>
</div></td>
<td><p>Delay synaptic variable <img class="math" src="../../../_images/math/0fcab9067b50b87e868c4fd70f213a086addb964.png" alt="D"/>.</p></td>
</tr>
<tr class="row-odd"><td><div class="math">
<p><img src="../../../_images/math/799bbfebb1bc1b0949d59f9ef609a72efa0d7acf.png" alt="T + C"/></p>
</div></td>
<td><p>Tag synaptic variable <img class="math" src="../../../_images/math/e8dea8254118f111b5fb20895b03528c17566f06.png" alt="T"/>.</p></td>
</tr>
<tr class="row-even"><td><div class="math">
<p><img src="../../../_images/math/e78701c62af1faf10156490ad2c1175bc7e67787.png" alt="sgn(W + C)"/></p>
</div></td>
<td><p>Sign of <img class="math" src="../../../_images/math/1fbee781f84569077719a167b64e12064360fac1.png" alt="W"/>.</p></td>
</tr>
<tr class="row-odd"><td><div class="math">
<p><img src="../../../_images/math/c6f78381a6c45a420f066863c91c0c226a5f5afa.png" alt="sgn(D + C)"/></p>
</div></td>
<td><p>Sign of <img class="math" src="../../../_images/math/0fcab9067b50b87e868c4fd70f213a086addb964.png" alt="D"/>.</p></td>
</tr>
<tr class="row-even"><td><div class="math">
<p><img src="../../../_images/math/9b2f39763eda0e53cb66227108296825f7451ecb.png" alt="sgn(T + C)"/></p>
</div></td>
<td><p>Sign of <img class="math" src="../../../_images/math/e8dea8254118f111b5fb20895b03528c17566f06.png" alt="T"/>.</p></td>
</tr>
<tr class="row-odd"><td><div class="math">
<p><img src="../../../_images/math/b91caa0712af1050fba7c772a995e8c625ebd2c1.png" alt="C"/></p>
</div></td>
<td><p>Constant term <em>(variant 1)</em>.</p></td>
</tr>
<tr class="row-even"><td><div class="math">
<p><img src="../../../_images/math/4a2cdf5da1dc5209b00e508214ec53338dff72c7.png" alt="C^{mant} \cdot 2^{C^{exp}}"/></p>
</div></td>
<td><p>Constant term <em>(variant 2)</em>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="Traces">
<h2>Traces<a class="headerlink" href="#Traces" title="Permalink to this headline"></a></h2>
<p>Traces are low-pass filtered versions of spike train that are typically used in online implementations of <a class="reference external" href="http://www.scholarpedia.org/article/Spike-timing_dependent_plasticity">Spike-Timing Dependent Plasticity (STDP)</a>. For each synapse, Loihi provides a set of <strong>2 pre-synaptic traces</strong> <img class="math" src="../../../_images/math/5dc8b4a83234b142fc25f091f45db6cdcb5e5f0e.png" alt="\{x_1, x_2\}"/> and <strong>3 post-synaptic traces</strong> <img class="math" src="../../../_images/math/bd1b1b38fbcb102f10cab755442498316644dc6d.png" alt="\{y_1, y_2, y_3\}"/>. The dynamics of an ideal spike trace is given by :</p>
<div class="math">
<p><img src="../../../_images/math/0f0082668fc4a57dbcbfa0bcaf8ffccdb30d6e1e.png" alt="z \in \{x_1, x_2, y_1, y_2, y_3\}"/></p>
</div><div class="math">
<p><img src="../../../_images/math/1073deda41b45ca12e3a649efc86441fb5b8c0f2.png" alt="z(t) = z(t_{k-1}) \cdot exp(- \frac{t-t_{k-1}}{\tau^z}) + \xi^z \cdot \delta^{z}(t - t_k)"/></p>
</div><p>Here, the set <img class="math" src="../../../_images/math/8c4a146e6075e04951b3a602edc427ab1b92f468.png" alt="\{t_k\}"/> are successive spike times at which the trace accumulates the spike impulse value <img class="math" src="../../../_images/math/807a5e6b779349f4aac95e90c603bc640ad6c35b.png" alt="\xi^{z}"/> while <img class="math" src="../../../_images/math/f9b0333e3c7f9e15d9705c36d824220b930d3fda.png" alt="\tau^z"/> governs the speed of exponential decay between spike events. Finally, <img class="math" src="../../../_images/math/82d19b8fb070ccd2c7c859378551622f60f09999.png" alt="\delta^z"/> denotes the raw spike train associated with the trace <img class="math" src="../../../_images/math/8d051150f8669295ecdbe92367941012175a824d.png" alt="z"/>.</p>
</div>
<div class="section" id="Example:-Basic-pair-based-STDP">
<h2>Example: Basic pair-based STDP<a class="headerlink" href="#Example:-Basic-pair-based-STDP" title="Permalink to this headline"></a></h2>
<div class="math">
<p><img src="../../../_images/math/09e7a72aa339867a87f777074c725c35e0b38863.png" alt="dW = S_1 \cdot x_0 \cdot y_1 + S_2 \cdot y_0 \cdot x_1"/></p>
</div><p>where <img class="math" src="../../../_images/math/ee7bde3f853db0c6518698fe49dd1eaa20d7dba7.png" alt="S_1 &lt; 0"/> and <img class="math" src="../../../_images/math/f9b7affa14cafb75c14094b59e6ce3c43c01f872.png" alt="S_2 &gt; 0"/>.</p>
</div>
<div class="section" id="Instantiating-LearningRule">
<h2>Instantiating LearningRule<a class="headerlink" href="#Instantiating-LearningRule" title="Permalink to this headline"></a></h2>
<p>Next, we define a learning rule (<img class="math" src="../../../_images/math/82a78cd31cbe153ac9df50bb4a32e639a4bb45cf.png" alt="dw"/>) for the <em>weight</em> synaptic variable. The learning rule is first written in string format and passed to the LearningRule object as instantiation argument. This string learning rule will get internally parsed, transformed into and stored as a <em>ProductSeries</em>, which is a custom data structure that is particularly well-suited for sum-of-products representation.</p>
<p>Here, we use the basic pair-based STDP learning rule defined by :</p>
<div class="math">
<p><img src="../../../_images/math/e9618255eb4f9677fe4b120c6712c37d1c9cc4f4.png" alt="dw = -2 \cdot x_0 \cdot y_1 + 2 \cdot y_0 \cdot x_1"/></p>
</div><p>As a reminder, the main function of the LearningRule object is not only to encapsulate learning rules, but also other learning-related such as trace impulse values and decay constants for all of the traces as well as the length of the learning epoch. The following table lists the different fields of the LearningRule class:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 15%" />
<col style="width: 68%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Python type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dw</span></code></p></td>
<td><p>ProductSeries</p></td>
<td><p>Learning rule targetting the synaptic variable <img class="math" src="../../../_images/math/1fbee781f84569077719a167b64e12064360fac1.png" alt="W"/>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dd</span></code></p></td>
<td><p>ProductSeries</p></td>
<td><p>Learning rule targetting the synaptic variable <img class="math" src="../../../_images/math/0fcab9067b50b87e868c4fd70f213a086addb964.png" alt="D"/>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dt</span></code></p></td>
<td><p>ProductSeries</p></td>
<td><p>Learning rule targetting the synaptic variable <img class="math" src="../../../_images/math/e8dea8254118f111b5fb20895b03528c17566f06.png" alt="T"/>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">x1_impulse</span></code></p></td>
<td><p>float</p></td>
<td><p>Trace impulse value associated with <img class="math" src="../../../_images/math/5ea99039cd8359fa2e14317dbfae4497ebbc1360.png" alt="x_1"/> trace.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">x1_tau</span></code></p></td>
<td><p>int</p></td>
<td><p>Trace decay constant associated with <img class="math" src="../../../_images/math/5ea99039cd8359fa2e14317dbfae4497ebbc1360.png" alt="x_1"/> trace.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">x2_impulse</span></code></p></td>
<td><p>float</p></td>
<td><p>Trace impulse value associated with <img class="math" src="../../../_images/math/b7bda214149c6fe0d7c6c494b0c896805bf51262.png" alt="x_2"/> trace.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">x2_tau</span></code></p></td>
<td><p>int</p></td>
<td><p>Trace decay constant associated with <img class="math" src="../../../_images/math/b7bda214149c6fe0d7c6c494b0c896805bf51262.png" alt="x_2"/> trace.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">y1_impulse</span></code></p></td>
<td><p>float</p></td>
<td><p>Trace impulse value associated with <img class="math" src="../../../_images/math/7a4a430067dab11b32cfcddbd7d7fd6b5f4d3070.png" alt="y_1"/> trace.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">y1_tau</span></code></p></td>
<td><p>int</p></td>
<td><p>Trace decay constant associated with <img class="math" src="../../../_images/math/7a4a430067dab11b32cfcddbd7d7fd6b5f4d3070.png" alt="y_1"/> trace.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">y2_impulse</span></code></p></td>
<td><p>float</p></td>
<td><p>Trace impulse value associated with <img class="math" src="../../../_images/math/f5f424471e1f942a67eedbdbb512954c4e722fe8.png" alt="y_2"/> trace.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">y2_tau</span></code></p></td>
<td><p>int</p></td>
<td><p>Trace decay constant associated with <img class="math" src="../../../_images/math/f5f424471e1f942a67eedbdbb512954c4e722fe8.png" alt="y_2"/> trace.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">y3_impulse</span></code></p></td>
<td><p>float</p></td>
<td><p>Trace impulse value associated with <img class="math" src="../../../_images/math/11b8c64a04f523c2254e0dcd0514733e6cf3d0ee.png" alt="y_3"/> trace.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">y3_tau</span></code></p></td>
<td><p>int</p></td>
<td><p>Trace decay constant associated with <img class="math" src="../../../_images/math/11b8c64a04f523c2254e0dcd0514733e6cf3d0ee.png" alt="y_3"/> trace.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">t_epoch</span></code></p></td>
<td><p>int</p></td>
<td><p>Learning epoch length.</p></td>
</tr>
</tbody>
</table>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">lava.magma.core.learning.learning_rule</span> <span class="kn">import</span> <span class="n">LoihiLearningRule</span>

<span class="c1"># Learning rule coefficient</span>
<span class="n">on_pre_stdp</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">on_post_stdp</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">learning_rate</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Trace decay constants</span>
<span class="n">x1_tau</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">y1_tau</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Impulses</span>
<span class="n">x1_impulse</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">y1_impulse</span> <span class="o">=</span> <span class="mi">16</span>

<span class="c1"># Epoch length</span>
<span class="n">t_epoch</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># Define dw as string</span>
<span class="n">dw</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">learning_rate</span><span class="si">}</span><span class="s2"> * (</span><span class="si">{</span><span class="n">on_pre_stdp</span><span class="si">}</span><span class="s2">) * x0 * y1 +&quot;</span> \
     <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">learning_rate</span><span class="si">}</span><span class="s2"> * </span><span class="si">{</span><span class="n">on_post_stdp</span><span class="si">}</span><span class="s2"> * y0 * x1&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create custom LearningRule</span>
<span class="n">stdp</span> <span class="o">=</span> <span class="n">LoihiLearningRule</span><span class="p">(</span><span class="n">dw</span><span class="o">=</span><span class="n">dw</span><span class="p">,</span>
                         <span class="n">x1_impulse</span><span class="o">=</span><span class="n">x1_impulse</span><span class="p">,</span>
                         <span class="n">x1_tau</span><span class="o">=</span><span class="n">x1_tau</span><span class="p">,</span>
                         <span class="n">y1_impulse</span><span class="o">=</span><span class="n">y1_impulse</span><span class="p">,</span>
                         <span class="n">y1_tau</span><span class="o">=</span><span class="n">y1_tau</span><span class="p">,</span>
                         <span class="n">t_epoch</span><span class="o">=</span><span class="n">t_epoch</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Set this tag to &quot;fixed_pt&quot; or &quot;floating_pt&quot; to choose the corresponding models.</span>
<span class="n">SELECT_TAG</span> <span class="o">=</span> <span class="s2">&quot;floating_pt&quot;</span>

<span class="c1"># LIF parameters</span>
<span class="k">if</span> <span class="n">SELECT_TAG</span> <span class="o">==</span> <span class="s2">&quot;fixed_pt&quot;</span><span class="p">:</span>
    <span class="n">du</span> <span class="o">=</span> <span class="mi">4095</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="mi">4095</span>
<span class="k">elif</span> <span class="n">SELECT_TAG</span> <span class="o">==</span> <span class="s2">&quot;floating_pt&quot;</span><span class="p">:</span>
    <span class="n">du</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">vth</span> <span class="o">=</span> <span class="mi">240</span>

<span class="c1"># Number of neurons per layer</span>
<span class="n">num_neurons</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">shape_lif</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_neurons</span><span class="p">,</span> <span class="p">)</span>
<span class="n">shape_conn</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_neurons</span><span class="p">,</span> <span class="n">num_neurons</span><span class="p">)</span>

<span class="c1"># Connection parameters</span>

<span class="c1"># SpikePattern -&gt; LIF connection weight</span>
<span class="n">wgt_inp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">num_neurons</span><span class="p">)</span> <span class="o">*</span> <span class="mi">250</span>

<span class="c1"># LIF -&gt; LIF connection initial weight (learning-enabled)</span>
<span class="n">wgt_plast_conn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shape_conn</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="c1"># Number of simulation time steps</span>
<span class="n">num_steps</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">time</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Spike times</span>
<span class="n">spike_prob</span> <span class="o">=</span> <span class="mf">0.03</span>

<span class="c1"># Create spike rasters</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">spike_raster_pre</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_neurons</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">spike_raster_pre</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_neurons</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">spike_prob</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">spike_raster_post</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_neurons</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">spike_raster_post</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_neurons</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">spike_prob</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The following diagram depics the Lava Process architecture used in this tutorial. It consists of: - 2 Constant pattern generators for injection spike trains to LIF neurons. - 2 <em>LIF</em> Processes representing pre- and post-synaptic Leaky Integrate-and-Fire neurons. - 1 <em>Dense</em> Process representing learning-enable connection between LIF neurons.</p>
<blockquote>
<div><p><strong>Note:</strong> All neuronal population (spike generator, LIF) are composed of only 1 neuron in this tutorial.</p>
</div></blockquote>
<p><img alt="Architecture.svg" src="https://raw.githubusercontent.com/lava-nc/lava-docs/main/_static/images/tutorial_learning/learning_tutorial_architecture.svg" /></p>
</div>
<div class="section" id="The-plastic-connection-Process">
<h2>The plastic connection Process<a class="headerlink" href="#The-plastic-connection-Process" title="Permalink to this headline"></a></h2>
<p>We now instantiate our plastic Dense process. The Dense Process provides the following Vars and Ports relevant for plasticity:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 17%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Component</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>InPort</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s_in_bap</span></code></p></td>
<td><p>Receives spikes from post-synaptic neurons.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Var</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tag_2</span></code></p></td>
<td><p>Delay synaptic variable.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tag_1</span></code></p></td>
<td><p>Tag synaptic variable.</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x0</span></code></p></td>
<td><p>State of <img class="math" src="../../../_images/math/ed7fb0260e58d3ca5851e823ff991dae4cde5671.png" alt="x_0"/> dependency.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tx</span></code></p></td>
<td><p>Within-epoch spike times of pre-synaptic neurons.</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x1</span></code></p></td>
<td><p>State of <img class="math" src="../../../_images/math/5ea99039cd8359fa2e14317dbfae4497ebbc1360.png" alt="x_1"/> trace.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x2</span></code></p></td>
<td><p>State of <img class="math" src="../../../_images/math/b7bda214149c6fe0d7c6c494b0c896805bf51262.png" alt="x_2"/> trace.</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">y0</span></code></p></td>
<td><p>State of <img class="math" src="../../../_images/math/c02d829cecb5c5b40b5a00db3dc936351b671e07.png" alt="y_0"/> dependency.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ty</span></code></p></td>
<td><p>Within-epoch spike times of post-synaptic neurons.</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">y1</span></code></p></td>
<td><p>State of <img class="math" src="../../../_images/math/7a4a430067dab11b32cfcddbd7d7fd6b5f4d3070.png" alt="y_1"/> trace.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">y2</span></code></p></td>
<td><p>State of <img class="math" src="../../../_images/math/f5f424471e1f942a67eedbdbb512954c4e722fe8.png" alt="y_2"/> trace.</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">y3</span></code></p></td>
<td><p>State of <img class="math" src="../../../_images/math/11b8c64a04f523c2254e0dcd0514733e6cf3d0ee.png" alt="y_3"/> trace.</p></td>
</tr>
</tbody>
</table>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">lava.proc.lif.process</span> <span class="kn">import</span> <span class="n">LIF</span>
<span class="kn">from</span> <span class="nn">lava.proc.io.source</span> <span class="kn">import</span> <span class="n">RingBuffer</span>
<span class="kn">from</span> <span class="nn">lava.proc.dense.process</span> <span class="kn">import</span> <span class="n">LearningDense</span> <span class="k">as</span> <span class="n">Dense</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create input devices</span>
<span class="n">pattern_pre</span> <span class="o">=</span> <span class="n">RingBuffer</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">spike_raster_pre</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
<span class="n">pattern_post</span> <span class="o">=</span> <span class="n">RingBuffer</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">spike_raster_post</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>

<span class="c1"># Create input connectivity</span>
<span class="n">conn_inp_pre</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">wgt_inp</span><span class="p">)</span>
<span class="n">conn_inp_post</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">wgt_inp</span><span class="p">)</span>

<span class="c1"># Create pre-synaptic neurons</span>
<span class="n">lif_pre</span> <span class="o">=</span> <span class="n">LIF</span><span class="p">(</span><span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
              <span class="n">v</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
              <span class="n">du</span><span class="o">=</span><span class="n">du</span><span class="p">,</span>
              <span class="n">dv</span><span class="o">=</span><span class="n">du</span><span class="p">,</span>
              <span class="n">bias_mant</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
              <span class="n">bias_exp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
              <span class="n">vth</span><span class="o">=</span><span class="n">vth</span><span class="p">,</span>
              <span class="n">shape</span><span class="o">=</span><span class="n">shape_lif</span><span class="p">,</span>
              <span class="n">name</span><span class="o">=</span><span class="s1">&#39;lif_pre&#39;</span><span class="p">)</span>

<span class="c1"># Create plastic connection</span>
<span class="n">plast_conn</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">wgt_plast_conn</span><span class="p">,</span>
                   <span class="n">learning_rule</span><span class="o">=</span><span class="n">stdp</span><span class="p">,</span>
                   <span class="n">name</span><span class="o">=</span><span class="s1">&#39;plastic_dense&#39;</span><span class="p">)</span>

<span class="c1"># Create post-synaptic neuron</span>
<span class="n">lif_post</span> <span class="o">=</span> <span class="n">LIF</span><span class="p">(</span><span class="n">u</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
               <span class="n">v</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
               <span class="n">du</span><span class="o">=</span><span class="n">du</span><span class="p">,</span>
               <span class="n">dv</span><span class="o">=</span><span class="n">du</span><span class="p">,</span>
               <span class="n">bias_mant</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
               <span class="n">bias_exp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
               <span class="n">vth</span><span class="o">=</span><span class="n">vth</span><span class="p">,</span>
               <span class="n">shape</span><span class="o">=</span><span class="n">shape_lif</span><span class="p">,</span>
               <span class="n">name</span><span class="o">=</span><span class="s1">&#39;lif_post&#39;</span><span class="p">)</span>

<span class="c1"># Connect network</span>
<span class="n">pattern_pre</span><span class="o">.</span><span class="n">s_out</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">conn_inp_pre</span><span class="o">.</span><span class="n">s_in</span><span class="p">)</span>
<span class="n">conn_inp_pre</span><span class="o">.</span><span class="n">a_out</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">lif_pre</span><span class="o">.</span><span class="n">a_in</span><span class="p">)</span>

<span class="n">pattern_post</span><span class="o">.</span><span class="n">s_out</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">conn_inp_post</span><span class="o">.</span><span class="n">s_in</span><span class="p">)</span>
<span class="n">conn_inp_post</span><span class="o">.</span><span class="n">a_out</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">lif_post</span><span class="o">.</span><span class="n">a_in</span><span class="p">)</span>

<span class="n">lif_pre</span><span class="o">.</span><span class="n">s_out</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">plast_conn</span><span class="o">.</span><span class="n">s_in</span><span class="p">)</span>
<span class="n">plast_conn</span><span class="o">.</span><span class="n">a_out</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">lif_post</span><span class="o">.</span><span class="n">a_in</span><span class="p">)</span>

<span class="c1"># Connect back-propagating actionpotential (BAP)</span>
<span class="n">lif_post</span><span class="o">.</span><span class="n">s_out</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">plast_conn</span><span class="o">.</span><span class="n">s_in_bap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">lava.proc.monitor.process</span> <span class="kn">import</span> <span class="n">Monitor</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create monitors</span>
<span class="n">mon_pre_trace</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>
<span class="n">mon_post_trace</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>
<span class="n">mon_pre_spikes</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>
<span class="n">mon_post_spikes</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>
<span class="n">mon_weight</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>

<span class="c1"># Connect monitors</span>
<span class="n">mon_pre_trace</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">plast_conn</span><span class="o">.</span><span class="n">x1</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">)</span>
<span class="n">mon_post_trace</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">plast_conn</span><span class="o">.</span><span class="n">y1</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">)</span>
<span class="n">mon_pre_spikes</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">lif_pre</span><span class="o">.</span><span class="n">s_out</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">)</span>
<span class="n">mon_post_spikes</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">lif_post</span><span class="o">.</span><span class="n">s_out</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">)</span>
<span class="n">mon_weight</span><span class="o">.</span><span class="n">probe</span><span class="p">(</span><span class="n">plast_conn</span><span class="o">.</span><span class="n">weights</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">lava.magma.core.run_conditions</span> <span class="kn">import</span> <span class="n">RunSteps</span>
<span class="kn">from</span> <span class="nn">lava.magma.core.run_configs</span> <span class="kn">import</span> <span class="n">Loihi1SimCfg</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Running</span>
<span class="n">pattern_pre</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">condition</span><span class="o">=</span><span class="n">RunSteps</span><span class="p">(</span><span class="n">num_steps</span><span class="o">=</span><span class="n">num_steps</span><span class="p">),</span> <span class="n">run_cfg</span><span class="o">=</span><span class="n">Loihi1SimCfg</span><span class="p">(</span><span class="n">select_tag</span><span class="o">=</span><span class="n">SELECT_TAG</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Get data from monitors</span>
<span class="n">pre_trace</span> <span class="o">=</span> <span class="n">mon_pre_trace</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="s1">&#39;plastic_dense&#39;</span><span class="p">][</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span>
<span class="n">post_trace</span> <span class="o">=</span> <span class="n">mon_post_trace</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="s1">&#39;plastic_dense&#39;</span><span class="p">][</span><span class="s1">&#39;y1&#39;</span><span class="p">]</span>
<span class="n">pre_spikes</span> <span class="o">=</span> <span class="n">mon_pre_spikes</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="s1">&#39;lif_pre&#39;</span><span class="p">][</span><span class="s1">&#39;s_out&#39;</span><span class="p">]</span>
<span class="n">post_spikes</span> <span class="o">=</span> <span class="n">mon_post_spikes</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="s1">&#39;lif_post&#39;</span><span class="p">][</span><span class="s1">&#39;s_out&#39;</span><span class="p">]</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">mon_weight</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="s1">&#39;plastic_dense&#39;</span><span class="p">][</span><span class="s1">&#39;weights&#39;</span><span class="p">][:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Stopping</span>
<span class="n">pattern_pre</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Now, we can take a look at the results of the simulation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Plot-spike-trains">
<h2>Plot spike trains<a class="headerlink" href="#Plot-spike-trains" title="Permalink to this headline"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Plotting pre- and post- spike arrival</span>
<span class="k">def</span> <span class="nf">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">legend</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">offsets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

    <span class="n">spikes_plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">eventplot</span><span class="p">(</span><span class="n">positions</span><span class="o">=</span><span class="n">spikes</span><span class="p">,</span>
                                <span class="n">lineoffsets</span><span class="o">=</span><span class="n">offsets</span><span class="p">,</span>
                                <span class="n">linelength</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
                                <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Spike arrival&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time steps&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Neurons&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="n">offsets</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">legend</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot spikes</span>
<span class="n">plot_spikes</span><span class="p">(</span><span class="n">spikes</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">post_spikes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pre_spikes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">legend</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">,</span> <span class="s1">&#39;Pre&#39;</span><span class="p">],</span>
            <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#370665&#39;</span><span class="p">,</span> <span class="s1">&#39;#f14a16&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_in_depth_tutorial09_custom_learning_rules_25_0.png" src="../../../_images/lava_notebooks_in_depth_tutorial09_custom_learning_rules_25_0.png" />
</div>
</div>
</div>
<div class="section" id="Plot-traces">
<h2>Plot traces<a class="headerlink" href="#Plot-traces" title="Permalink to this headline"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Plotting trace dynamics</span>

<span class="k">def</span> <span class="nf">plot_time_series</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">time_series</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">time_series</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time steps&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plotting pre trace dynamics</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">time_series</span><span class="o">=</span><span class="n">pre_trace</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Trace value&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Pre trace&quot;</span><span class="p">)</span>
<span class="c1"># Plotting post trace dynamics</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">time_series</span><span class="o">=</span><span class="n">post_trace</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Trace value&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Post trace&quot;</span><span class="p">)</span>
<span class="c1"># Plotting weight dynamics</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">time_series</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Weight value&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Weight dynamics&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_in_depth_tutorial09_custom_learning_rules_27_0.png" src="../../../_images/lava_notebooks_in_depth_tutorial09_custom_learning_rules_27_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_in_depth_tutorial09_custom_learning_rules_27_1.png" src="../../../_images/lava_notebooks_in_depth_tutorial09_custom_learning_rules_27_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_in_depth_tutorial09_custom_learning_rules_27_2.png" src="../../../_images/lava_notebooks_in_depth_tutorial09_custom_learning_rules_27_2.png" />
</div>
</div>
</div>
<div class="section" id="Plot-STDP-learning-window-and-weight-changes">
<h2>Plot STDP learning window and weight changes<a class="headerlink" href="#Plot-STDP-learning-window-and-weight-changes" title="Permalink to this headline"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">extract_stdp_weight_changes</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">spikes_pre</span><span class="p">,</span> <span class="n">spikes_post</span><span class="p">,</span> <span class="n">wgt</span><span class="p">):</span>
    <span class="c1"># Compute the weight changes for every weight change event</span>
    <span class="n">w_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">wgt</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">w_diff</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">wgt</span><span class="p">)</span>

    <span class="n">w_diff_non_zero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">w_diff</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">dw</span> <span class="o">=</span> <span class="n">w_diff</span><span class="p">[</span><span class="n">w_diff_non_zero</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># Find the absolute time of every weight change event</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="n">t_non_zero</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="n">w_diff_non_zero</span><span class="p">]</span>

    <span class="c1"># Compute the difference between post and pre synaptic spike time for every weight change event</span>
    <span class="n">spikes_pre</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spikes_pre</span><span class="p">)</span>
    <span class="n">spikes_post</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spikes_post</span><span class="p">)</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dw</span><span class="p">)):</span>
        <span class="n">time_stamp</span> <span class="o">=</span> <span class="n">t_non_zero</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">t_post</span> <span class="o">=</span> <span class="p">(</span><span class="n">spikes_post</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">spikes_post</span> <span class="o">&lt;=</span> <span class="n">time_stamp</span><span class="p">)])[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">t_pre</span> <span class="o">=</span> <span class="p">(</span><span class="n">spikes_pre</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">spikes_pre</span> <span class="o">&lt;=</span> <span class="n">time_stamp</span><span class="p">)])[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t_post</span><span class="o">-</span><span class="n">t_pre</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dt</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dw</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_stdp</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">spikes_pre</span><span class="p">,</span> <span class="n">spikes_post</span><span class="p">,</span> <span class="n">wgt</span><span class="p">,</span>
              <span class="n">on_pre_stdp</span><span class="p">,</span> <span class="n">y1_impulse</span><span class="p">,</span> <span class="n">y1_tau</span><span class="p">,</span>
              <span class="n">on_post_stdp</span><span class="p">,</span> <span class="n">x1_impulse</span><span class="p">,</span> <span class="n">x1_tau</span><span class="p">):</span>
    <span class="c1"># Derive weight changes as a function of time differences</span>
    <span class="n">diff_t</span><span class="p">,</span> <span class="n">diff_w</span> <span class="o">=</span> <span class="n">extract_stdp_weight_changes</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">spikes_pre</span><span class="p">,</span> <span class="n">spikes_post</span><span class="p">,</span> <span class="n">wgt</span><span class="p">)</span>

    <span class="c1"># Derive learning rule coefficients</span>
    <span class="n">on_pre_stdp</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">on_pre_stdp</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="s2">&quot;**&quot;</span><span class="p">))</span>
    <span class="n">a_neg</span> <span class="o">=</span> <span class="n">on_pre_stdp</span> <span class="o">*</span> <span class="n">y1_impulse</span>
    <span class="n">on_post_stdp</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">on_post_stdp</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="s2">&quot;**&quot;</span><span class="p">))</span>
    <span class="n">a_pos</span> <span class="o">=</span> <span class="n">on_post_stdp</span> <span class="o">*</span> <span class="n">x1_impulse</span>

    <span class="c1"># Derive x-axis limit (absolute value)</span>
    <span class="n">max_abs_dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">diff_t</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">diff_t</span><span class="p">)))</span>

    <span class="c1"># Derive x-axis for learning window computation (negative part)</span>
    <span class="n">x_neg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">max_abs_dt</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="c1"># Derive learning window (negative part)</span>
    <span class="n">w_neg</span> <span class="o">=</span> <span class="n">a_neg</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x_neg</span> <span class="o">/</span> <span class="n">y1_tau</span><span class="p">)</span>

    <span class="c1"># Derive x-axis for learning window computation (positive part)</span>
    <span class="n">x_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_abs_dt</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="c1"># Derive learning window (positive part)</span>
    <span class="n">w_pos</span> <span class="o">=</span> <span class="n">a_pos</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span> <span class="n">x_pos</span> <span class="o">/</span> <span class="n">x1_tau</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">diff_t</span><span class="p">,</span> <span class="n">diff_w</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Weight changes&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_neg</span><span class="p">,</span> <span class="n">w_neg</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;W-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_pos</span><span class="p">,</span> <span class="n">w_pos</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;W+&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;STDP weight changes - Learning window&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t_post - t_pre&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Weight change&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot STDP window</span>
<span class="n">plot_stdp</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pre_spikes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">post_spikes</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">weights</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
          <span class="n">on_pre_stdp</span><span class="p">,</span> <span class="n">stdp</span><span class="o">.</span><span class="n">y1_impulse</span><span class="p">,</span> <span class="n">stdp</span><span class="o">.</span><span class="n">x1_tau</span><span class="p">,</span>
          <span class="n">on_post_stdp</span><span class="p">,</span> <span class="n">stdp</span><span class="o">.</span><span class="n">x1_impulse</span><span class="p">,</span> <span class="n">stdp</span><span class="o">.</span><span class="n">y1_tau</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/lava_notebooks_in_depth_tutorial09_custom_learning_rules_29_0.png" src="../../../_images/lava_notebooks_in_depth_tutorial09_custom_learning_rules_29_0.png" />
</div>
</div>
<p>Find out how to use STDP from the Lava ProcessLibrary in the <a class="reference external" href="../../in_depth/tutorial09_custom_learning_rules.ipynb">STDP Tutorial</a>.</p>
</div>
<div class="section" id="Follow-the-links-below-for-deep-dive-tutorials-on-the-concepts-in-this-tutorial:">
<h2>Follow the links below for deep-dive tutorials on the concepts in this tutorial:<a class="headerlink" href="#Follow-the-links-below-for-deep-dive-tutorials-on-the-concepts-in-this-tutorial:" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="../../in_depth/tutorial02_processes.ipynb">Processes</a></p></li>
<li><p><a class="reference external" href="../../in_depth/tutorial03_process_models.ipynb">ProcessModel</a></p></li>
<li><p><a class="reference external" href="../../in_depth/tutorial04_execution.ipynb">Execution</a></p></li>
<li><p><a class="reference external" href="../../in_depth/tutorial05_connect_processes.ipynb">Connecting Processes</a></p></li>
</ul>
<p>If you want to find out more about Lava, have a look at the <a class="reference external" href="https://lava-nc.org/">Lava documentation</a> or dive into the <a class="reference external" href="https://github.com/lava-nc/lava/">source code</a>.</p>
<p>To receive regular updates on the latest developments and releases of the Lava Software Framework please subscribe to the <a class="reference external" href="http://eepurl.com/hJCyhb">INRC newsletter</a>.</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial08_stdp.html" class="btn btn-neutral float-left" title="Spike-timing Dependent Plasticity (STDP)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../../algorithms.html" class="btn btn-neutral float-right" title="Algorithms and Application Libraries" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Intel Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>